sql,hardness
SELECT MAX(T1.product_price) FROM Products AS T1 WHERE T1.product_id BETWEEN 100 AND 200 AND T1.product_price > 50 ORDER BY T1.product_price DESC,medium
"SELECT T1.supplier_name, SUM(T2.total_value_purchased) FROM Suppliers AS T1 JOIN Product_Suppliers AS T2 ON T1.supplier_id = T2.supplier_id WHERE T2.total_value_purchased <= 1000 ORDER BY T1.supplier_name ASC",hard
SELECT T1.staff_name FROM Staff AS T1 WHERE T1.staff_id = 10 AND T1.staff_gender = 'M' AND T1.staff_id BETWEEN 5 AND 15,medium
SELECT COUNT(DISTINCT T1.staff_name) FROM Staff AS T1 JOIN Staff_Department_Assignments AS T2 ON T1.staff_id = T2.staff_id WHERE T1.staff_gender = 'Male' AND T2.department_id = 10 AND T2.job_title_code = 'Manager',medium
"SELECT COUNT(DISTINCT T1.staff_name), SUM(T2.total_value_purchased) FROM Staff AS T1 JOIN Product_Suppliers AS T2 ON T1.staff_id = T2.supplier_id WHERE T2.date_supplied_from BETWEEN '2020-01-01' AND '2021-01-01' GROUP BY T2.total_value_purchased ORDER BY T2.total_value_purchased ASC",extra
"SELECT T1.customer_name, COUNT(T2.order_id) FROM Customers AS T1 JOIN Customer_Orders AS T2 ON T1.customer_id = T2.customer_id WHERE T2.order_status_code != 'Cancelled'",medium
"SELECT T1.staff_name, COUNT(T2.staff_name), SUM(T2.staff_id) FROM Staff AS T1 JOIN Staff AS T2 ON T1.staff_id = T2.staff_id WHERE T1.staff_id > 10 GROUP BY T1.staff_name HAVING COUNT(T2.staff_name) > 2 ORDER BY COUNT(T2.staff_name) DESC",extra
"SELECT T1.product_name, SUM(T2.total_value_purchased) FROM Products AS T1 JOIN Product_Suppliers AS T2 ON T1.product_id = T2.product_id GROUP BY T1.product_name HAVING T1.product_name != 'Product A'",medium
SELECT COUNT(DISTINCT T1.product_name) FROM Products AS T1 JOIN Order_Items AS T2 ON T1.product_id = T2.product_id WHERE T2.order_id IN (SELECT T3.order_id FROM Customer_Orders AS T3 WHERE T3.order_date > '2020-01-01') ORDER BY T1.product_name ASC,extra
"SELECT T1.department_name, COUNT(T2.staff_id) FROM Departments AS T1 JOIN Staff_Department_Assignments AS T2 ON T1.department_id = T2.department_id WHERE T2.date_assigned_to <= '2020-01-01' ORDER BY T1.department_name ASC",hard
SELECT customer_name FROM Customers WHERE customer_address = 'New York' OR customer_phone NOT IN (SELECT store_phone FROM Department_Stores WHERE store_address = 'Los Angeles'),extra
SELECT product_name FROM Products WHERE product_price BETWEEN 10 AND 20 OR product_name = 'Product A' OR NOT EXISTS (SELECT 1 FROM Product_Suppliers WHERE Product_Suppliers.product_id = Products.product_id) ORDER BY product_price DESC,extra
SELECT T1.staff_name FROM Staff AS T1 WHERE T1.staff_id = ( SELECT MAX(T2.staff_id) FROM Staff AS T2 GROUP BY T2.staff_gender ),hard
"SELECT T1.customer_id, T1.customer_name FROM Customers AS T1 JOIN Customer_Addresses AS T2 ON T1.customer_id = T2.customer_id WHERE T1.customer_id = 5 AND T1.customer_code BETWEEN 100 AND 200 AND T1.customer_id > 10 LIMIT 10",hard
SELECT T1.staff_id FROM Staff AS T1 JOIN Staff AS T2 ON T1.staff_id = T2.staff_id WHERE NOT EXISTS (SELECT 1 FROM Staff_Department_Assignments AS T3 WHERE T3.staff_id = T1.staff_id AND T3.job_title_code = 'Manager') ORDER BY T1.staff_id DESC,extra
"SELECT COUNT(DISTINCT T1.dept_store_id), SUM(T2.product_price), COUNT(T3.staff_id) FROM Departments AS T1 JOIN Products AS T2 ON T1.department_id = T2.product_type_code JOIN Staff_Department_Assignments AS T3 ON T2.product_id = T3.department_id WHERE T2.product_price <= 10000",hard
"SELECT COUNT(T1.supplier_id), T2.dept_store_chain_name FROM Suppliers AS T1 JOIN Department_Store_Chain AS T2 ON T1.supplier_id != T2.dept_store_chain_id GROUP BY T2.dept_store_chain_name ORDER BY COUNT(T1.supplier_id) DESC LIMIT 10",extra
SELECT COUNT(DISTINCT T1.supplier_id) FROM Suppliers AS T1 JOIN Product_Suppliers AS T2 ON T1.supplier_id = T2.supplier_id WHERE T2.date_supplied_from BETWEEN '2020-01-01' AND '2021-01-01' AND T1.supplier_phone = '1234567890',medium
SELECT DISTINCT T1.staff_name FROM Staff AS T1 WHERE EXISTS (SELECT 1 FROM Departments AS T2 WHERE T2.dept_store_id = 1 AND T2.department_id = T1.staff_id LIMIT 10),hard
"SELECT T1.product_name, SUM(T1.product_price) FROM Products AS T1 JOIN Products AS T2 ON T1.product_id = T2.product_id WHERE T1.product_price <= T2.product_price LIMIT 10",hard
SELECT T1.supplier_name FROM Suppliers AS T1 WHERE T1.supplier_id IN (SELECT T2.supplier_id FROM Product_Suppliers AS T2 GROUP BY T2.supplier_id HAVING MAX(T2.total_value_purchased) > 10000) LIMIT 1,extra
"SELECT SUM(T1.product_price), T4.staff_name FROM Products AS T1 INNER JOIN Order_Items AS T2 ON T1.product_id = T2.product_id INNER JOIN Customer_Orders AS T3 ON T2.order_id = T3.order_id INNER JOIN Staff AS T4 ON T3.customer_id = T4.staff_id WHERE T3.order_date BETWEEN '2020-01-01' AND '2020-12-31' AND T4.staff_id NOT IN (SELECT staff_id FROM Staff_Department_Assignments WHERE department_id = 1) ORDER BY SUM(T1.product_price) DESC LIMIT 10",extra
"SELECT T1.customer_name, COUNT(T3.order_id) FROM Customers AS T1 JOIN Customer_Orders AS T2 ON T1.customer_id = T2.customer_id JOIN Order_Items AS T3 ON T2.order_id = T3.order_id GROUP BY T1.customer_name LIMIT 100",extra
