query,question,iter,flag
SELECT Products.product_id FROM Products JOIN Order_Items ON Order_Items.product_id = Products.product_id WHERE EXISTS (SELECT * FROM Order_Items AS oi WHERE Products.product_id = oi.product_id),What are the product IDs of products that have been ordered?,2,True
"SELECT item_id, product_id FROM Order_Items WHERE product_id BETWEEN 1 AND 10 AND item_status_code > (SELECT SUM(item_status_code) FROM Order_Items AS h WHERE h.order_id BETWEEN 1 AND 10)",What are the item_id and product_id from Order_Items where product_id is between 1 and 10 and item_status_code is greater than the sum of item_status_code from Order_Items where order_id is between 1 and 10?,5,True
"SELECT product_category, product_name FROM Products WHERE product_id BETWEEN 1 AND 10 OR product_id NOT IN (SELECT product_id FROM Order_Items WHERE product_id BETWEEN 1 AND 10)",What are the categories and names of the products with IDs between 1 and 10 that are either not included in any orders or not ordered at all between IDs 1 and 10?,6,False
SELECT customer_id FROM Customer_Orders WHERE order_id BETWEEN 1 AND 10 ORDER BY customer_id DESC,"What are the customer ids of the customers who placed orders with order ids between 1 and 10, listed in descending order of customer id?",3,True
"SELECT product_category, COUNT(DISTINCT product_id) FROM Products WHERE product_id >= 44 GROUP BY product_category;",What are the product categories and the number of unique products in each category for products with IDs 44 and above?,2,True
SELECT COUNT(DISTINCT shipping_method_code) FROM Customer_Orders JOIN Order_Items ON Customer_Orders.order_id = Order_Items.order_id WHERE product_id <= 25,How many different shipping methods are used for orders containing products with an id of 25 or less?,3,True
"SELECT u.product_id, u.product_category FROM Products AS u WHERE u.product_id BETWEEN 1 AND 10 OR  u.product_id != 49",What are the product ids and categories of products with ids between 1 and 10 or products that are not id 49?,3,True
"SELECT COUNT(DISTINCT order_items.item_id), order_items.order_item_status_code FROM Products JOIN Order_Items ON Products.product_id = Order_Items.product_id WHERE Products.product_id NOT IN (SELECT product_id FROM Products WHERE product_id BETWEEN 1 AND 10) GROUP BY order_items.order_item_status_code LIMIT 2","Excluding products with IDs between 1 and 10, what are the counts of distinct item IDs and corresponding order item status codes for the next 2 most frequent order item status codes?",2,True
"SELECT product_id, product_id FROM Products WHERE  product_id <= 64 LIMIT 5","What are the product ids of the products with ids less than or equal to 64, starting from the 6th product, up to a maximum of 5 products?",6,False
"SELECT product_id, product_name FROM Products WHERE  product_id < 29 ORDER BY product_name ASC LIMIT 7",What are the names of the next 7 products after the first 7 products when ordered alphabetically by product name for products with an id less than 29?,2,True
"SELECT customer_id, customer_id FROM Customer_Orders",What are the customer ids for all customer orders?,6,False
"SELECT COUNT(DISTINCT Premises.premise_id), Premises.premise_details FROM Premises GROUP BY Premises.premise_details HAVING MIN(Premises.premise_id) <= 56",What are the different premise details and the number of unique premises with premise IDs less than or equal to 56 for each premise detail?,6,False
"SELECT COUNT(l.premise_id), l.premises_type FROM Premises AS l WHERE l.premise_id BETWEEN 1 AND 10 LIMIT 1","What is the number and type of the premises with ids between 1 and 10, excluding the first result?",6,False
"SELECT COUNT(Mailshot_Customers.customer_id), Mailshot_Customers.customer_id FROM Mailshot_Customers JOIN Customers ON Customers.customer_id = Mailshot_Customers.customer_id WHERE  mailshot_id < 72 GROUP BY Mailshot_Customers.customer_id LIMIT 8","What are the counts of mailshot customers and their respective customer IDs for mailshot IDs less than 72, grouped by customer ID, and then skip the first 8 results?",2,True
"SELECT MAX(i.mailshot_id), COUNT(DISTINCT i.mailshot_id), i.mailshot_name FROM Mailshot_Campaigns AS i WHERE i.mailshot_id <= 68 GROUP BY i.mailshot_name ORDER BY i.mailshot_name ASC","What are the maximum and count of distinct mailshot IDs for each mailshot name where the mailshot ID is less than or equal to 68, ordered by mailshot name in ascending order?",3,True
"SELECT COUNT(DISTINCT w.premise_id), w.customer_id, w.date_address_to FROM Customer_Addresses AS w WHERE w.premise_id < 47 GROUP BY w.customer_id, w.date_address_to ORDER BY w.customer_id ASC","For each customer, on each date they moved to a new address, how many distinct premises did they move from, if they moved from a premise with an id less than 47, listed in ascending order by customer id?",6,False
"SELECT AVG(z.premise_id), MAX(z.customer_id), z.premise_id, z.address_type_code FROM Customer_Addresses AS z WHERE  z.customer_id = 73 GROUP BY z.premise_id, z.address_type_code HAVING COUNT(z.premise_id) = 82","What are the average premise id, maximum customer id, premise id and address type code for customer 73, grouped by premise id and address type code, where the count of premise id is 82?",2,True
SELECT product_id FROM Products WHERE product_category NOT IN (SELECT product_category FROM Mailshot_Campaigns);,What product ids are in categories that are not included in any mailshot campaigns?,5,True
"SELECT e.mailshot_id, e.customer_id FROM Mailshot_Customers AS e WHERE e.mailshot_id BETWEEN 1 AND 10 OR  e.mailshot_id != 55 ORDER BY e.mailshot_id ASC","What are the mailshot ids and corresponding customer ids for mailshot ids between 1 and 10, or not equal to 55, listed in ascending order of mailshot id?",2,True
"SELECT COUNT(DISTINCT e.product_id), e.product_id, e.product_category FROM Products AS e WHERE  e.product_id < 62 AND product_name IN (SELECT product_name FROM Products WHERE  product_id < 49 LIMIT 9) GROUP BY e.product_category HAVING AVG(e.product_id) < 42 ORDER BY e.product_id DESC LIMIT 10","What are the counts and product ids of distinct products with product ids less than 62, product names appearing among the first 9 product names of products with product ids less than 49, grouped by product category with average product ids less than 42, ordered in descending order by product id, starting from the 10th record?",6,False
"SELECT AVG(Order_Items.order_id), order_item_status_code, item_order_quantity FROM Customer_Orders JOIN Order_Items ON Customer_Orders.order_id = Order_Items.order_id WHERE Order_Items.order_id BETWEEN 1 AND 10 AND  Customer_Orders.customer_id = 70 LIMIT 4","What is the average order id, order item status code, and item order quantity for customer 70's orders with order id between 1 and 10, considering only the next 4 orders after the first 4 orders?",6,True
"SELECT customer_id, outcome_code FROM Mailshot_Customers WHERE customer_id > 36",What are the customer IDs and outcome codes for mailshot customers with IDs greater than 36?,3,True
SELECT COUNT(DISTINCT payment_method) FROM Customers WHERE customer_id BETWEEN 1 AND 10 OR customer_name IN (SELECT customer_name FROM Customers AS e WHERE  e.customer_id <= 38),"How many distinct payment methods are used by the first 10 customers, or by customers whose IDs are between 1 and 38?",6,False
"SELECT COUNT(mailshot_id), mailshot_id FROM Mailshot_Customers JOIN Customers ON Customers.customer_id = Mailshot_Customers.customer_id WHERE mailshot_id = 62 AND customer_name IN (SELECT customer_name FROM Customers LIMIT 1) ORDER BY mailshot_id ASC","What is the count and id of the mailshot with id 62 for the customer with the same name as the first customer in the list, ordered by mailshot id in ascending order?",3,True
"SELECT COUNT(DISTINCT premise_id), premise_id FROM Premises WHERE premise_id = 12 ORDER BY premise_id DESC",How many distinct premise_id are there for premise_id 12 in the Premises table?,6,False
"SELECT COUNT(DISTINCT payment_method), customer_id FROM Customers LIMIT 5",What is the count of distinct payment methods used by each of the next 5 customers?,6,False
"SELECT product_name, product_category FROM Products GROUP BY product_name, product_category;",What are the product names and categories for each product?,2,True
