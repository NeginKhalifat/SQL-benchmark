query,question,iter,flag
"SELECT LOCATION_ID, STREET_ADDRESS FROM locations WHERE  LOCATION_ID >= 51",What are the location IDs and street addresses for locations with IDs greater than or equal to 51?,2,True
"SELECT COUNT(job_history.DEPARTMENT_ID), job_history.DEPARTMENT_ID, job_history.END_DATE FROM job_history WHERE job_history.DEPARTMENT_ID <= 2 GROUP BY job_history.DEPARTMENT_ID, job_history.END_DATE ORDER BY job_history.END_DATE DESC","What is the number of job history records for each department with a department ID less than or equal to 2, grouped by department ID and end date, in descending order of end date?",4,True
SELECT COUNT(DISTINCT END_DATE) FROM employees JOIN job_history ON employees.EMPLOYEE_ID = job_history.EMPLOYEE_ID WHERE  employees.DEPARTMENT_ID >= 6 AND EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM employees AS a WHERE  a.MANAGER_ID = 60 LIMIT 3),How many distinct end dates are there for employees in departments with id 6 or higher who are among the first 3 employees managed by manager with id 60?,6,False
"SELECT SUM(t.DEPARTMENT_ID), t.JOB_ID FROM job_history AS t WHERE  t.EMPLOYEE_ID < 50 GROUP BY t.JOB_ID ORDER BY t.JOB_ID ASC","What is the sum of department ids for each job id, for employees with an id less than 50, ordered by job id?",2,True
"SELECT AVG(MAX_SALARY) AS avg_max_salary, JOB_ID, MIN_SALARY FROM jobs WHERE MIN_SALARY < 64 AND MAX_SALARY NOT IN (SELECT MAX_SALARY FROM jobs WHERE MIN_SALARY = 69) GROUP BY JOB_ID, MIN_SALARY HAVING COUNT(MAX_SALARY) >= 9","What is the average maximum salary, job id, and minimum salary for jobs with a minimum salary of less than 64 and a maximum salary that does not appear in jobs with a minimum salary of 69, for groups of jobs with the same job id and minimum salary that have at least 9 maximum salaries?",3,True
SELECT COUNTRY_ID FROM locations WHERE LOCATION_ID BETWEEN 1 AND 10 OR  LOCATION_ID != 89 LIMIT 9,"What are the country ids of the locations with location id between 1 and 10 or not equal to 89, starting from the 10th record, limited to 9 records?",4,True
"SELECT AVG(job_history.EMPLOYEE_ID), EMAIL FROM employees JOIN job_history ON employees.EMPLOYEE_ID = job_history.EMPLOYEE_ID WHERE employees.EMPLOYEE_ID != 39 AND job_history.JOB_ID IN (SELECT JOB_ID FROM jobs WHERE MAX_SALARY BETWEEN 1 AND 10) ORDER BY EMAIL DESC LIMIT 9","What are the average employee IDs and emails of the employees with job history, excluding employee ID 39, whose job IDs have a maximum salary between 1 and 10, ordered by email in descending order, starting from the 10th row?",6,False
"SELECT STREET_ADDRESS, COUNT(a.LOCATION_ID) FROM locations AS a WHERE a.LOCATION_ID BETWEEN 1 AND 10 OR STATE_PROVINCE IN (SELECT STATE_PROVINCE FROM locations AS z WHERE  z.LOCATION_ID < 40) GROUP BY a.STREET_ADDRESS;","What are the street addresses of locations with a location ID between 1 and 10 or located in the same state province as locations with a location ID less than 40, and how many locations are at each of these addresses?",2,True
SELECT employees.DEPARTMENT_ID FROM employees JOIN jobs ON employees.JOB_ID = jobs.JOB_ID WHERE employees.COMMISSION_PCT <= 26,What are the department ids of employees who have a commission percentage of 26 or less?,5,True
"SELECT COUNTRY_NAME, COUNTRY_ID FROM countries WHERE  REGION_ID = 47",What are the names and IDs of the countries in the region with ID 47?,2,True
"SELECT SUM(SALARY), job_history.DEPARTMENT_ID, PHONE_NUMBER, MANAGER_ID FROM employees JOIN job_history ON employees.EMPLOYEE_ID = job_history.EMPLOYEE_ID WHERE SALARY BETWEEN 1000 AND 10000 GROUP BY job_history.DEPARTMENT_ID, PHONE_NUMBER, MANAGER_ID LIMIT 3","What are the sums of salaries, department IDs, phone numbers and manager IDs for groups of employees with salaries between 1000 and 10000, skipping the first three groups?",6,False
"SELECT COUNT(DISTINCT z.COUNTRY_ID), z.COUNTRY_ID FROM locations AS z",How many unique countries are there in the locations table?,6,False
"SELECT job_history.JOB_ID, FIRST_NAME FROM job_history JOIN employees ON job_history.EMPLOYEE_ID = employees.EMPLOYEE_ID JOIN jobs ON employees.JOB_ID = jobs.JOB_ID JOIN departments ON employees.DEPARTMENT_ID = departments.DEPARTMENT_ID WHERE COMMISSION_PCT = 0.48 LIMIT 10",What are the job IDs and first names of the 11th to 20th employees with a commission percentage of 0.48?,6,False
"SELECT REGION_ID, REGION_ID, REGION_ID, COUNTRY_NAME FROM countries WHERE  REGION_ID <= 60 GROUP BY COUNTRY_NAME ORDER BY REGION_ID DESC LIMIT 8","What are the next eight countries with unique names from regions with IDs less than or equal to 60, listed in descending order of their region IDs?",6,False
"SELECT COUNT(DISTINCT POSTAL_CODE), COUNT(DISTINCT COUNTRY_ID) FROM locations WHERE LOCATION_ID < 18;",How many unique postal codes and country ids are there in locations with a location id less than 18?,2,True
"SELECT COUNT(DISTINCT d.LOCATION_ID), d.DEPARTMENT_NAME FROM departments AS d WHERE  d.DEPARTMENT_ID < 7 ORDER BY d.DEPARTMENT_NAME DESC","What are the distinct location IDs and corresponding department names for departments with IDs less than 7, ordered by department name in descending order?",6,False
SELECT DISTINCT T2.MAX_SALARY FROM job_history T1 JOIN jobs T2 ON T1.JOB_ID = T2.JOB_ID JOIN employees T3 ON T1.EMPLOYEE_ID = T3.EMPLOYEE_ID JOIN departments T4 ON T3.DEPARTMENT_ID = T4.DEPARTMENT_ID WHERE T1.EMPLOYEE_ID = 47 LIMIT 4,"What are the distinct maximum salaries of the jobs held by the employee with id 47, excluding the first 4 results?",2,True
"SELECT COUNT(DISTINCT COUNTRY_NAME), REGION_ID FROM countries WHERE REGION_ID > 73 OR EXISTS (SELECT * FROM locations AS p WHERE p.LOCATION_ID BETWEEN 1 AND 10 AND p.COUNTRY_ID = countries.COUNTRY_ID) GROUP BY REGION_ID ORDER BY REGION_ID DESC","What is the number of unique countries in each region with region id greater than 73, or countries that have locations with location id between 1 and 10, ordered by region id in descending order?",3,True
SELECT employees.DEPARTMENT_ID FROM departments JOIN employees JOIN jobs JOIN job_history ON employees.JOB_ID = jobs.JOB_ID AND employees.EMPLOYEE_ID = job_history.EMPLOYEE_ID AND job_history.JOB_ID = jobs.JOB_ID AND departments.DEPARTMENT_ID = employees.DEPARTMENT_ID WHERE  job_history.DEPARTMENT_ID < 66 OR EXISTS (SELECT * FROM jobs AS u WHERE  u.MAX_SALARY < 51 AND job_history.JOB_ID = u.JOB_ID) ORDER BY employees.DEPARTMENT_ID DESC,"What are the department IDs, in descending order, where the department ID is less than 66 or where there exists a job with a maximum salary less than 51 that an employee has held?",5,True
"SELECT employees.DEPARTMENT_ID, MIN(jobs.MAX_SALARY), COUNT(DISTINCT job_history.DEPARTMENT_ID) FROM employees JOIN job_history ON employees.EMPLOYEE_ID = job_history.EMPLOYEE_ID JOIN jobs ON employees.JOB_ID = jobs.JOB_ID JOIN departments ON employees.DEPARTMENT_ID = departments.DEPARTMENT_ID GROUP BY employees.DEPARTMENT_ID HAVING AVG(jobs.MAX_SALARY) >= 58","Which departments have an average maximum salary of at least 58000, and what is their minimum maximum salary and the number of different departments their employees have worked in?",6,False
SELECT COUNTRY_NAME FROM countries ORDER BY COUNTRY_NAME DESC,What are the country names in reverse alphabetical order?,2,True
"SELECT MIN_SALARY, JOB_ID FROM jobs WHERE MAX_SALARY BETWEEN 1 AND 10 OR JOB_ID NOT IN (SELECT JOB_ID FROM jobs AS h WHERE  h.MIN_SALARY = 1) GROUP BY MIN_SALARY HAVING COUNT(MIN_SALARY) >= 85","What are the job IDs and minimum salaries of jobs with maximum salaries between 1 and 10, or jobs that are not among those with a minimum salary of 1, that appear at least 85 times in the jobs table?",6,False
"SELECT COUNT(DISTINCT countries.REGION_ID), COUNTRY_NAME FROM countries JOIN regions ON countries.REGION_ID = regions.REGION_ID GROUP BY COUNTRY_NAME HAVING COUNT(countries.REGION_ID) <= 74 LIMIT 1","Which country has the lowest number of distinct regions, excluding the country with the highest number of regions?",2,True
"SELECT MAX(EMPLOYEE_ID), COUNT(DISTINCT END_DATE), JOB_ID FROM job_history WHERE  EMPLOYEE_ID > 50 LIMIT 2",What are the job and number of distinct end dates for the two employees with the highest employee IDs greater than 50 in the job history?,6,False
"SELECT AVG(SALARY) AS AVG_SALARY, AVG(COMMISSION_PCT) AS AVG_COMMISSION_PCT, JOB_TITLE FROM employees JOIN jobs ON employees.JOB_ID = jobs.JOB_ID WHERE  COMMISSION_PCT != 0.31 GROUP BY JOB_TITLE",What are the average salary and average commission percentage for each job title where the commission percentage is not 0.31?,2,True
"SELECT SALARY, employees.JOB_ID, LAST_NAME, JOB_TITLE FROM employees JOIN jobs JOIN job_history ON employees.JOB_ID = jobs.JOB_ID AND employees.EMPLOYEE_ID = job_history.EMPLOYEE_ID AND job_history.JOB_ID = jobs.JOB_ID WHERE  job_history.EMPLOYEE_ID <= 10 AND DEPARTMENT_ID <= (SELECT AVG(DEPARTMENT_ID) FROM employees AS n WHERE n.DEPARTMENT_ID BETWEEN 1 AND 10) GROUP BY JOB_TITLE HAVING AVG(employees.EMPLOYEE_ID) <= 65 ORDER BY LAST_NAME DESC","What is the average salary of employees in job titles where the average employee ID is less than or equal to 65, for employees with department ID less than or equal to the average department ID, for the first 10 employees, ordered by last name in descending order?",6,False
"SELECT COMMISSION_PCT, job_history.DEPARTMENT_ID FROM employees JOIN jobs JOIN job_history ON employees.EMPLOYEE_ID = job_history.EMPLOYEE_ID AND job_history.JOB_ID = jobs.JOB_ID JOIN departments ON departments.DEPARTMENT_ID = employees.DEPARTMENT_ID WHERE EXISTS (SELECT * FROM job_history WHERE DEPARTMENT_ID BETWEEN 1 AND 10 AND jobs.JOB_ID = JOB_ID) GROUP BY job_history.DEPARTMENT_ID ORDER BY job_history.DEPARTMENT_ID DESC LIMIT 5","For the 6th to 10th department with the most recent job history in departments 1-10, what is the commission percentage and department id?",6,False
"SELECT COUNT(DISTINCT MIN_SALARY), MIN_SALARY FROM jobs WHERE  MIN_SALARY = 7 OR MIN_SALARY IN (SELECT MIN_SALARY FROM jobs WHERE MIN_SALARY BETWEEN 1 AND 10) ORDER BY MIN_SALARY ASC","How many distinct minimum salaries are there for jobs with a minimum salary of 7 or a minimum salary between 1 and 10, and what are the minimum salaries?",6,True
SELECT REGION_ID FROM countries WHERE REGION_ID BETWEEN 1 AND 10,What are the region ids of countries located in regions 1 through 10?,2,True
SELECT COUNT(DISTINCT EMPLOYEE_ID) FROM job_history WHERE END_DATE = (SELECT END_DATE FROM job_history WHERE EMPLOYEE_ID = 27 ORDER BY START_DATE DESC LIMIT 1),How many employees have job history with an end date equal to the most recent end date of employee 27?,6,False
"SELECT COUNT(DISTINCT job_history.END_DATE), job_history.DEPARTMENT_ID FROM job_history JOIN jobs ON job_history.JOB_ID = jobs.JOB_ID WHERE job_history.EMPLOYEE_ID BETWEEN 1 AND 10 GROUP BY job_history.DEPARTMENT_ID HAVING MIN(job_history.EMPLOYEE_ID) < 80","For each department, how many distinct end dates are there for employees with IDs between 1 and 10, where the department has at least one employee with an ID less than 80?",6,False
