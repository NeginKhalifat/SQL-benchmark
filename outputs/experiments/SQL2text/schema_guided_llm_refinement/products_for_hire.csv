query,question,iter,flag
"SELECT SUM(amount_outstanding), returned_damaged_yn FROM Bookings WHERE  amount_of_refund <= 39",What is the total amount outstanding and the returned damaged status for bookings with a refund amount less than or equal to 39?,5,True
SELECT first_name FROM Customers JOIN Bookings ON Bookings.customer_id = Customers.customer_id,What are the first names of all customers who made a booking?,2,True
"SELECT COUNT(DISTINCT Products_Booked.product_id) as unique_products, product_type_code, MAX(daily_hire_cost) as max_cost FROM Products_Booked JOIN Products_for_Hire ON Products_Booked.product_id = Products_for_Hire.product_id WHERE Products_for_Hire.product_id >= 52 GROUP BY product_type_code HAVING MAX(daily_hire_cost) > 5 ORDER BY product_type_code ASC","What are the unique products, product types, and maximum hire costs for products with IDs 52 or higher, grouped by product type and with maximum hire costs over 5, listed in ascending order by product type?",6,False
"SELECT u.gender_mf, COUNT(DISTINCT u.gender_mf) FROM Customers AS u WHERE u.coupon_id = 96 GROUP BY u.gender_mf LIMIT 7","What are the genders and their respective distinct counts of customers who used coupon 96, listed from the 8th row onwards?",6,False
"SELECT product_id, booking_id FROM View_Product_Availability WHERE  product_id >= 23 LIMIT 3","What are the product and booking IDs for products with IDs 23 and above, starting from the 4th product?",6,False
"SELECT coupon_id, date_became_customer FROM Customers WHERE customer_id = 58 LIMIT 10","What are the coupon_id and date_became_customer of customer with id 58, starting from the 11th record?",3,True
SELECT COUNT(DISTINCT last_name) FROM Customers WHERE gender_mf NOT IN (SELECT gender_mf FROM Customers WHERE coupon_id BETWEEN 1 AND 10 OR  customer_id = 55),How many unique last names of customers are there who do not have a gender that matches the gender of customers with coupon id between 1 and 10 or customer id of 55?,4,True
"SELECT amount_of_discount, amount_of_refund FROM Customers JOIN Bookings ON Bookings.customer_id = Customers.customer_id WHERE  amount_of_discount != 20 AND first_name NOT IN (SELECT first_name FROM Customers WHERE  customer_id = 77)",What is the amount of discount and refund for customers who received a discount other than 20 and are not named the same as the customer with id 77?,2,True
"SELECT product_id, product_id FROM Products_for_Hire",What is the product id of each product?,6,False
"SELECT product_type_code, product_description FROM Products_for_Hire WHERE  product_id >= 72",What are the product type codes and product descriptions for products with ids 72 and above?,2,True
SELECT product_name FROM View_Product_Availability JOIN Products_for_Hire ON Products_for_Hire.product_id = View_Product_Availability.product_id WHERE available_yn IN (SELECT available_yn FROM View_Product_Availability WHERE  product_id <= 99) ORDER BY product_name DESC,"What are the names of the products available for hire, ordered by product name in descending order, when the product is available based on the availability of products with ids less than or equal to 99?",6,False
"SELECT booking_status_code, customer_id FROM Bookings GROUP BY customer_id HAVING COUNT(booking_id) = 22",What are the booking status codes of customers who have made exactly 22 bookings?,6,False
"SELECT amount_of_discount, count_hired, date_became_customer FROM Customers JOIN Bookings ON Bookings.customer_id = Customers.customer_id WHERE amount_of_refund NOT IN (SELECT amount_of_refund FROM Bookings AS u WHERE  u.amount_of_discount != 14 LIMIT 5) GROUP BY amount_of_discount, count_hired, date_became_customer HAVING SUM(amount_of_refund) < 45","What are the amounts of discount, counts of hired products, and dates when customers joined the business for the customers whose total refund amounts are less than 45 and whose refund amounts do not appear among the first 5 refund amounts where the discount amount is not 14?",6,False
"SELECT last_name, available_yn FROM View_Product_Availability JOIN Customers JOIN Bookings ON Bookings.customer_id = Customers.customer_id AND Bookings.booking_id = View_Product_Availability.booking_id WHERE amount_payable BETWEEN 1 AND 10 AND  Customers.customer_id = 18",What are the last names and availability of products booked by customer with id 18 who paid between 1 and 10?,6,False
"SELECT MAX(customer_id), MAX(coupon_id) FROM Customers WHERE coupon_id != 55",What are the maximum customer id and coupon id of customers who did not use coupon 55?,2,True
"SELECT v.available_yn, v.booking_id FROM View_Product_Availability AS v WHERE v.product_id = 54 GROUP BY v.booking_id, v.status_date, v.available_yn;","For the product with id 54, what are the availability statuses for each booking?",6,False
"SELECT MAX(product_id), product_type_code FROM Products_for_Hire WHERE  product_id > 65 GROUP BY product_type_code LIMIT 2","What are the maximum product ids for each product type, excluding the first two product types with the highest maximum product ids, for products with ids greater than 65?",2,True
"SELECT last_name, Bookings.customer_id FROM Customers JOIN Bookings ON Bookings.customer_id = Customers.customer_id WHERE Bookings.customer_id BETWEEN 1 AND 10 OR  amount_of_refund = 48 GROUP BY Bookings.customer_id, last_name",What are the names of customers who have booking IDs between 1 and 10 or received a refund of 48 dollars?,6,False
SELECT coupon_amount FROM Customers JOIN Discount_Coupons ON Customers.coupon_id = Discount_Coupons.coupon_id ORDER BY coupon_amount ASC,"What are the coupon amounts received by customers, listed in ascending order?",2,True
SELECT customer_id FROM Payments WHERE  booking_id = 20,What is the customer id for the payment made for booking id 20?,2,True
SELECT product_type_code FROM Products_for_Hire WHERE  daily_hire_cost < 95 ORDER BY product_type_code DESC,"What are all the product type codes of products with a daily hire cost less than 95, listed in descending order?",2,True
"SELECT MAX(Customers.coupon_id), gender_mf FROM Customers JOIN Discount_Coupons ON Customers.coupon_id = Discount_Coupons.coupon_id WHERE Customers.coupon_id >= 32 GROUP BY gender_mf LIMIT 3","What are the maximum coupon IDs and corresponding customer genders for each gender, for coupon IDs 32 and above, starting from the 4th group?",6,False
"SELECT booking_id, product_id FROM View_Product_Availability WHERE booking_id BETWEEN 1 AND 10 OR EXISTS (SELECT * FROM Bookings WHERE amount_of_discount != 46 AND View_Product_Availability.booking_id = Bookings.booking_id AND View_Product_Availability.status_date = Bookings.booking_start_date)",What are the booking and product IDs for bookings with IDs between 1 and 10 or bookings with discounts other than 46 on the booking start date?,6,False
"SELECT MIN(amount_payable), returned_damaged_yn FROM Bookings WHERE  amount_of_refund != 74",What is the minimum amount payable for bookings with a refund amount other than 74 and what is the damage status of these bookings?,3,True
"SELECT COUNT(amount_due), COUNT(booking_id) FROM Customers JOIN Payments ON Payments.customer_id = Customers.customer_id WHERE  amount_paid < 78 OR EXISTS (SELECT * FROM Bookings AS j WHERE  j.amount_of_refund >= 91 AND Customers.customer_id = j.customer_id) LIMIT 2","How many customers have an amount due and booking id when their amount paid is less than 78, or there exists a booking with an amount of refund greater than or equal to 91, skipping the first 2 results?",6,False
"SELECT c.payment_type_code, c.amount_paid_in_full_yn FROM Payments AS c WHERE c.customer_id BETWEEN 1 AND 10",What are the payment types and full payment status for customers 1 through 10?,3,True
SELECT COUNT(DISTINCT booked_count) FROM Products_Booked WHERE booked_amount > 14,How many distinct booked counts are there for products that have a booked amount greater than 14?,3,True
"SELECT booking_status_code, last_name FROM Customers JOIN Payments JOIN Discount_Coupons JOIN Bookings ON Bookings.customer_id = Customers.customer_id AND Customers.coupon_id = Discount_Coupons.coupon_id AND Payments.customer_id = Customers.customer_id WHERE  amount_payable > 70",What are the booking status codes and last names of customers who paid more than 70?,6,False
SELECT amount_payable FROM View_Product_Availability JOIN Bookings ON Bookings.booking_id = View_Product_Availability.booking_id WHERE  Bookings.booking_id != 57,What are the total amounts payable for all bookings excluding the booking with id 57?,6,False
SELECT booking_status_code FROM Customers JOIN Payments JOIN Bookings ON Bookings.customer_id = Customers.customer_id AND Payments.customer_id = Customers.customer_id WHERE  amount_outstanding <= 82 ORDER BY booking_status_code ASC,"What are the booking status codes for customers with an amount outstanding of less than or equal to 82, listed in ascending order?",6,False
SELECT amount_paid_in_full_yn FROM Payments WHERE  amount_paid = 61 LIMIT 4,What are the payment statuses for the fifth to eighth payments that were exactly 61?,6,False
"SELECT T1.customer_id, T1.last_name, T1.gender_mf FROM Customers AS T1 JOIN Discount_Coupons AS T2 ON T1.coupon_id = T2.coupon_id WHERE T2.coupon_amount BETWEEN 1 AND 10 GROUP BY T1.gender_mf LIMIT 6","What are the customer IDs, last names, and genders of the 7th to 12th customers who received coupons with amounts between 1 and 10, grouped by gender?",6,False
"SELECT COUNT(DISTINCT T2.booking_start_date), T2.amount_of_refund FROM View_Product_Availability AS T1 JOIN Bookings AS T2 ON T2.booking_id = T1.booking_id WHERE T2.booking_id NOT IN (SELECT T1.booking_id FROM View_Product_Availability AS T1 WHERE T1.available_yn = 'Y') GROUP BY T2.amount_of_refund HAVING T2.amount_of_refund < 67 LIMIT 7",What are the 7 amounts of refunds less than 67 that have the most distinct booking start dates for bookings that are not available?,6,False
"SELECT COUNT(DISTINCT payment_date), COUNT(DISTINCT amount_due), payment_id FROM Payments WHERE amount_due >= 92 ORDER BY payment_id DESC","How many unique payment dates and amounts due are there for payments with an amount due of at least 92, and what are the corresponding payment ids, listed in descending order by payment id?",6,False
