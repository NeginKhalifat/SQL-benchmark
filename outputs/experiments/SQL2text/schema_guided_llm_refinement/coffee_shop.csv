query,question,iter,flag
SELECT w.Membership_card FROM member AS w WHERE  w.Level_of_membership != 59 GROUP BY w.Membership_card HAVING AVG(w.Time_of_purchase) >= 29 LIMIT 7,"What are the next 7 membership cards of the members whose level of membership is not 59 and whose average time of purchase is more than or equal to 29, starting from the 8th record?",6,False
SELECT COUNT(DISTINCT HH_ID) FROM happy_hour_member JOIN member ON happy_hour_member.Member_ID = member.Member_ID WHERE  Age >= 74;,How many distinct happy hour members are aged 74 or older?,2,True
"SELECT Open_Year, Address FROM shop WHERE Shop_ID <= (SELECT MIN(Shop_ID) FROM shop AS t WHERE  t.Score >= 97) GROUP BY Address ORDER BY Open_Year ASC","What are the earliest opening years of the shops, grouped by address, for shops with an ID less than or equal to the lowest ID of shops with a score of 97 or higher?",6,False
"SELECT COUNT(DISTINCT Address), Name FROM member JOIN happy_hour_member ON happy_hour_member.Member_ID = member.Member_ID WHERE Total_amount BETWEEN 1 AND 10 OR EXISTS (SELECT * FROM happy_hour_member AS v WHERE  v.Total_amount = 16 AND member.Member_ID = v.Member_ID)","How many distinct addresses are there for members named Name who have spent a total amount between 1 and 10, or have spent a total amount of 16 in any happy hour?",6,False
"SELECT Level_of_membership, Total_amount FROM member JOIN happy_hour_member ON happy_hour_member.Member_ID = member.Member_ID WHERE  Age <= 10 GROUP BY Level_of_membership, Total_amount HAVING AVG(Total_amount) > 18",What are the levels of membership and total amounts for members under the age of 10 who had an average total amount over 18?,6,False
SELECT T1.Age FROM member AS T1 JOIN happy_hour_member AS T2 ON T1.Member_ID = T2.Member_ID WHERE T2.Member_ID < 98,What are the ages of members who have attended happy hour with a member ID less than 98?,2,True
SELECT Shop_ID FROM shop WHERE  Score = 41 LIMIT 5,"What are the shop IDs of the shops with a score of 41, starting from the sixth shop?",2,True
"SELECT AVG(s.HH_ID), s.Month FROM happy_hour AS s GROUP BY s.Month HAVING MAX(s.Shop_ID) > 59",What is the average happy hour ID for each month where the maximum shop ID is greater than 59?,2,True
SELECT y.Member_ID FROM member AS y WHERE y.Time_of_purchase <= 53 LIMIT 7,What are the member IDs of the 8th to 14th members who made a purchase 53 minutes or less after joining?,6,True
"SELECT MIN(HH_ID), MIN(Num_of_shaff_in_charge), AVG(Num_of_shaff_in_charge) as average_num_staff, Shop_ID FROM happy_hour GROUP BY Shop_ID","For each shop, what are the minimum happy hour ID, the minimum and average number of staff in charge during happy hour, and the shop ID?",3,True
"SELECT Level_of_membership, Membership_card FROM member;",What are the membership levels and corresponding membership cards of all members?,2,True
SELECT Month FROM happy_hour WHERE Num_of_shaff_in_charge >= 75 GROUP BY Month ORDER BY Month DESC LIMIT 3;,"What are the last three months in which at least 75 staff members were in charge of happy hour events, listed in descending order?",4,True
"SELECT MAX(Shop_ID), Score FROM shop GROUP BY Score",What is the highest shop ID for each score in the shop table?,2,True
"SELECT COUNT(n.Member_ID), COUNT(DISTINCT n.Level_of_membership), n.Level_of_membership FROM member AS n WHERE n.Level_of_membership BETWEEN 1 AND 10 AND  n.Member_ID > 14","What are the counts of total and distinct levels of membership of members with membership levels between 1 and 10 and member IDs greater than 14, grouped by their levels of membership?",6,False
"SELECT COUNT(DISTINCT o.Shop_ID), o.Score FROM shop AS o WHERE o.Shop_ID BETWEEN 1 AND 10 LIMIT 1","What is the count of distinct shop IDs and the score of shops with shop IDs between 1 and 10, excluding the first result?",6,False
SELECT Shop_ID FROM shop WHERE Shop_ID = 57;,What is the shop ID of the shop with ID 57?,2,True
"SELECT COUNT(DISTINCT Address), Score FROM shop GROUP BY Score ORDER BY Score DESC;","How many distinct addresses are there for each score in the shop table, sorted by score in descending order?",3,True
"SELECT AVG(shop.Score), shop.Open_Year, shop.Num_of_staff FROM shop GROUP BY shop.Open_Year, shop.Num_of_staff",What is the average score of shops by their opening year and number of staff?,2,True
SELECT shop.Address FROM shop WHERE shop.Shop_ID = 49,What is the address of the shop with Shop_ID 49?,2,True
SELECT Num_of_staff FROM shop JOIN happy_hour ON happy_hour.Shop_ID = shop.Shop_ID WHERE Score BETWEEN 1 AND 10 OR Score > 75 ORDER BY Num_of_staff ASC,"What is the number of staff in shops with a score between 1 and 10 or above 75, listed in ascending order of staff number?",2,True
"SELECT x.Month, y.Month FROM happy_hour AS x JOIN happy_hour AS y ON x.HH_ID = y.HH_ID WHERE x.Num_of_shaff_in_charge <= 89;",What are the months with the same happy hour id from the happy hour table where the number of staff in charge is less than or equal to 89?,6,False
"SELECT MAX(Score), Open_Year FROM shop JOIN happy_hour ON happy_hour.Shop_ID = shop.Shop_ID WHERE EXISTS (SELECT * FROM shop AS e WHERE e.Score >= 54 AND happy_hour.Shop_ID = e.Shop_ID) GROUP BY Open_Year HAVING COUNT(shop.Shop_ID) < 36 ORDER BY Open_Year ASC","In each year of opening, what is the highest score of the shops that have at least one happy hour with 54 or more staff members and have fewer than 36 happy hours?",6,False
"SELECT MIN(i.Num_of_shaff_in_charge), COUNT(i.HH_ID) FROM happy_hour AS i WHERE i.Num_of_shaff_in_charge != 58",What is the minimum number of staff in charge of happy hour and how many happy hours have a different number of staff in charge than 58?,2,True
SELECT T1.Open_Year FROM shop AS T1 INNER JOIN happy_hour AS T2 ON T1.Shop_ID = T2.Shop_ID WHERE T2.Shop_ID BETWEEN 1 AND 10 GROUP BY T1.Open_Year HAVING SUM(T1.Score) <= 16,What are the opening years of shops with a total score less than or equal to 16 among shops with IDs between 1 and 10 that have a happy hour?,6,False
