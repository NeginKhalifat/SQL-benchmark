query,question,iter,flag
"SELECT Customer_ID, Customer_Details FROM Customers WHERE Customer_ID = 13 ORDER BY Customer_Details DESC","What is the customer ID and customer details for the customer with ID 13, sorted by customer details in descending order?",3,True
SELECT Customer_Details FROM Customers AS c WHERE EXISTS (SELECT * FROM Customer_Policies AS cp WHERE c.Customer_ID = cp.Customer_ID),What are the customer details of customers who have at least one policy?,2,True
"SELECT COUNT(Amount_Claimed), COUNT(DISTINCT Policy_ID) FROM Claims",What is the total number of claims and the number of unique policies for which claims were made?,4,True
"SELECT Customer_ID, Customer_Details FROM Customers ORDER BY Customer_Details DESC LIMIT 8",What are the customer ids and customer details of the last 8 customers with the most recent customer details when the list is ordered by customer details in descending order?,5,True
SELECT p.Customer_ID FROM Customer_Policies AS p WHERE p.Customer_ID < 10 AND Policy_Type_Code NOT IN (SELECT Policy_Type_Code FROM Customer_Policies AS g WHERE g.Policy_ID BETWEEN 1 AND 10 LIMIT 9),Which customers with customer IDs less than 10 do not have any policy types that are among the first 9 policy types of policies with IDs between 1 and 10?,6,False
SELECT Customer_Details FROM Customers JOIN Customer_Policies JOIN Claims ON Customer_Policies.Customer_ID = Customers.Customer_ID AND Claims.Policy_ID = Customer_Policies.Policy_ID WHERE Amount_Settled BETWEEN 1 AND 10 AND  Amount_Claimed != 60,What are the customer details for customers who have made claims with settled amounts between 1 and 10 and claimed amounts not equal to 60?,2,True
"SELECT MAX(Payments.Settlement_ID), Claim_ID FROM Settlements JOIN Payments ON Payments.Settlement_ID = Settlements.Settlement_ID GROUP BY Claim_ID;",What is the maximum settlement ID for each claim?,6,False
SELECT COUNT(Customer_Details) FROM Customers WHERE Customer_ID < 2 GROUP BY Customer_Details;,How many distinct customer details are there for each customer with a customer ID less than 2?,6,False
SELECT Customer_Policy_ID FROM Settlements WHERE Settlement_ID BETWEEN 1 AND 10 AND EXISTS (SELECT * FROM Claims AS m WHERE m.Policy_ID BETWEEN 1 AND 10 AND Settlements.Settlement_ID = m.Claim_ID LIMIT 2) LIMIT 2,"What are the customer policy IDs for settlements with IDs between 1 and 10 that have at least one matching claim with policy ID between 1 and 10, starting from the 3rd settlement?",6,False
"SELECT Policy_ID, Customer_ID, Policy_Type_Code FROM Customer_Policies ORDER BY Customer_ID ASC LIMIT 8","What are the policy ids, customer ids, and policy type codes of the customers from the 9th to the 16th in ascending order of customer id?",6,False
"SELECT Customer_Policy_ID, Amount_Settled FROM Settlements WHERE Claim_ID < 36 ORDER BY Amount_Settled DESC;","What are the customer policy IDs and corresponding settlement amounts for claims with IDs less than 36, listed in descending order by settlement amount?",3,True
SELECT Customer_Details FROM Customers WHERE Customer_ID != 12 LIMIT 5;,What are the customer details of the first 5 customers excluding the customer with id 12?,3,True
SELECT z.Amount_Settled FROM Claims AS z,What is the amount settled for the claims?,2,True
"SELECT Amount_Payment, Payment_Method_Code FROM Payments WHERE  Amount_Payment != 65 GROUP BY Amount_Payment HAVING AVG(Amount_Payment) <= 98 LIMIT 6","What are the payment amounts and methods for the 7th to 12th smallest groups of payments, excluding groups with an average payment amount greater than 98 and excluding payments of 65?",6,False
"SELECT Policy_Type_Code, Customer_Details, Start_Date FROM Customers JOIN Customer_Policies ON Customer_Policies.Customer_ID = Customers.Customer_ID JOIN Claims ON Claims.Policy_ID = Customer_Policies.Policy_ID JOIN Settlements ON Settlements.Claim_ID = Claims.Claim_ID WHERE Claims.Policy_ID < 21 GROUP BY Start_Date ORDER BY Start_Date DESC","What are the policy type codes, customer details, and start dates of policies with a policy id less than 21 that have been claimed and settled, ordered by start date in descending order?",6,False
"SELECT Policy_Type_Code, Claims.Amount_Claimed FROM Claims JOIN Settlements JOIN Customer_Policies ON Claims.Policy_ID = Customer_Policies.Policy_ID AND Settlements.Claim_ID = Claims.Claim_ID WHERE Customer_Policies.Policy_ID BETWEEN 1 AND 10 AND  Claims.Claim_ID < 51 GROUP BY Claims.Amount_Claimed ORDER BY Policy_Type_Code DESC LIMIT 6","What are the policy type codes and amount claimed for policy IDs between 1 and 10 and claim IDs less than 51, ordered by policy type code in descending order, starting from the 7th entry and showing the next 6 entries?",6,False
"SELECT Settlement_ID, Payment_Method_Code FROM Payments ORDER BY Settlement_ID DESC",What are the settlement IDs and payment method codes for each settlement in descending order of settlement IDs?,2,True
"SELECT COUNT(DISTINCT Amount_Payment), COUNT(DISTINCT Settlement_ID), Payment_Method_Code FROM Payments WHERE  Payment_ID > 83 OR Settlement_ID IN (SELECT Settlement_ID FROM Payments LIMIT 4) GROUP BY Payment_Method_Code HAVING MAX(Settlement_ID) >= 82 LIMIT 7","What are the distinct amounts of payment, distinct settlement ids, and payment method codes for payment ids greater than 83 or for settlement ids in the first four settlements, grouped by payment method codes where the maximum settlement id is 82 or more, and show the results from the 8th row onwards, limited to 7 results?",6,False
"SELECT COUNT(DISTINCT Customer_ID), Claim_ID, Claims.Policy_ID FROM Claims JOIN Customer_Policies ON Claims.Policy_ID = Customer_Policies.Policy_ID WHERE Date_Claim_Settled IS NOT NULL AND Date_Claim_Settled > (SELECT MIN(Date_Claim_Settled) FROM Claims AS k WHERE  k.Policy_ID = 62)",How many unique customers have claims with a policy id and claim id that was settled later than the earliest claim for policy id 62?,6,False
"SELECT Customer_ID, End_Date FROM Customer_Policies GROUP BY End_Date HAVING MIN(Policy_ID) <= 22 ORDER BY Customer_ID ASC","What are the customer IDs and end dates of policies with the smallest policy IDs less than or equal to 22, listed in ascending order by customer ID?",6,False
SELECT v.Settlement_ID FROM Payments AS v JOIN Payments AS p ON p.Payment_ID = v.Payment_ID WHERE v.Settlement_ID NOT IN (SELECT o.Settlement_ID FROM Payments AS o WHERE o.Amount_Payment = 91),What are the settlement ids of payments where the amount payment is not 91?,6,False
SELECT COUNT(DISTINCT cp.Customer_ID) FROM Customer_Policies cp WHERE cp.Policy_ID > 31 OR EXISTS (SELECT * FROM Customers AS m WHERE m.Customer_ID BETWEEN 1 AND 10 AND m.Customer_ID < 53 AND m.Customer_ID = cp.Customer_ID),How many unique customers either have a policy with an ID greater than 31 or have a customer ID between 1 and 10 and less than 53?,2,True
"SELECT MAX(s.Customer_Policy_ID), COUNT(DISTINCT c.Date_Claim_Settled) FROM Claims c JOIN Customer_Policies cp ON c.Policy_ID = cp.Policy_ID JOIN Settlements s ON s.Claim_ID = c.Claim_ID JOIN Payments p ON p.Settlement_ID = s.Settlement_ID WHERE s.Amount_Settled BETWEEN 1 AND 10 AND cp.Customer_ID <= (SELECT MIN(Customer_ID) FROM Customers AS a WHERE a.Customer_ID <= 17)","What is the maximum customer policy ID and the number of distinct dates when claims were settled for amounts between 1 and 10, belonging to customers with IDs less than or equal to the smallest customer ID who is 17 or younger?",6,False
"SELECT Payment_Method_Code, Claims.Amount_Settled FROM Claims JOIN Settlements ON Settlements.Claim_ID = Claims.Claim_ID JOIN Payments ON Payments.Settlement_ID = Settlements.Settlement_ID WHERE Claims.Amount_Settled BETWEEN 1 AND 10 GROUP BY Claims.Amount_Settled HAVING COUNT(Payments.Settlement_ID) >= 19",What are the payment methods used for claim settlements between $1 and $10 with at least 19 payments?,6,False
"SELECT k.Customer_ID, k.Policy_Type_Code FROM Customer_Policies AS k WHERE  k.Customer_ID >= 51 ORDER BY k.Customer_ID ASC LIMIT 7","What are the customer IDs and policy type codes of the 8th to 14th customers with customer IDs greater than or equal to 51, when listed in ascending order by customer ID?",5,True
"SELECT Policy_Type_Code, Customer_ID FROM Customer_Policies WHERE Customer_ID BETWEEN 1 AND 10 AND  Policy_ID >= 11 GROUP BY Customer_ID HAVING COUNT(Customer_ID) >= 41",Which customer IDs between 1 and 10 have 41 or more policies with policy IDs of 11 or higher?,2,True
"SELECT COUNT(DISTINCT C.Date_Claim_Made), COUNT(DISTINCT C.Claim_ID), CP.Policy_Type_Code, MAX(C.Amount_Settled) FROM Customers CU JOIN Customer_Policies CP ON CP.Customer_ID = CU.Customer_ID JOIN Claims C ON C.Policy_ID = CP.Policy_ID WHERE CP.Policy_ID BETWEEN 1 AND 10 GROUP BY CP.Policy_Type_Code HAVING MAX(C.Amount_Claimed) > 42 ORDER BY CP.Policy_Type_Code DESC","For each policy type, what is the number of distinct claim dates and claim IDs, and the maximum amount settled for policies with IDs between 1 and 10, where the maximum claimed amount is greater than 42, sorted by policy type in descending order?",6,False
SELECT Customer_Details FROM Customers WHERE Customer_ID BETWEEN 1 AND 10 OR EXISTS (SELECT * FROM Customer_Policies AS k WHERE k.Policy_ID BETWEEN 1 AND 10 AND Customers.Customer_ID = k.Customer_ID),"What are the customer details for customers with IDs between 1 and 10, or those who have policies with IDs between 1 and 10?",2,True
"SELECT COUNT(DISTINCT Start_Date), Policy_Type_Code FROM Customer_Policies WHERE Policy_ID BETWEEN 1 AND 10 GROUP BY Policy_Type_Code ORDER BY Policy_Type_Code DESC","For each policy type code, how many distinct start dates are there in the customer policies with a policy ID between 1 and 10, listed in descending order by policy type code?",2,True
SELECT Payment_ID FROM Payments WHERE Settlement_ID < 33 ORDER BY Payment_ID DESC;,"What are the payment IDs for all payments with a settlement ID less than 33, listed in descending order?",2,True
