query,question,iter,flag
SELECT SUM(document_id) FROM Ref_Document_Types JOIN Documents JOIN Ref_Shipping_Agents ON Documents.shipping_agent_code = Ref_Shipping_Agents.shipping_agent_code AND Documents.document_type_code = Ref_Document_Types.document_type_code WHERE  document_id > 56 LIMIT 5,"What is the total of document IDs for documents with IDs greater than 56, associated with specific document types and shipping agents, limited to the next 5 after the first 5?",2,True
SELECT SUM(document_id) FROM Documents_Mailed WHERE mailed_to_address_id < (SELECT MIN(mailed_to_address_id) FROM Documents_Mailed),What is the total of the document ids of documents mailed to addresses with ids less than the smallest address id in the documents mailed table?,2,True
"SELECT COUNT(DISTINCT mailing_date), mailed_to_address_id FROM Documents_Mailed WHERE document_id = 78 GROUP BY mailed_to_address_id ORDER BY mailed_to_address_id DESC","For each address that document with id 78 was mailed to, how many distinct mailing dates were there, listed in descending order of address id?",3,True
SELECT COUNT(DISTINCT other_details) FROM Roles JOIN Employees ON Employees.role_code = Roles.role_code LIMIT 10,What are the counts of unique other details of employees with their respective roles starting from the 11th row?,6,False
SELECT document_id FROM Draft_Copies WHERE copy_number BETWEEN 1 AND 10 AND EXISTS (SELECT 1 FROM Circulation_History ch WHERE ch.document_id = Draft_Copies.document_id AND ch.document_id <= 45) ORDER BY document_id DESC,"What are the document ids of draft copies with copy numbers between 1 and 10, for which there exists a circulation history record with a document id less than or equal to 45, ordered by document id in descending order?",3,True
"SELECT AVG(document_id), other_details FROM Documents WHERE document_id != 64 GROUP BY other_details ORDER BY other_details ASC LIMIT 5","What are the average document ids and other details of the first 5 groups of documents with document ids other than 64, sorted by other details in ascending order, excluding the first 4 groups?",4,True
"SELECT COUNT(Draft_Copies.document_id), Draft_Copies.document_id, Document_Drafts.draft_number FROM Draft_Copies JOIN Document_Drafts ON Document_Drafts.document_id = Draft_Copies.document_id WHERE EXISTS (SELECT * FROM Circulation_History AS x WHERE  x.draft_number = 5 AND Draft_Copies.document_id = x.document_id AND Draft_Copies.draft_number = x.draft_number) GROUP BY Draft_Copies.document_id, Document_Drafts.draft_number LIMIT 5","What are the document ids, draft numbers, and counts of draft copies for documents with a draft number of 5 that have been circulated, grouped by document id and draft number, skipping the first 5 results?",6,False
"SELECT COUNT(address_id), address_id FROM Addresses WHERE address_id BETWEEN 1 AND 10 ORDER BY address_id DESC",How many addresses are there between address id 1 and 10 and what are their ids in descending order?,2,True
SELECT e.draft_details FROM Document_Drafts AS e WHERE  e.document_id = 7 ORDER BY e.draft_details DESC,"What are the draft details for document 7, sorted in descending order?",6,False
SELECT T1.draft_number FROM Document_Drafts AS T1 JOIN Circulation_History AS T2 ON T1.document_id = T2.document_id AND T1.draft_number = T2.draft_number JOIN Employees AS T3 ON T2.employee_id = T3.employee_id JOIN Roles AS T4 ON T3.role_code = T4.role_code WHERE T4.role_code NOT IN (SELECT role_code FROM Employees WHERE employee_id = 90 LIMIT 3),What are the draft numbers of the documents circulated to employees with roles other than the top three roles held by employee 90?,6,True
"SELECT COUNT(DISTINCT e.employee_name), e.role_code FROM Employees AS e WHERE  e.employee_id = 4 ORDER BY e.role_code DESC","How many unique names of employees with employee ID 4 are there, and what are their roles, listed in descending order of role code?",4,True
"SELECT COUNT(document_id), shipping_agent_name FROM Documents JOIN Ref_Shipping_Agents ON Documents.shipping_agent_code = Ref_Shipping_Agents.shipping_agent_code GROUP BY shipping_agent_name LIMIT 2","What are the names of the second and third shipping agents with the most documents, and how many documents do they each have?",3,True
"SELECT SUM(employee_id), COUNT(employee_id) FROM Employees WHERE  employee_id >= 51",What is the sum and count of employee ids of employees with an id of 51 or higher?,2,True
"SELECT COUNT(copy_number), employee_id FROM Circulation_History WHERE  employee_id >= 28 GROUP BY employee_id ORDER BY employee_id ASC LIMIT 1","Excluding the first result, what is the employee id and the number of copies of the second employee with an employee id of 28 or more, with the results in ascending order of employee id?",5,True
"SELECT COUNT(DISTINCT z.document_id), z.draft_number FROM Circulation_History AS z WHERE draft_number NOT IN (SELECT draft_number FROM Circulation_History AS d WHERE  d.document_id = 22 LIMIT 7) GROUP BY z.draft_number HAVING COUNT(z.employee_id) = 37",What are the distinct draft numbers and the count of each draft number that have been viewed by exactly 37 employees and not among the 7 earliest draft numbers associated with document 22?,6,False
"SELECT i.copy_number, Circulation_History.draft_number FROM Circulation_History AS i JOIN Circulation_History ON Circulation_History.document_id = i.document_id WHERE  Circulation_History.employee_id = 32 GROUP BY Circulation_History.draft_number HAVING COUNT(Circulation_History.document_id) <= 20 LIMIT 4","What are the copy numbers and draft numbers of the documents handled by employee 32, grouped by draft number, with only the groups that have 20 or fewer documents, starting from the fifth result and limited to four results?",5,True
SELECT address_id FROM Addresses WHERE address_details >= (SELECT SUM(address_details) FROM Addresses WHERE  address_id <= 75),What are the address ids whose address details are greater than or equal to the sum of address details of addresses with an address id of 75 or less?,2,True
"SELECT MAX(address_id), COUNT(DISTINCT receipt_date), document_type_description FROM Ref_Document_Types JOIN Documents JOIN Addresses JOIN Documents_Mailed ON Documents.document_type_code = Ref_Document_Types.document_type_code AND Documents.document_id = Documents_Mailed.document_id AND Documents_Mailed.mailed_to_address_id = Addresses.address_id WHERE address_id BETWEEN 1 AND 10 AND  Documents.document_id >= 51 GROUP BY document_type_description HAVING COUNT(Documents_Mailed.document_id) = 45","What are the maximum address ID, the number of distinct receipt dates, and the document type descriptions for the documents with IDs 51 or higher, mailed to addresses with IDs between 1 and 10, and having exactly 45 distinct document IDs mailed?",6,False
"SELECT COUNT(document_id), document_id FROM Ref_Document_Types JOIN Documents JOIN Ref_Shipping_Agents ON Documents.shipping_agent_code = Ref_Shipping_Agents.shipping_agent_code AND Documents.document_type_code = Ref_Document_Types.document_type_code WHERE shipping_agent_code NOT IN (SELECT shipping_agent_code FROM Documents WHERE document_id BETWEEN 1 AND 10) ORDER BY document_id DESC","How many documents and what are their ids for each type of document that are handled by shipping agents who do not handle documents with ids between 1 and 10, listed in descending order of document id?",6,False
"SELECT Addresses.address_id, n.address_id FROM Addresses JOIN Addresses AS n ON Addresses.address_id = n.address_id WHERE  Addresses.address_id <= 40 AND address_details NOT IN (SELECT address_details FROM Addresses WHERE  address_id != 7 LIMIT 5) ORDER BY Addresses.address_id DESC LIMIT 2",What are the address IDs of the second and third highest address IDs in the Addresses table that have an address ID less than or equal to 40 and do not have address details from the top 5 address details excluding the one with address ID 7?,6,False
