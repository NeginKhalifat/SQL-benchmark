query,question,iter,flag
SELECT lesson_status_code FROM Lessons WHERE staff_id BETWEEN 1 AND 10 OR  customer_id >= 35 ORDER BY lesson_status_code ASC,"What are the lesson status codes for lessons taught by staff with IDs between 1 and 10 or given to customers with IDs 35 or higher, listed in ascending order?",2,True
"SELECT SUM(c.amount_outstanding), COUNT(DISTINCT c.phone_number), c.customer_address_id FROM Customers AS c WHERE c.amount_outstanding BETWEEN 1 AND 10 GROUP BY c.customer_address_id ORDER BY c.customer_address_id ASC LIMIT 3","What is the total amount outstanding, number of unique phone numbers, and customer address ID for customers with an amount outstanding between 1 and 10, grouped by customer address ID and ordered by customer address ID in ascending order, starting from the 4th row and returning 3 rows?",5,True
SELECT city FROM Addresses WHERE  address_id = 53 ORDER BY city ASC,What is the city of the address with id 53 in alphabetical order?,2,True
"SELECT COUNT(DISTINCT lesson_time), vehicle_id FROM Lessons WHERE staff_id BETWEEN 1 AND 10 AND  lesson_id != 89 GROUP BY vehicle_id LIMIT 7","What is the count of distinct lesson times for each vehicle ID for staff IDs between 1 and 10 excluding lesson ID 89, showing results from the 8th to the 14th?",4,True
"SELECT customer_address_id, amount_outstanding FROM Addresses JOIN Customers JOIN Lessons ON Customers.customer_address_id = Addresses.address_id AND Customers.customer_id = Lessons.customer_id WHERE line_1_number_building > (SELECT MIN(line_1_number_building) FROM Addresses WHERE address_id BETWEEN 1 AND 10 AND  address_id <= 52 LIMIT 9) LIMIT 8",What are the customer address ids and the amount outstanding for the 9th to 16th customers with an address having a line 1 number building greater than the smallest line 1 number building of the first 10 addresses with an address id between 1 and 52?,6,False
SELECT vehicle_details FROM Vehicles WHERE vehicle_id BETWEEN 1 AND 10 AND vehicle_id <= (SELECT AVG(vehicle_id) FROM Lessons WHERE vehicle_id >= 71) ORDER BY vehicle_details DESC;,"What are the vehicle details of vehicles with ids between 1 and 10 and less than or equal to the average vehicle id of lessons with vehicle id 71 or more, listed in descending order of vehicle details?",4,True
SELECT e.last_name FROM Staff AS e ORDER BY e.last_name ASC LIMIT 6,What are the next 6 staff members' last names in alphabetical order after the first 6?,6,False
"SELECT s.last_name, s.date_left_staff FROM Addresses AS a JOIN Customers AS c ON c.customer_address_id = a.address_id JOIN Staff AS s ON s.staff_address_id = a.address_id WHERE c.date_became_customer < (SELECT AVG(date_became_customer) FROM Customers) GROUP BY s.date_left_staff, s.last_name HAVING COUNT(c.amount_outstanding) < 39",What are the names and dates of leaving of the staff members who have worked with less than 39 customers who became customers earlier than the average customer?,6,False
"SELECT SUM(Staff.staff_address_id), Addresses.zip_postcode FROM Addresses JOIN Staff ON Staff.staff_address_id = Addresses.address_id WHERE  Addresses.address_id >= 17 OR Addresses.zip_postcode >= (SELECT Addresses.zip_postcode FROM Addresses WHERE  Addresses.address_id = 29) ORDER BY Addresses.zip_postcode ASC","What is the sum of staff address ids for addresses with an id greater than or equal to 17 or a zip postcode greater than or equal to that of address id 29, ordered by zip postcode in ascending order?",6,False
SELECT COUNT(DISTINCT Lessons.staff_id) FROM Staff JOIN Lessons ON Lessons.staff_id = Staff.staff_id WHERE customer_id BETWEEN 1 AND 10 AND first_name IN (SELECT first_name FROM Customers WHERE  customer_id != 69 LIMIT 9),How many distinct staff members are teaching customers with IDs between 1 and 10 and whose first names are among the first 9 names of customers other than customer 69?,6,False
SELECT middle_name FROM Staff JOIN Lessons ON Lessons.staff_id = Staff.staff_id WHERE  lesson_id = 31,What is the middle name of the staff member teaching lesson 31?,2,True
SELECT city FROM Addresses JOIN Customers JOIN Staff JOIN Lessons ON Customers.customer_address_id = Addresses.address_id AND Lessons.customer_id = Customers.customer_id AND Lessons.staff_id = Staff.staff_id AND Staff.staff_address_id = Addresses.address_id WHERE Staff.staff_address_id <= 40 LIMIT 1,What is the city of the second address that is common to both a customer and a staff member who lives in an address with an address id of 40 or less?,6,False
SELECT Staff.last_name FROM Addresses JOIN Staff ON Addresses.address_id = Staff.staff_address_id JOIN Customers ON Customers.customer_address_id = Addresses.address_id JOIN Customer_Payments ON Customer_Payments.customer_id = Customers.customer_id WHERE amount_payment BETWEEN 1 AND 10 AND Addresses.address_id IN (SELECT address_id FROM Addresses),What are the last names of the staff members who live at addresses where customers with payments between 1 and 10 live?,6,False
"SELECT customer_address_id, amount_outstanding, cell_mobile_phone_number FROM Customers WHERE EXISTS (SELECT * FROM Addresses WHERE address_id BETWEEN 1 AND 10 AND Customers.customer_id = Addresses.address_id) GROUP BY customer_address_id, amount_outstanding, cell_mobile_phone_number HAVING MAX(customer_id) < 75 LIMIT 2","What are customer address id, amount outstanding, and cell mobile phone number for the customers whose id matches the address id between 1 and 10, grouped by the mentioned columns, with the highest customer id less than 75, and return the second and third records?",6,False
"SELECT COUNT(staff_address_id), lesson_id, nickname, MIN(middle_name) FROM Staff JOIN Lessons ON Lessons.staff_id = Staff.staff_id WHERE vehicle_id <= 12 GROUP BY lesson_id, nickname HAVING MIN(lesson_id) > 86","What is the count of staff addresses, lesson id, nickname, and the least middle name for each lesson taught by staff using vehicles with an id of 12 or less, where the lesson id is greater than 86?",6,False
"SELECT middle_name, vehicle_details FROM Staff JOIN Lessons ON Lessons.staff_id = Staff.staff_id JOIN Vehicles ON Vehicles.vehicle_id = Lessons.vehicle_id WHERE Staff.staff_id < 68 GROUP BY vehicle_details HAVING MIN(Lessons.vehicle_id) <= 73 ORDER BY vehicle_details DESC LIMIT 5","What are the middle names of staff members and vehicle details, for the 5 most recently used vehicles with a minimum vehicle id of 73 or less, of staff members with staff id less than 68?",6,False
SELECT COUNT(DISTINCT j.amount_payment) FROM Customer_Payments AS j GROUP BY j.customer_id HAVING AVG(j.amount_payment) > 46 LIMIT 8,What are the 9th to 16th highest average customer payment amounts that exceed 46?,6,False
SELECT COUNT(DISTINCT email_address) FROM Addresses JOIN Customers ON Customers.customer_address_id = Addresses.address_id,How many unique email addresses are there among all customers?,6,False
"SELECT amount_outstanding, first_name FROM Customers WHERE customer_address_id BETWEEN 1 AND 10 AND first_name IN (SELECT first_name FROM Staff AS k WHERE k.staff_id BETWEEN 1 AND 10 LIMIT 5) LIMIT 5",What are the amount outstanding and first names of up to 5 customers who live at addresses with IDs between 1 and 10 and have first names matching those of up to 5 staff members with staff IDs between 1 and 10?,6,False
"SELECT COUNT(DISTINCT T.first_name), T.staff_id, T.first_name FROM (SELECT Staff.staff_id, Staff.first_name FROM Staff JOIN Staff AS h ON Staff.staff_id = h.staff_id GROUP BY Staff.staff_id, Staff.first_name) AS T ORDER BY T.first_name ASC","What is the count of distinct first names of staff members along with their staff IDs and first names, listed in ascending order by first name?",6,False
SELECT address_id FROM Addresses JOIN Staff ON Staff.staff_address_id = Addresses.address_id WHERE EXISTS (SELECT * FROM Lessons WHERE staff_id <= 56 AND Staff.staff_id = Lessons.staff_id),What are the address ids of the staff members who have taught at least one lesson and have a staff id less than or equal to 56?,6,False
SELECT AVG(s.vehicle_id) FROM Vehicles AS s WHERE s.vehicle_id BETWEEN 1 AND 10,What is the average vehicle ID of vehicles with IDs between 1 and 10?,2,True
SELECT l.vehicle_details FROM Vehicles AS l WHERE vehicle_id IN (SELECT vehicle_id FROM Lessons AS c LIMIT 7) ORDER BY l.vehicle_details DESC LIMIT 2,What are the second and third most detailed vehicles used in the first 7 lessons?,6,False
"SELECT COUNT(DISTINCT c.phone_number), s.staff_id FROM Addresses a JOIN Customers c ON c.customer_address_id = a.address_id JOIN Staff s ON s.staff_address_id = a.address_id ORDER BY COUNT(DISTINCT c.phone_number) DESC LIMIT 3","What are the staff ids of the top staff members with the most distinct customer phone numbers, excluding the top 3?",6,False
SELECT COUNT(DISTINCT amount_payment) FROM Customer_Payments,How many different payment amounts have been made by customers?,2,True
SELECT vehicle_details FROM Vehicles WHERE  vehicle_id != 38 LIMIT 9,"What are the vehicle details of the next 9 vehicles, excluding the first 9, and not including vehicle 38?",5,True
"SELECT Customer_Payments.customer_id, customer_status_code FROM Customers JOIN Customer_Payments ON Customer_Payments.customer_id = Customers.customer_id WHERE  Customers.customer_id > 35 ORDER BY Customer_Payments.customer_id ASC LIMIT 3","What are the IDs and status codes of customers with IDs greater than 35, listed in ascending order, from the 4th to the 6th customer?",6,False
"SELECT SUM(address_id), COUNT(DISTINCT country) FROM Addresses WHERE address_id <= 90 AND state_province_county NOT IN (SELECT state_province_county FROM Addresses AS g WHERE g.address_id BETWEEN 1 AND 10)","What is the total address ID and the number of distinct countries for addresses with an address ID of 90 or less, excluding those with a state or province that is among the first 10 addresses?",6,False
"SELECT MIN(w.customer_address_id), Customers.customer_id FROM Customers JOIN Customers AS w ON Customers.customer_id = w.customer_id WHERE customer_status_code NOT IN (SELECT customer_status_code FROM Customers AS c WHERE  c.amount_outstanding >= 96)",What is the smallest customer address ID of customers who have not reached a certain outstanding amount?,6,False
"SELECT COUNT(DISTINCT T1.staff_id), T3.email_address FROM Staff AS T1 JOIN Lessons AS T2 ON T1.staff_id = T2.staff_id JOIN Customers AS T3 ON T2.customer_id = T3.customer_id WHERE T2.customer_id <= 92 ORDER BY T3.email_address ASC LIMIT 3","What are the email addresses of the 3 customers with the lowest email address, along with the number of unique staff members who have taught them, considering only lessons given to customers with IDs 92 or less?",6,False
"SELECT AVG(Lessons.vehicle_id), MAX(Customers.customer_id), Staff.middle_name FROM Customers JOIN Customer_Payments JOIN Staff JOIN Lessons ON Customers.customer_id = Lessons.customer_id AND Lessons.staff_id = Staff.staff_id AND Customer_Payments.customer_id = Customers.customer_id GROUP BY Staff.middle_name",What is the average vehicle id and the maximum customer id for each staff middle name?,6,False
"SELECT SUM(price) AS total_price, customer_status_code FROM Customers JOIN Lessons ON Customers.customer_id = Lessons.customer_id GROUP BY customer_status_code HAVING COUNT(Lessons.customer_id) <= 28 ORDER BY customer_status_code ASC","What is the total price of lessons for each customer status, where the total number of lessons is less than or equal to 28, ordered by customer status code?",6,False
"SELECT AVG(Lessons.vehicle_id), Customers.amount_outstanding, Lessons.lesson_status_code FROM Customers JOIN Lessons ON Customers.customer_id = Lessons.customer_id WHERE Lessons.customer_id BETWEEN 1 AND 10 AND EXISTS (SELECT * FROM Lessons AS i WHERE  i.staff_id = 62 AND Customers.customer_id = i.customer_id) GROUP BY Lessons.lesson_status_code, Customers.amount_outstanding ORDER BY Customers.amount_outstanding DESC","For each lesson status code and amount outstanding, what is the average vehicle id for customers with an outstanding amount, who have had lessons with staff id 62 and have a customer id between 1 and 10, sorted by the amount outstanding in descending order?",6,False
"SELECT COUNT(staff_id), staff_id FROM Staff WHERE  staff_id >= 19 ORDER BY staff_id DESC","How many staff members with staff id 19 or above are there, and what are their staff ids, listed in descending order of staff id?",4,True
SELECT s.customer_id FROM Customers AS s WHERE  s.customer_address_id = 12,What are the customer ids of customers whose address id is 12?,2,True
"SELECT Customer_Payments.customer_id, state_province_county, customer_status_code FROM Addresses JOIN Customers ON Customers.customer_address_id = Addresses.address_id JOIN Customer_Payments ON Customer_Payments.customer_id = Customers.customer_id WHERE customer_address_id >= 45 GROUP BY customer_status_code ORDER BY Customer_Payments.customer_id DESC;","What are the customer ids, states or provinces, and statuses of customers with address ids 45 or higher, grouped by status and listed in descending customer id order?",6,False
SELECT middle_name FROM Addresses JOIN Staff ON Staff.staff_address_id = Addresses.address_id WHERE Staff.staff_address_id BETWEEN 1 AND 10,What are the middle names of staff members who live at addresses with ids between 1 and 10?,4,True
