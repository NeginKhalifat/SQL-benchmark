query,question,iter,flag
"SELECT COUNT(DISTINCT name), custid FROM ACCOUNTS GROUP BY custid HAVING COUNT(DISTINCT name) > 1 ORDER BY custid DESC LIMIT 4;","What are the top 4 customer ids with the most distinct account names, where the number of distinct account names is more than 1, listed in descending order of customer id?",6,False
"SELECT MIN(ACCOUNTS.custid), name FROM SAVINGS JOIN ACCOUNTS ON ACCOUNTS.custid = SAVINGS.custid WHERE SAVINGS.custid BETWEEN 1 AND 10 AND name NOT IN (SELECT name FROM ACCOUNTS AS g LIMIT 4) LIMIT 1","What is the name of the account with the smallest customer ID among the accounts with IDs between 1 and 10, excluding the top 4 names with the smallest customer IDs?",6,False
"SELECT CHECKING.custid, balance FROM CHECKING JOIN ACCOUNTS ON CHECKING.custid = ACCOUNTS.custid WHERE ACCOUNTS.custid BETWEEN 1 AND 10 AND  CHECKING.custid > 44 GROUP BY balance HAVING AVG(CHECKING.custid) >= 79","What are the customer ids and balances of checking accounts where the customer id is between 1 and 10, and the customer id is greater than 44, grouped by balance, and having an average customer id of at least 79?",3,True
SELECT custid FROM CHECKING WHERE custid IN (SELECT custid FROM CHECKING WHERE  custid > 9),What are the customer ids of the checking accounts where the customer id is greater than 9?,3,True
SELECT name FROM CHECKING JOIN SAVINGS ON CHECKING.custid = SAVINGS.custid JOIN ACCOUNTS ON SAVINGS.custid = ACCOUNTS.custid WHERE balance < 23 GROUP BY name;,What are the names of customers whose savings balance is less than 23?,6,False
"SELECT A.name, S.balance FROM CHECKING AS C JOIN SAVINGS AS S JOIN ACCOUNTS AS A ON A.custid = S.custid AND C.custid = A.custid WHERE C.balance != 0 GROUP BY A.name, S.balance HAVING COUNT(C.custid) < 71",What are the names and savings balances of customers with less than 71 checking accounts and non-zero checking balances?,3,True
"SELECT MIN(a.custid), a.balance FROM SAVINGS AS a WHERE balance > (SELECT MIN(balance) FROM CHECKING WHERE  balance < 81) GROUP BY a.balance ORDER BY a.balance DESC LIMIT 5","What are the customer IDs with the top 5 highest savings balances, excluding those lower than or equal to the minimum checking balance that is less than 81?",6,False
"SELECT MAX(d.balance), COUNT(DISTINCT d.balance) FROM CHECKING AS d WHERE  d.custid = 14",What is the maximum balance and the number of distinct balances for customer with id 14 in the checking account?,2,True
"SELECT j.balance, j.custid FROM CHECKING AS j WHERE j.balance BETWEEN 1 AND 10 AND balance NOT IN (SELECT balance FROM SAVINGS WHERE  custid > 68)",What are the balances and customer ids of checking accounts with balances between 1 and 10 that do not have matching balances in savings accounts held by customers with ids greater than 68?,6,False
"SELECT SUM(a.custid), SUM(a.balance) FROM SAVINGS AS a WHERE  a.custid > 5 GROUP BY a.balance",What is the total customer id and balance for each balance in the savings account for customers with id greater than 5?,6,False
"SELECT custid, balance FROM SAVINGS WHERE custid >= 8 ORDER BY balance ASC LIMIT 8",What are the customer ids and balances of the next 8 customers with the lowest savings balances after the first 7 customers with customer ids greater than or equal to 8?,5,True
"SELECT MIN(custid), custid FROM ACCOUNTS WHERE  custid > 63 ORDER BY custid ASC",What is the next customer ID after 63 in ascending order?,2,True
SELECT custid FROM ACCOUNTS WHERE  custid != 18 ORDER BY custid ASC,"What are the customer ids of all customers, except customer 18, listed in ascending order?",2,True
SELECT SAVINGS.custid FROM SAVINGS JOIN ACCOUNTS ON ACCOUNTS.custid = SAVINGS.custid WHERE SAVINGS.balance = 9 ORDER BY SAVINGS.custid DESC;,"What are the customer IDs of those with a savings account balance of 9, listed in descending order?",2,True
SELECT name FROM ACCOUNTS WHERE custid BETWEEN 1 AND 10 AND custid >= (SELECT AVG(custid) FROM CHECKING AS p WHERE p.balance BETWEEN 1 AND 10) LIMIT 1,"What is the name of the customer with the second smallest customer ID among customers with a customer ID between 1 and 10, and greater than or equal to the average customer ID of checking accounts with balance between 1 and 10?",2,True
"SELECT balance, name FROM SAVINGS JOIN ACCOUNTS ON ACCOUNTS.custid = SAVINGS.custid WHERE  ACCOUNTS.custid != 46 AND EXISTS (SELECT * FROM CHECKING WHERE  balance != 11 AND ACCOUNTS.custid = custid) ORDER BY balance ASC","What are the balances and names of customers with a balance in their savings account, also having a checking account with a balance other than $11, excluding customer 46, listed in ascending order by balance?",6,False
SELECT name FROM ACCOUNTS JOIN SAVINGS ON ACCOUNTS.custid = SAVINGS.custid JOIN CHECKING ON ACCOUNTS.custid = CHECKING.custid WHERE SAVINGS.balance != 56 ORDER BY name DESC;,"What are the names of customers who have both a savings and a checking account and a savings balance different from 56, listed in descending order?",2,True
"SELECT MAX(custid), name FROM ACCOUNTS WHERE  custid != 26 GROUP BY name HAVING MAX(custid) > 92 ORDER BY name DESC","What is the maximum customer ID for each customer name, excluding customer ID 26, where the maximum ID is greater than 92, listed in descending order by name?",4,True
"SELECT COUNT(custid), custid FROM ACCOUNTS WHERE EXISTS (SELECT * FROM CHECKING WHERE balance != 23 AND ACCOUNTS.custid = CHECKING.custid) GROUP BY custid;",How many checking accounts with a balance other than 23 does each customer have?,4,True
"SELECT CHECKING.custid, SAVINGS.balance FROM CHECKING JOIN SAVINGS JOIN ACCOUNTS ON ACCOUNTS.custid = SAVINGS.custid AND CHECKING.custid = ACCOUNTS.custid WHERE CHECKING.balance BETWEEN 1 AND 10 AND  SAVINGS.custid != 15 GROUP BY SAVINGS.balance ORDER BY SAVINGS.balance DESC LIMIT 8","What are the 9th to 16th highest savings account balances of customers who have between $1 and $10 in their checking account and are not customer 15, along with their customer IDs?",2,True
"SELECT AVG(custid), balance FROM SAVINGS WHERE custid BETWEEN 1 AND 10 AND  balance >= 47 ORDER BY balance DESC","What are the average customer IDs and their corresponding balances for savings accounts with balances of at least 47 and customer IDs between 1 and 10, listed in descending order of balance?",6,False
SELECT MAX(custid) FROM CHECKING WHERE  custid != 46,"What is the maximum customer ID in the checking account, excluding customer 46?",2,True
SELECT balance FROM CHECKING WHERE  balance > 33,What are the balances of the checking accounts with balances over 33?,2,True
