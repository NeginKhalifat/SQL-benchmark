query,question,iter,flag,hardness
"SELECT T1.Name, COUNT(T2.head_ID) FROM department AS T1 JOIN management AS T2 ON T1.Department_ID = T2.department_ID WHERE T1.Budget_in_Billions < 5 ORDER BY COUNT(T2.head_ID) DESC","What are the names of departments with budgets under 5 billion, ranked by the number of heads in descending order?",6,False,hard
"SELECT COUNT(DISTINCT T1.Name), T3.name FROM department AS T1 JOIN management AS T2 ON T1.Department_ID = T2.department_ID JOIN head AS T3 ON T2.head_ID = T3.head_ID WHERE T1.Ranking != 0",What is the count of distinct department names and the names of their respective heads for departments with a non-zero ranking?,6,False,hard
SELECT * FROM department WHERE Department_ID IN (SELECT department_ID FROM management WHERE head_ID IN (SELECT head_ID FROM head WHERE age > 40)),What are the details of departments managed by heads who are older than 40?,3,True,hard
"SELECT MIN(Creation), COUNT(DISTINCT Name) FROM department WHERE Department_ID NOT IN (SELECT department_ID FROM management WHERE temporary_acting = 'no') OR Budget_in_Billions > 10 OR Ranking < 5 GROUP BY Creation HAVING MIN(Creation) < '2020-01-01'","What are the earliest creation years and the number of unique names of the departments, which are either not led by a permanent head, or have a budget over $10 billion, or have a ranking below 5, and were created before 2020-01-01?",6,False,extra
"SELECT COUNT(Department_ID), Name FROM department WHERE EXISTS (SELECT 1 FROM management AS T1 WHERE T1.department_ID = department.Department_ID AND T1.head_ID = ( SELECT head_ID FROM head WHERE age > 50 ) ) AND Ranking > 5 ORDER BY COUNT(Department_ID) DESC","What are the names of the departments with a ranking higher than 5 that are led by a head older than 50 years, sorted by the number of such departments in descending order?",3,True,extra
SELECT DISTINCT head_ID FROM management WHERE department_ID = 1 AND temporary_acting = 'Yes' LIMIT 5,"What are the distinct head ids of temporary acting heads in department 1, listed 6th to 10th?",6,False,medium
"SELECT T1.Name, T2.name FROM department AS T1 JOIN head AS T2 ON T1.Department_ID = T2.head_ID WHERE T1.Ranking <= 5 AND T2.age < 60 ORDER BY T1.Name ASC","What are the names of the top 5 ranked departments and their corresponding head names where the head is under 60 years old, listed in ascending order by department name?",6,False,hard
SELECT * FROM department WHERE Budget_in_Billions >= 10,What are the details of the departments with a budget of 10 billion or more?,2,True,easy
"SELECT T3.name, SUM(T1.Budget_in_Billions), AVG(T1.Num_Employees) FROM department AS T1 JOIN management AS T2 ON T1.Department_ID = T2.department_ID JOIN head AS T3 ON T2.head_ID = T3.head_ID WHERE T1.Ranking > 10 OR T2.temporary_acting BETWEEN '2010-01-01' AND '2020-01-01' OR T3.age = 50","What are the names of the department heads, the total budget in billions, and the average number of employees for departments with a ranking greater than 10, or those with temporary acting management between 2010-01-01 and 2020-01-01, or those with a head aged 50?",6,False,extra
"SELECT COUNT(DISTINCT Name), MAX(Budget_in_Billions), COUNT(Name) FROM department AS d","What is the number of distinct department names, the highest budget in billions, and the total number of department names?",2,True,medium
SELECT COUNT(*) FROM department WHERE (Budget_in_Billions BETWEEN 1 AND 2 OR Ranking > 3) OR Budget_in_Billions > (SELECT AVG(Budget_in_Billions) FROM department) LIMIT 5,"What is the number of the top 5 departments that have either a budget between 1 and 2 billion or a ranking above 3, or have a budget above the average of all departments?",3,True,extra
"SELECT COUNT(DISTINCT T1.Department_ID), COUNT(DISTINCT T2.head_ID) FROM department AS T1 JOIN management AS T2 ON T1.Department_ID = T2.department_ID JOIN head AS T3 ON T2.head_ID = T3.head_ID WHERE T1.Department_ID NOT IN (SELECT T4.Department_ID FROM department AS T4 JOIN management AS T5 ON T4.Department_ID = T5.department_ID WHERE T4.Ranking = 1) ORDER BY T2.head_ID DESC","How many distinct non-top ranked departments and their corresponding distinct heads are there, listed in descending order by head ID?",2,True,extra
SELECT * FROM department WHERE Creation BETWEEN '1960-01-01' AND '1980-01-01',What are the details of departments created between 1960 and 1980?,2,True,easy
SELECT COUNT(DISTINCT T1.head_ID) FROM management AS T1 JOIN management AS T2 ON T1.head_ID = T2.head_ID WHERE T1.department_ID = T2.department_ID ORDER BY COUNT(DISTINCT T1.head_ID) DESC LIMIT 1,Which second most common head ID is shared between two department IDs in the management table?,3,True,extra
SELECT Name FROM department WHERE Budget_in_Billions != 5 ORDER BY Budget_in_Billions DESC LIMIT 1,What is the name of the second highest budget department with a budget not equal to 5 billion?,2,True,hard
"SELECT COUNT(T3.head_ID), T1.Name, T3.head_ID FROM department AS T1 JOIN management AS T2 ON T1.Department_ID = T2.department_ID JOIN head AS T3 ON T3.head_ID = T2.head_ID WHERE T3.age > 30 AND T1.Name = 'Sales' AND T3.head_ID IN (SELECT head_ID FROM head WHERE born_state = 'California') LIMIT 10","What are the names and head IDs of the heads older than 30 from California who are leading the Sales department, and how many are they, returning 10 results after the first 10?",5,True,extra
"SELECT T3.name, COUNT(DISTINCT T2.Department_ID), T1.Name FROM head AS T1 JOIN management AS T2 ON T1.head_ID = T2.head_ID JOIN department AS T3 ON T2.department_ID = T3.Department_ID WHERE T3.Department_ID NOT IN (SELECT T2.department_ID FROM head AS T1 JOIN management AS T2 ON T1.head_ID = T2.head_ID WHERE T2.temporary_acting = 'Y') GROUP BY T3.name ORDER BY COUNT(DISTINCT T2.Department_ID) DESC","What are the names of the permanent heads, the number of departments they manage, and the department names they are in charge of, listed in descending order of the number of departments they manage?",6,False,extra
SELECT name FROM department WHERE Creation BETWEEN '2010' AND '2015' OR Ranking NOT IN (SELECT Ranking FROM department WHERE Budget_in_Billions > 10),"What are the names of the departments created between 2010 and 2015, or departments with a ranking that does not belong to any department with a budget in billions greater than 10?",2,True,extra
"SELECT Name, Creation, Ranking FROM department WHERE Budget_in_Billions > 1","What are the names, creation years, and rankings of the departments with a budget of more than one billion?",2,True,medium
"SELECT T1.Name, T2.name FROM department AS T1 JOIN department AS T2 ON T1.Department_ID = T2.Department_ID WHERE T1.Name BETWEEN 'A' AND 'Z' AND T1.Department_ID NOT IN (SELECT department_ID FROM management) LIMIT 5",What are the names of the first 5 unmanaged departments in the alphabet that have matching IDs?,6,False,extra
