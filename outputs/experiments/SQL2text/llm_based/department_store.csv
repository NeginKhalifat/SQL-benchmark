query,question,iter,flag,hardness
SELECT MAX(T1.product_price) FROM Products AS T1 WHERE T1.product_id BETWEEN 100 AND 200 AND T1.product_price > 50 ORDER BY T1.product_price DESC,What is the maximum product price of products with id between 100 and 200 and price over 50?,2,True,medium
"SELECT T1.supplier_name, SUM(T2.total_value_purchased) FROM Suppliers AS T1 JOIN Product_Suppliers AS T2 ON T1.supplier_id = T2.supplier_id WHERE T2.total_value_purchased <= 1000 ORDER BY T1.supplier_name ASC","What is the total value of purchases made from each supplier, where the total value purchased is less than or equal to 1000, listed in ascending order by supplier name?",6,False,hard
SELECT T1.staff_name FROM Staff AS T1 WHERE T1.staff_id = 10 AND T1.staff_gender = 'M' AND T1.staff_id BETWEEN 5 AND 15,What is the name of the male staff member with a staff id of 10 and whose staff id is between 5 and 15?,5,True,medium
SELECT COUNT(DISTINCT T1.staff_name) FROM Staff AS T1 JOIN Staff_Department_Assignments AS T2 ON T1.staff_id = T2.staff_id WHERE T1.staff_gender = 'Male' AND T2.department_id = 10 AND T2.job_title_code = 'Manager',How many distinct male staff members are assigned as managers in department 10?,2,True,medium
"SELECT COUNT(DISTINCT T1.staff_name), SUM(T2.total_value_purchased) FROM Staff AS T1 JOIN Product_Suppliers AS T2 ON T1.staff_id = T2.supplier_id WHERE T2.date_supplied_from BETWEEN '2020-01-01' AND '2021-01-01' GROUP BY T2.total_value_purchased ORDER BY T2.total_value_purchased ASC","What is the number of distinct staff members and the total value of products purchased by each supplier from January 1st, 2020 to January 1st, 2021, sorted in ascending order by total value purchased?",6,False,extra
"SELECT T1.customer_name, COUNT(T2.order_id) FROM Customers AS T1 JOIN Customer_Orders AS T2 ON T1.customer_id = T2.customer_id WHERE T2.order_status_code != 'Cancelled'",What is the number of non-cancelled orders for each customer?,6,False,medium
"SELECT T1.staff_name, COUNT(T2.staff_name), SUM(T2.staff_id) FROM Staff AS T1 JOIN Staff AS T2 ON T1.staff_id = T2.staff_id WHERE T1.staff_id > 10 GROUP BY T1.staff_name HAVING COUNT(T2.staff_name) > 2 ORDER BY COUNT(T2.staff_name) DESC","What are the names of staff with staff id greater than 10 along with the count and sum of their staff id, grouped by staff name and ordered in descending order of count, when staff is joined with itself on staff id, and only if the count is more than 2?",4,True,extra
"SELECT T1.product_name, SUM(T2.total_value_purchased) FROM Products AS T1 JOIN Product_Suppliers AS T2 ON T1.product_id = T2.product_id GROUP BY T1.product_name HAVING T1.product_name != 'Product A'","What is the total value of each product purchased, excluding Product A?",6,True,medium
SELECT COUNT(DISTINCT T1.product_name) FROM Products AS T1 JOIN Order_Items AS T2 ON T1.product_id = T2.product_id WHERE T2.order_id IN (SELECT T3.order_id FROM Customer_Orders AS T3 WHERE T3.order_date > '2020-01-01') ORDER BY T1.product_name ASC,"What number of distinct product names are there in orders placed after January 1st, 2020?",5,True,extra
"SELECT T1.department_name, COUNT(T2.staff_id) FROM Departments AS T1 JOIN Staff_Department_Assignments AS T2 ON T1.department_id = T2.department_id WHERE T2.date_assigned_to <= '2020-01-01' ORDER BY T1.department_name ASC","What are the department names and the number of staff assigned to each department before January 1, 2020, in ascending order by department name?",6,False,hard
SELECT customer_name FROM Customers WHERE customer_address = 'New York' OR customer_phone NOT IN (SELECT store_phone FROM Department_Stores WHERE store_address = 'Los Angeles'),What are the names of the customers who live in New York or whose phone numbers are not listed among the phone numbers of department stores in Los Angeles?,5,True,extra
SELECT product_name FROM Products WHERE product_price BETWEEN 10 AND 20 OR product_name = 'Product A' OR NOT EXISTS (SELECT 1 FROM Product_Suppliers WHERE Product_Suppliers.product_id = Products.product_id) ORDER BY product_price DESC,"What are the names of the products that cost between 10 and 20, or are named 'Product A', or are not supplied by any supplier, listed in descending order of their prices?",2,True,extra
SELECT T1.staff_name FROM Staff AS T1 WHERE T1.staff_id = ( SELECT MAX(T2.staff_id) FROM Staff AS T2 GROUP BY T2.staff_gender ),What is the name of the staff member with the highest staff id among each gender group?,6,False,hard
"SELECT T1.customer_id, T1.customer_name FROM Customers AS T1 JOIN Customer_Addresses AS T2 ON T1.customer_id = T2.customer_id WHERE T1.customer_id = 5 AND T1.customer_code BETWEEN 100 AND 200 AND T1.customer_id > 10 LIMIT 10","What are the names and IDs of customers with IDs above 10, codes between 100 and 200, and specifically customer ID 5, starting from the 11th customer?",6,False,hard
SELECT T1.staff_id FROM Staff AS T1 JOIN Staff AS T2 ON T1.staff_id = T2.staff_id WHERE NOT EXISTS (SELECT 1 FROM Staff_Department_Assignments AS T3 WHERE T3.staff_id = T1.staff_id AND T3.job_title_code = 'Manager') ORDER BY T1.staff_id DESC,"What are the staff IDs of staff members who have never held the job title of 'Manager', listed in descending order?",3,True,extra
"SELECT COUNT(DISTINCT T1.dept_store_id), SUM(T2.product_price), COUNT(T3.staff_id) FROM Departments AS T1 JOIN Products AS T2 ON T1.department_id = T2.product_type_code JOIN Staff_Department_Assignments AS T3 ON T2.product_id = T3.department_id WHERE T2.product_price <= 10000","What is the number of distinct department stores, the total price of products under 10,000, and the number of staff in those departments?",6,False,hard
"SELECT COUNT(T1.supplier_id), T2.dept_store_chain_name FROM Suppliers AS T1 JOIN Department_Store_Chain AS T2 ON T1.supplier_id != T2.dept_store_chain_id GROUP BY T2.dept_store_chain_name ORDER BY COUNT(T1.supplier_id) DESC LIMIT 10",What are the names of the 11th to 20th department store chains with the most suppliers they do not work with?,6,False,extra
SELECT COUNT(DISTINCT T1.supplier_id) FROM Suppliers AS T1 JOIN Product_Suppliers AS T2 ON T1.supplier_id = T2.supplier_id WHERE T2.date_supplied_from BETWEEN '2020-01-01' AND '2021-01-01' AND T1.supplier_phone = '1234567890',How many distinct suppliers with the phone number '1234567890' supplied products between '2020-01-01' and '2021-01-01'?,2,True,medium
SELECT DISTINCT T1.staff_name FROM Staff AS T1 WHERE EXISTS (SELECT 1 FROM Departments AS T2 WHERE T2.dept_store_id = 1 AND T2.department_id = T1.staff_id LIMIT 10),"What are the names of staff members assigned to department 1 in the department store with ID 1, limited to 10 results?",6,False,hard
"SELECT T1.product_name, SUM(T1.product_price) FROM Products AS T1 JOIN Products AS T2 ON T1.product_id = T2.product_id WHERE T1.product_price <= T2.product_price LIMIT 10",What are the names and total prices of the 10 most expensive products?,6,False,hard
SELECT T1.supplier_name FROM Suppliers AS T1 WHERE T1.supplier_id IN (SELECT T2.supplier_id FROM Product_Suppliers AS T2 GROUP BY T2.supplier_id HAVING MAX(T2.total_value_purchased) > 10000) LIMIT 1,What is the name of the second supplier who has the highest total value purchased for their products?,6,False,extra
"SELECT SUM(T1.product_price), T4.staff_name FROM Products AS T1 INNER JOIN Order_Items AS T2 ON T1.product_id = T2.product_id INNER JOIN Customer_Orders AS T3 ON T2.order_id = T3.order_id INNER JOIN Staff AS T4 ON T3.customer_id = T4.staff_id WHERE T3.order_date BETWEEN '2020-01-01' AND '2020-12-31' AND T4.staff_id NOT IN (SELECT staff_id FROM Staff_Department_Assignments WHERE department_id = 1) ORDER BY SUM(T1.product_price) DESC LIMIT 10","What are the total sales amounts for each staff member not assigned to department 1 in 2020, listed in descending order, starting from the 11th result?",6,False,extra
"SELECT T1.customer_name, COUNT(T3.order_id) FROM Customers AS T1 JOIN Customer_Orders AS T2 ON T1.customer_id = T2.customer_id JOIN Order_Items AS T3 ON T2.order_id = T3.order_id GROUP BY T1.customer_name LIMIT 100","What are the names of customers along with the number of orders they have made, for customers with 101st most orders to 200th most orders?",6,False,extra
