query,question,iter,flag,hardness
"SELECT T1.name, COUNT(DISTINCT T2.name) FROM buildings AS T1 JOIN Office_locations AS T3 ON T1.id = T3.building_id JOIN Companies AS T2 ON T2.id = T3.company_id WHERE T1.Height >= 100 ORDER BY T1.name ASC","What are the names of the buildings with a height of 100 or more, along with the number of distinct companies located in each building, listed in ascending order by building name?",6,False,extra
"SELECT COUNT(DISTINCT T1.name), T2.name FROM buildings AS T1 JOIN Office_locations AS T3 ON T1.id = T3.building_id JOIN Companies AS T2 ON T3.company_id = T2.id WHERE T1.Height < 100",What is the number of distinct building names and the company names that are located in buildings with a height of less than 100?,2,True,hard
SELECT COUNT(Height) FROM buildings WHERE Status != 'completed',How many buildings have a height and are not completed?,6,False,easy
"SELECT T1.name, COUNT(T2.company_id) FROM buildings AS T1 JOIN Office_locations AS T2 ON T1.id = T2.building_id WHERE T1.City != 'New York'",What are the names of the buildings outside of New York and how many companies are located in each of them?,6,False,medium
"SELECT COUNT(DISTINCT T1.name), COUNT(DISTINCT T1.City) FROM buildings AS T1 JOIN Office_locations AS T2 ON T1.id = T2.building_id WHERE T1.Status != 'Abandoned' ORDER BY T1.id DESC LIMIT 10",What are the counts of distinct names and cities of the top 10 non-abandoned buildings with the highest IDs?,6,False,extra
SELECT MIN(Height) FROM buildings WHERE Height < 100 ORDER BY Height DESC LIMIT 5,What are the next five lowest heights among buildings that are under 100 units tall?,4,True,hard
"SELECT b.name, AVG(o.move_in_year) FROM buildings AS b JOIN Office_locations AS o ON b.id = o.building_id WHERE o.company_id = 1 OR b.City = 'New York' OR EXISTS (SELECT 1 FROM Companies AS c WHERE c.id = o.company_id AND c.Sales_billion > 10)","What are the names of buildings and the average move-in year of offices located in them for either company 1, or buildings located in New York, or buildings where the company has sales over 10 billion dollars?",6,False,extra
"SELECT T1.name, T2.Sales_billion FROM buildings AS T1 JOIN Office_locations AS T3 ON T1.id = T3.building_id JOIN Companies AS T2 ON T3.company_id = T2.id WHERE T2.Sales_billion >= 10 ORDER BY T2.Sales_billion DESC LIMIT 10","What are the names of the buildings and sales in billions of the companies located in them, for the 11th to 20th largest companies by sales in billions?",2,True,extra
SELECT COUNT(DISTINCT T1.name) FROM buildings AS T1 WHERE T1.Height > 100 AND T1.Stories > 20 OR EXISTS (SELECT T2.building_id FROM Office_locations AS T2 WHERE T2.building_id = T1.id),"How many unique buildings have a height over 100 and more than 20 stories, or have an office location?",2,True,extra
SELECT T1.name FROM buildings AS T1 WHERE T1.Height > ( SELECT AVG(T2.Height) FROM buildings AS T2 ) LIMIT 1,What is the name of the second-tallest building?,2,True,extra
SELECT T1.name FROM Companies AS T1 WHERE T1.name = 'CompanyA',What is the name of the company named 'CompanyA'?,2,True,easy
"SELECT T1.name, COUNT(DISTINCT T2.company_id) FROM buildings AS T1 JOIN Office_locations AS T2 ON T1.id = T2.building_id WHERE EXISTS (SELECT 1 FROM Companies AS T3 WHERE T3.id = T2.company_id AND T3.Sales_billion > 10)","What are the names of the buildings where at least one company with more than 10 billion in sales has an office, and how many such companies are located in each of these buildings?",3,True,extra
SELECT AVG(Height) FROM buildings WHERE City > 'New York',What is the average height of buildings in cities that come alphabetically after New York?,3,True,easy
SELECT T1.name FROM buildings AS T1 WHERE T1.Stories > 50,What are the names of the buildings that have more than 50 stories?,2,True,easy
SELECT T1.name FROM buildings AS T1 WHERE T1.City = 'New York' AND T1.Height > 100 AND T1.id NOT IN (SELECT T2.building_id FROM Office_locations AS T2) ORDER BY T1.name DESC,"What are the names of the buildings in New York that are taller than 100 and do not have any offices, listed in descending order by name?",4,True,extra
SELECT T1.name FROM buildings AS T1 JOIN Office_locations AS T2 ON T1.id = T2.building_id WHERE T1.name NOT IN (SELECT T3.name FROM Companies AS T3 JOIN Office_locations AS T4 ON T3.id = T4.company_id),What are the names of the buildings that are not occupied by any company?,2,True,extra
"SELECT COUNT(DISTINCT T1.name), COUNT(T1.id) FROM buildings AS T1 JOIN Office_locations AS T2 ON T1.id = T2.building_id",How many unique building names and total buildings are there that have office locations?,2,True,medium
