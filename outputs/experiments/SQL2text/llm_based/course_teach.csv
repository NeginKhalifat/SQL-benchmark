query,question,iter,flag,hardness
SELECT COUNT(DISTINCT T2.Teacher_ID) FROM course AS T1 JOIN course_arrange AS T2 ON T1.Course_ID = T2.Course_ID WHERE T1.Staring_Date BETWEEN '2020-01-01' AND '2020-12-31' ORDER BY T1.Staring_Date DESC,"How many distinct teachers taught courses that started in the year 2020, listed in descending order of the course start date?",3,True,hard
"SELECT T1.Course_ID, T2.Course_ID FROM course AS T1 JOIN course_arrange AS T2 ON T1.Course_ID = T2.Course_ID WHERE T2.Grade = 80 LIMIT 10","What are the matching course IDs in the course and course arrange tables where the grade is 80, starting from the 11th result and returning 10 results?",3,True,hard
"SELECT T1.Name, T3.Course FROM teacher AS T1 JOIN course_arrange AS T2 ON T1.Teacher_ID = T2.Teacher_ID JOIN course AS T3 ON T2.Course_ID = T3.Course_ID WHERE T3.Course_ID >= 100 AND T1.Hometown = 'New York'",What are the names of the teachers from New York and the courses they teach with course id 100 or above?,2,True,hard
SELECT T1.Course FROM course AS T1 WHERE EXISTS (SELECT 1 FROM course_arrange AS T2 WHERE T1.Course_ID = T2.Course_ID AND T2.Grade > 90) ORDER BY T1.Staring_Date DESC LIMIT 10,Which are the 11th to 20th most recently started courses with at least one student having scored more than 90?,2,True,extra
"SELECT T1.Course, AVG(T3.Grade) AS avg_grade, COUNT(T2.Teacher_ID) AS count_teacher FROM course AS T1 JOIN course_arrange AS T3 ON T1.Course_ID = T3.Course_ID JOIN teacher AS T2 ON T2.Teacher_ID = T3.Teacher_ID WHERE T1.Staring_Date BETWEEN '2020-01-01' AND '2021-01-01' GROUP BY T1.Course ORDER BY avg_grade DESC","What courses started between '2020-01-01' and '2021-01-01', along with their average grade and number of teachers, listed in descending order of average grade?",6,False,extra
"SELECT T1.Teacher_ID, COUNT(T2.Course_ID) FROM teacher AS T1 JOIN course_arrange AS T2 ON T1.Teacher_ID = T2.Teacher_ID WHERE T1.Age > 40 AND T2.Grade > (SELECT AVG(Grade) FROM course_arrange)",What are the IDs of teachers over 40 years old and the number of courses they have taught where the grade is higher than the average grade of all courses?,4,True,extra
SELECT T1.Course FROM course AS T1 JOIN course_arrange AS T2 ON T1.Course_ID = T2.Course_ID WHERE T2.Grade < 60 ORDER BY T1.Course ASC,"What are the courses with a grade less than 60, listed in ascending order by course name?",3,True,hard
"SELECT T1.Course, T2.Name FROM course AS T1 JOIN teacher AS T2 ON T1.Course_ID = T2.Teacher_ID WHERE T1.Course != T2.Name",What are the courses that do not match the names of the teachers teaching them?,6,False,medium
"SELECT COUNT(DISTINCT T1.Teacher_ID), COUNT(T1.Course_ID) FROM course_arrange AS T1 WHERE T1.Teacher_ID != 1 ORDER BY T1.Course_ID DESC","How many unique teachers, and how many courses, are there where teacher ID is not 1, listed in descending order by course ID?",6,False,extra
"SELECT T1.Course, T2.Name, T3.Grade FROM course AS T1 JOIN course_arrange AS T3 ON T1.Course_ID = T3.Course_ID JOIN teacher AS T2 ON T2.Teacher_ID = T3.Teacher_ID WHERE T3.Teacher_ID != 2 ORDER BY T3.Grade DESC","What are the courses, teacher names, and grades for courses taught by teachers other than teacher 2, listed in descending order of grade?",2,True,extra
"SELECT T1.Course, SUM(T2.Grade) FROM course AS T1 JOIN course_arrange AS T2 ON T1.Course_ID = T2.Course_ID WHERE T1.Course_ID NOT IN (SELECT Course_ID FROM course_arrange) OR T2.Grade > 80 GROUP BY T1.Course HAVING SUM(T2.Grade) > 100",Which courses have a total grade of more than 100 and either are not assigned to any teacher or have a grade higher than 80?,2,True,extra
"SELECT T1.Course, T2.Name FROM course AS T1 JOIN teacher AS T2 ON T1.Course_ID = T2.Teacher_ID WHERE T1.Staring_Date BETWEEN '2020-01-01' AND '2020-12-31' OR T2.Age > 30 OR T1.Course = 'Math'","What are the courses and their corresponding teacher names for courses that started in the year 2020, or are taught by teachers older than 30, or are math courses?",6,False,extra
"SELECT T1.Teacher_ID, T2.Teacher_ID FROM course_arrange AS T1 JOIN teacher AS T2 ON T1.Teacher_ID = T2.Teacher_ID WHERE T1.Course_ID = 1 ORDER BY T2.Name DESC","What are the IDs of the teachers assigned to course 1, listed in descending order by teacher name?",6,False,hard
SELECT T1.Course FROM course AS T1 JOIN course_arrange AS T2 ON T1.Course_ID = T2.Course_ID WHERE T2.Teacher_ID != 1,What courses are not taught by the teacher with ID 1?,2,True,medium
"SELECT T1.Course, COUNT(DISTINCT T2.Teacher_ID) FROM course AS T1 JOIN course_arrange AS T2 ON T1.Course_ID = T2.Course_ID WHERE T2.Grade <= 80 GROUP BY T1.Course HAVING AVG(T2.Grade) > 75","For each course, how many distinct teachers are assigned to the course when the course's average grade is above 75 and the teacher's grade for the course is below or equal to 80?",3,True,hard
"SELECT COUNT(DISTINCT T1.Course_ID), T2.Name, T2.Hometown FROM course AS T1 JOIN course_arrange AS T3 ON T1.Course_ID = T3.Course_ID JOIN teacher AS T2 ON T2.Teacher_ID = T3.Teacher_ID WHERE T2.Age > 35 AND T2.Hometown = 'New York' AND T1.Course_ID NOT IN (SELECT Course_ID FROM course_arrange WHERE Grade < 80)","How many distinct courses are taught by teachers from New York who are over 35 years old and have never taught a course with a grade lower than 80, and what are their names and hometowns?",5,True,extra
SELECT T1.Course_ID FROM course AS T1 JOIN course_arrange AS T2 ON T1.Course_ID = T2.Course_ID,What are the course IDs of the courses that have been arranged?,6,False,easy
"SELECT T1.Course, COUNT(DISTINCT T3.Teacher_ID) FROM course AS T1 JOIN course_arrange AS T2 ON T1.Course_ID = T2.Course_ID JOIN teacher AS T3 ON T3.Teacher_ID = T2.Teacher_ID WHERE T2.Grade > 3 AND T2.Course_ID BETWEEN 1 AND 10 AND T3.Age > 25 ORDER BY T1.Course DESC","What are the courses with their number of distinct teachers older than 25 who taught with a grade higher than 3 in courses 1 to 10, listed in descending order by course name?",3,True,extra
SELECT T1.Course FROM course AS T1 JOIN course_arrange AS T2 ON T1.Course_ID = T2.Course_ID JOIN teacher AS T3 ON T3.Teacher_ID = T2.Teacher_ID WHERE T1.Course_ID NOT IN (SELECT Course_ID FROM course_arrange WHERE Grade < 60) AND T2.Grade = 90 LIMIT 10,What are the next 10 courses with a grade of 90 that have no grades below 60?,2,True,extra
"SELECT T1.Name, SUM(T2.Grade) FROM teacher AS T1 JOIN course_arrange AS T2 ON T1.Teacher_ID = T2.Teacher_ID WHERE T1.Teacher_ID != 1 GROUP BY T1.Name ORDER BY T1.Name ASC","What is the total grade of courses taught by each teacher, excluding teacher with ID 1, listed in ascending order of teacher name?",3,True,extra
