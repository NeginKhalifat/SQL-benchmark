query,question,iter,flag,hardness
"SELECT E.name, COUNT(*), AVG(C.eid) FROM Employee AS E JOIN Certificate AS C ON E.eid = C.eid JOIN Aircraft AS A ON C.aid = A.aid WHERE E.salary < 50000","What is the name of each employee earning less than 50000, along with the number of certificates they have and their average aircraft ID?",6,False,hard
"SELECT aid, departure_date FROM flight WHERE departure_date BETWEEN '2020-01-01' AND '2020-12-31' ORDER BY departure_date ASC","What are the airline ids and departure dates of all flights that departed in the year 2020, listed in chronological order?",2,True,medium
"SELECT T1.aid, COUNT(T2.eid), T3.name FROM flight AS T1 JOIN certificate AS T2 ON T1.aid = T2.aid JOIN employee AS T3 ON T2.eid = T3.eid GROUP BY T1.aid LIMIT 5","What are the airline ids and the corresponding number of certificates held by employees from each airline, listed for the 6th to 10th airlines?",6,False,extra
SELECT T1.name FROM aircraft AS T1 JOIN flight AS T2 ON T1.aid = T2.aid LIMIT 10,What are the names of the 11th to 20th aircraft?,6,False,medium
SELECT T1.name FROM aircraft AS T1 JOIN flight AS T2 ON T1.aid = T2.aid WHERE T1.distance > 1000,What are the names of the aircraft that have a maximum flying distance of more than 1000 miles?,6,True,medium
"SELECT T1.distance, T2.distance FROM flight AS T1 JOIN flight AS T2 ON T1.distance >= T2.distance ORDER BY T1.distance ASC LIMIT 5",What are the distances of the 5th to 9th shortest flights in ascending order of distance?,6,False,hard
"SELECT COUNT(f.price), f.origin, f.distance FROM flight AS f WHERE f.price > 100 AND f.distance BETWEEN 500 AND 1000 AND f.aid IN ( SELECT aid FROM aircraft WHERE distance > 1000 ) GROUP BY f.origin","For flights costing over 100 dollars and covering a distance between 500 and 1000 miles, operated by aircraft capable of flying over 1000 miles, what is the number of such flights, their origin, and distance covered?",6,False,extra
"SELECT COUNT(DISTINCT T2.aid), T1.aid, T1.distance FROM aircraft AS T1 INNER JOIN flight AS T2 ON T1.aid = T2.aid WHERE T1.distance != 1000",What are the airline IDs and their respective total distances,6,False,medium
"SELECT T1.name, SUM(T2.price) FROM aircraft AS T1 JOIN flight AS T2 ON T1.aid = T2.aid GROUP BY T1.name HAVING SUM(T2.price) > 1000 LIMIT 5",What are the names of the next 5 airlines with a total flight price greater than 1000?,2,True,hard
SELECT T1.distance FROM aircraft AS T1 JOIN flight AS T2 ON T1.aid = T2.aid WHERE T1.distance < 1000 AND T2.distance < 1000,What are the distances of aircraft with a distance less than 1000 miles that have flown a distance less than 1000 miles in a flight?,4,True,medium
SELECT name FROM aircraft WHERE distance >= 1000,What are the names of the aircraft that can travel a distance of 1000 or more?,2,True,easy
"SELECT COUNT(DISTINCT aid), COUNT(DISTINCT name) FROM aircraft WHERE name != 'Boeing' ORDER BY COUNT(DISTINCT aid) DESC LIMIT 1","Which airline, excluding Boeing, has the second highest number of unique airline IDs and what is the count of its unique airline IDs and its name?",6,False,hard
SELECT T1.aid FROM flight AS T1 JOIN aircraft AS T2 ON T1.aid = T2.aid WHERE EXISTS ( SELECT T3.eid FROM employee AS T3 JOIN certificate AS T4 ON T3.eid = T4.eid WHERE T4.aid = T1.aid ) GROUP BY T1.aid HAVING COUNT(T2.name) = 1 LIMIT 10,"What are the airline ids of the flights that can be operated by at least one employee, and for which there is only one type of aircraft, excluding the first 10 results?",6,False,extra
SELECT MAX(distance) FROM flight WHERE distance > 1000 LIMIT 5,"What are the 5 longest flight distances greater than 1000, excluding the first 4 longest distances?",5,True,medium
"SELECT T1.aid, COUNT(DISTINCT T2.aid) FROM flight AS T1 JOIN flight AS T2 ON T1.aid = T2.aid WHERE T1.distance BETWEEN 1000 AND 2000 AND T1.price > 100 LIMIT 5","What are the airline ids and the number of distinct flight numbers for each airline id, for flights with distances between 1000 and 2000 miles and prices over 100, listing the 6th to 10th results?",6,False,hard
SELECT T1.distance FROM flight AS T1 WHERE T1.distance BETWEEN 1000 AND 2000 AND T1.aid IN (SELECT T2.aid FROM aircraft AS T2 WHERE T2.distance > 1500) AND T1.price NOT IN (SELECT T3.price FROM flight AS T3 WHERE T3.origin = 'New York'),"What are the distances of flights with a distance between 1000 and 2000 miles, operated by an aircraft that can cover a distance greater than 1500 miles, and where the price is not offered by any New York-originating flight?",4,True,extra
SELECT T1.destination FROM flight AS T1 WHERE T1.aid NOT IN ( SELECT T2.aid FROM aircraft AS T2 WHERE T2.distance > 1000 ) ORDER BY T1.distance DESC,"What are the destinations of flights operated by aircraft with a range not greater than 1000 miles, listed in order of decreasing flight distance?",2,True,extra
"SELECT COUNT(T1.flno), SUM(T2.distance) FROM flight AS T1 JOIN aircraft AS T2 ON T1.aid = T2.aid JOIN certificate AS T3 ON T2.aid = T3.aid JOIN employee AS T4 ON T3.eid = T4.eid WHERE T1.price > 10000 LIMIT 10",What are the total flight numbers and total distances of the tenth to nineteenth flights with prices over 10000 dollars?,6,True,extra
SELECT T1.name FROM aircraft AS T1 JOIN flight AS T2 ON T1.aid = T2.aid WHERE EXISTS ( SELECT 1 FROM employee AS T3 JOIN certificate AS T4 ON T3.eid = T4.eid WHERE T4.aid = T1.aid ) ORDER BY T1.name DESC,"What are the names of the aircraft for which there exists at least one employee who is certified to operate them, listed in descending order?",2,True,extra
"SELECT T1.origin, T1.destination, T2.destination FROM flight AS T1 JOIN flight AS T2 ON T1.origin = T2.destination AND T1.flno != T2.flno LIMIT 10","What are the origins and destinations of the first 10 pairs of flights with different flight numbers where the origin of the first flight is the destination of the second flight, starting from the 11th pair?",6,False,medium
"SELECT T1.distance * 2, T2.distance * 2, T1.distance + T2.distance FROM flight AS T1 JOIN flight AS T2 ON T1.aid = T2.aid WHERE T1.distance >= 1000 LIMIT 10","What are the doubled distances and the total distances of pairs of flights of the same airline with distance of at least 1000, starting from the 11th result?",6,False,hard
SELECT name FROM Employee WHERE salary > 100000 OR eid = 101 OR name = 'John',What are the names of the employees who have a salary greater than 100000 or employee id 101 or the name 'John'?,2,True,hard
"SELECT COUNT(DISTINCT T1.aid), COUNT(*) FROM flight AS T1 WHERE T1.distance > 1000 AND T1.distance < 3000 AND T1.aid IN (SELECT aid FROM aircraft AS T2 WHERE T2.distance > 2000)","How many unique airlines have flights between 1000 and 3000 miles and also have aircraft that can fly over 2000 miles, and what is the total number of such flights?",2,True,extra
SELECT T1.eid FROM employee AS T1 WHERE EXISTS ( SELECT 1 FROM certificate AS T2 WHERE T2.eid = T1.eid AND T2.aid IN ( SELECT aid FROM aircraft WHERE distance > 1000 ) ) LIMIT 10,"What are the IDs of 10 employees who have a certificate for an aircraft with a range greater than 1000 miles, starting from the 11th employee?",2,True,extra
