query,question,iter,flag,hardness
SELECT T1.customer_first_name FROM Customers AS T1 JOIN Orders AS T2 ON T1.customer_id = T2.customer_id WHERE T1.customer_id != T2.customer_id ORDER BY T1.customer_id DESC,"What are the first names of the customers, in descending order of customer id, where the customer id in the customers table does not match the customer id in the orders table?",6,False,hard
SELECT T1.customer_id FROM Customers AS T1 JOIN Orders AS T2 ON T1.customer_id = T2.customer_id JOIN Invoices AS T3 ON T2.order_id = T3.order_id,What are the customer ids of the customers who have placed orders for which an invoice has been generated?,3,True,medium
SELECT T1.product_name FROM Products AS T1 JOIN Order_Items AS T2 ON T1.product_id = T2.product_id JOIN Orders AS T3 ON T3.order_id = T2.order_id WHERE T2.order_item_id IN (SELECT T1.order_item_id FROM Invoice_Line_Items AS T1 JOIN Invoices AS T2 ON T1.invoice_number = T2.invoice_number WHERE T2.invoice_date > '2020-01-01') ORDER BY T1.product_name ASC,"What are the names of products ordered, where the order item is also invoiced with an invoice date after January 1, 2020, listed in ascending order?",6,False,extra
"SELECT COUNT(DISTINCT T1.product_id) FROM Products AS T1, Products AS T2 WHERE T1.parent_product_id = T2.product_id ORDER BY T1.product_id DESC",How many distinct products are variations of other products?,6,False,hard
"SELECT T1.product_name, COUNT(T2.order_id) FROM Products AS T1 JOIN Order_Items AS T2 ON T1.product_id = T2.product_id WHERE T2.product_quantity BETWEEN 10 AND 20 OR T1.unit_price > 50 OR NOT EXISTS ( SELECT * FROM Invoice_Line_Items WHERE product_id = T1.product_id AND product_price > T1.unit_price ) ORDER BY T1.product_name DESC","What are the names of products ordered between 10 to 20 units or priced over 50 dollars, excluding products sold at a higher price in invoices, listed in descending order by product name along with the number of orders for each product?",6,False,extra
"SELECT T1.customer_first_name, COUNT(T2.order_id) FROM Customers AS T1 JOIN Orders AS T2 ON T1.customer_id = T2.customer_id WHERE T1.customer_id <= 100 ORDER BY T1.customer_first_name DESC",What are the names of the first 100 customers sorted in descending order along with the number of orders each of them has placed?,6,False,hard
"SELECT T1.product_id, COUNT(T2.order_item_id) FROM Products AS T1 LEFT JOIN Order_Items AS T2 ON T1.product_id = T2.product_id WHERE NOT EXISTS (SELECT 1 FROM Invoice_Line_Items AS T3 WHERE T3.product_id = T1.product_id AND T3.derived_total_cost > 100) LIMIT 10",What are the product ids and their respective order item counts for the next 10 products that do not have any invoice line items with a derived total cost greater than 100?,6,False,extra
SELECT COUNT(DISTINCT T1.customer_id) FROM Customers AS T1 WHERE T1.customer_id >= 100,How many unique customers have a customer ID greater than or equal to 100?,2,True,easy
SELECT * FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE date_order_placed > '2020-01-01') AND customer_first_name = 'John' LIMIT 10,"What information is available for the next ten customers named John who have placed orders after January 1, 2020?",3,True,extra
SELECT SUM(T1.order_id) FROM Orders AS T1 WHERE T1.customer_id = 101 OR T1.order_id BETWEEN 1000 AND 2000 OR EXISTS (SELECT T2.order_item_id FROM Order_Items AS T2 WHERE T2.order_id = T1.order_id),What is the sum of order IDs of all orders placed by the customer with ID 101 or with order ID between 1000 and 2000 or of orders that have at least one order item?,5,True,extra
SELECT T1.customer_first_name FROM Customers AS T1 WHERE T1.customer_first_name = 'John' AND T1.customer_id BETWEEN 1 AND 10 AND T1.gender = 'Male' LIMIT 5,What are the first names of the first 5 male customers with customer ids between 1 and 10 whose first name is John?,3,True,medium
SELECT T1.date_order_placed FROM Orders AS T1 WHERE T1.order_id = 102 OR T1.order_id BETWEEN 100 AND 105 OR T1.customer_id > 500,What are the dates of orders with order id 102 or order id between 100 and 105 or customer id greater than 500?,2,True,hard
SELECT T1.customer_id FROM Customers AS T1 WHERE T1.customer_id > 100 AND T1.customer_id IN (SELECT T2.customer_id FROM Accounts AS T2 WHERE T2.account_id < 50) ORDER BY T1.customer_id DESC,"What are the customer id's of customers with id greater than 100 who have an account with id less than 50, listed in descending order?",2,True,extra
SELECT AVG(T1.unit_price) FROM Products AS T1 JOIN Products AS T2 ON T1.product_id = T2.parent_product_id WHERE T1.unit_price < 100,What is the average unit price of products whose parent products have a unit price less than 100?,6,False,medium
SELECT T1.customer_first_name FROM Customers AS T1 WHERE T1.customer_id IN ( SELECT T2.customer_id FROM Orders AS T2 WHERE T2.date_order_placed > '2020-01-01'),"What are the first names of the customers who placed orders after January 1, 2020?",2,True,hard
"SELECT COUNT(DISTINCT T1.customer_first_name), COUNT(DISTINCT T1.customer_last_name) FROM Customers AS T1 WHERE T1.customer_id = 100 AND T1.gender = 'Male' ORDER BY T1.customer_id DESC LIMIT 10",What are the counts of distinct first names and last names of male customers with customer id 100?,6,False,extra
SELECT T1.customer_first_name FROM Customers AS T1 UNION SELECT T2.product_name FROM Products AS T2 WHERE T2.unit_price BETWEEN 10 AND 20 OR T2.product_color = 'Red' OR T2.product_size > 5,"What are the names of customers and products that are either red, have a size greater than 5, or have a price between 10 and 20 dollars?",6,False,hard
"SELECT T1.customer_id, T1.customer_first_name FROM Customers AS T1 WHERE T1.customer_id > 1000 OR T1.customer_id BETWEEN 2000 AND 3000 OR T1.customer_middle_initial = 'A' ORDER BY T1.customer_id ASC LIMIT 10","What are the customer IDs and first names for the next 10 customers, whose IDs are greater than 1000 or between 2000 and 3000, or whose middle initial is 'A', listed in ascending order of customer ID?",2,True,extra
SELECT T1.customer_first_name FROM Customers AS T1 WHERE EXISTS (SELECT T2.order_id FROM Orders AS T2 WHERE T1.customer_id = T2.customer_id AND T2.date_order_placed = '2020-01-01') LIMIT 10,What are the first names of the next 10 customers who placed an order on '2020-01-01'?,6,False,extra
"SELECT T1.product_name, AVG(T2.product_quantity) FROM Products AS T1 JOIN Order_Items AS T2 ON T1.product_id = T2.product_id GROUP BY T1.product_name LIMIT 10","What are the names of the products along with their average order quantities, for the 11th to 20th products in the list ordered by product name?",6,False,hard
SELECT * FROM Products WHERE product_id BETWEEN 100 AND 200 AND unit_price < 50 AND EXISTS (SELECT * FROM Order_Items WHERE product_id = Products.product_id) ORDER BY product_id ASC,"What are the details of all products with IDs between 100 and 200, prices less than 50, that have been ordered, listed in ascending order by product ID?",3,True,extra
SELECT T1.product_name FROM Products AS T1 JOIN Products AS T2 ON T1.product_id = T2.parent_product_id WHERE T1.unit_price < 10,What are the names of the products with unit prices less than 10 that have a parent product?,6,False,medium
"SELECT T1.product_name, T2.product_quantity FROM Products AS T1 JOIN Order_Items AS T2 ON T1.product_id = T2.product_id WHERE T1.unit_price BETWEEN 10 AND 20 AND T2.product_quantity IN (SELECT product_quantity FROM Order_Items WHERE product_quantity > 5) ORDER BY T1.product_name ASC","What are the names and quantities of products with unit prices between 10 and 20, ordered quantities greater than 5, listed in ascending order by product name?",2,True,extra
"SELECT T1.login_name, COUNT(T2.order_id), COUNT(DISTINCT T2.order_id) FROM Customers AS T1 JOIN Orders AS T2 ON T1.customer_id = T2.customer_id WHERE T2.date_order_placed BETWEEN '2020-01-01' AND '2020-12-31'","What are the login names of customers who placed orders in the year 2020, along with the total number of orders and the number of distinct orders they placed?",6,False,extra
