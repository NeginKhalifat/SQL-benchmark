query,question,iter,flag,hardness
"SELECT COUNT(DISTINCT T1.Name), T3.Name FROM member AS T1 JOIN membership_register_branch AS T2 ON T1.Member_ID = T2.Member_ID JOIN branch AS T3 ON T2.Branch_ID = T3.Branch_ID WHERE T3.Address_road != 'New York' LIMIT 10","What are the names of the top 10 branches with the most distinct member names, excluding branches located on 'New York' address road?",6,False,extra
"SELECT AVG(Level), SUM(Total_pounds) FROM member AS T1 INNER JOIN purchase AS T2 ON T1.Member_ID = T2.Member_ID AND T2.Year = '2015' WHERE T1.Level = 1 ORDER BY T2.Total_pounds ASC LIMIT 5",What is the average level and total pounds of the 6th to 10th purchases in 2015 made by level 1 members when ordered from least to greatest by total pounds?,2,True,extra
"SELECT Name, COUNT(Level) FROM member WHERE Hometown = 'London' GROUP BY Name LIMIT 10","What are the names of members from London and the count of their levels, listed from the 11th to the 20th result?",6,False,hard
"SELECT COUNT(DISTINCT T1.Member_ID), COUNT(DISTINCT T2.Branch_ID), T1.Name FROM member AS T1 JOIN membership_register_branch AS T2 ON T1.Member_ID = T2.Member_ID WHERE T1.Level < 5 LIMIT 10","What are the names of members with level less than 5, along with the number of distinct members and the number of distinct branches they are registered in, listed from the 11th to the 20th result?",6,False,hard
SELECT * FROM member AS T1 WHERE T1.Level BETWEEN 1 AND 10,What are the details of all members with a level between 1 and 10?,2,True,easy
"SELECT T1.Name, SUM(T4.Total_pounds) FROM member AS T1 JOIN membership_register_branch AS T2 ON T1.Member_ID = T2.Member_ID JOIN branch AS T3 ON T2.Branch_ID = T3.Branch_ID JOIN purchase AS T4 ON T3.Branch_ID = T4.Branch_ID WHERE T1.Level > 2 OR T4.Year = '2018' LIMIT 10","What are the names of the next 10 members with a level greater than 2 or total pounds purchased in 2018, along with their total pounds purchased?",6,False,extra
"SELECT T1.Branch_ID, COUNT(DISTINCT T2.Member_ID) FROM branch AS T1 JOIN purchase AS T2 ON T1.Branch_ID = T2.Branch_ID WHERE T1.Branch_ID IN (SELECT T3.Branch_ID FROM branch AS T3 JOIN membership_register_branch AS T4 ON T3.Branch_ID = T4.Branch_ID) ORDER BY T1.Branch_ID DESC LIMIT 1",What is the branch ID and the number of unique members who made purchases in the second most recent branch that has registered members?,6,False,extra
"SELECT COUNT(DISTINCT Member_ID), COUNT(DISTINCT Card_Number), AVG(Level) FROM member WHERE Level >= 3 LIMIT 10","What are the number of distinct member IDs, distinct card numbers, and the average level of members with a level of 3 or higher, for rows 11 to 20?",6,True,extra
"SELECT T1.Member_ID, T2.Branch_ID FROM member AS T1 JOIN membership_register_branch AS T2 ON T1.Member_ID = T2.Member_ID WHERE EXISTS (SELECT 1 FROM purchase AS T3 WHERE T3.Member_ID = T1.Member_ID AND T3.Branch_ID = T2.Branch_ID)",What are the member and branch ID combinations where a purchase has been made by a member at the branch they are registered to?,2,True,extra
"SELECT T1.Name, T1.Level FROM member AS T1 WHERE T1.Level BETWEEN 1 AND 2",What are the names and levels of members with levels between 1 and 2?,2,True,medium
"SELECT T1.Member_ID, COUNT(DISTINCT T2.Branch_ID) FROM member AS T1 JOIN membership_register_branch AS T2 ON T1.Member_ID = T2.Member_ID WHERE T1.Level > 1 AND T1.Card_Number = 'silver' AND T2.Register_Year BETWEEN '2000' AND '2010' GROUP BY T1.Member_ID HAVING COUNT(T2.Branch_ID) > 2 ORDER BY T1.Member_ID ASC","What are the IDs of silver-level members who have been members of more than two different branches between 2000 and 2010, ordered by member ID?",6,False,extra
SELECT COUNT(DISTINCT T2.Name) FROM membership_register_branch AS T1 INNER JOIN member AS T2 ON T1.Member_ID = T2.Member_ID WHERE T1.Register_Year BETWEEN 2010 AND 2015 AND T2.Level > 10,How many unique members with a level greater than 10 registered a branch between 2010 and 2015?,6,False,medium
SELECT AVG(T1.Level) FROM member AS T1 JOIN membership_register_branch AS T2 ON T1.Member_ID = T2.Member_ID WHERE T1.Level > 1 AND T2.Register_Year BETWEEN '2010' AND '2015',What is the average level of members who registered to a branch between 2010 and 2015 and have a level greater than 1?,2,True,medium
"SELECT T1.Name, COUNT(T2.Member_ID) FROM member AS T1 JOIN membership_register_branch AS T2 ON T1.Member_ID = T2.Member_ID WHERE T2.Register_Year BETWEEN 2000 AND 2010 AND T1.Level > 1 GROUP BY T1.Name","What is the total number of memberships per member name for members with a level higher than 1, who registered between 2000 and 2010?",4,True,hard
"SELECT T1.Name, T1.Level FROM member AS T1 WHERE T1.Level >= 3 ORDER BY T1.Level ASC","What are the names and levels of members with level 3 or higher, listed in ascending order of level?",2,True,medium
SELECT T1.Name FROM member AS T1 JOIN membership_register_branch AS T2 ON T1.Member_ID = T2.Member_ID JOIN branch AS T3 ON T2.Branch_ID = T3.Branch_ID WHERE T1.Level > 5 OR T3.membership_amount = 'High' OR T1.Hometown IN (SELECT City FROM branch) ORDER BY T1.Member_ID DESC,"What are the names of members with a level greater than 5, or belonging to a branch with high membership amount, or from a city where a branch is located, listed in descending order of member ID?",6,False,extra
"SELECT Name, Level FROM member LIMIT 10",What are the names and levels of the next 10 members after the first 10?,6,False,medium
"SELECT COUNT(DISTINCT T1.Member_ID) , T1.Name FROM member AS T1 JOIN membership_register_branch AS T2 ON T1.Member_ID = T2.Member_ID WHERE T2.Register_Year >= '2010'","How many distinct members, along with their names, joined a branch in 2010 or later?",6,False,medium
"SELECT T1.Name, SUM(T2.Total_pounds) FROM member AS T1 JOIN purchase AS T2 ON T1.Member_ID = T2.Member_ID WHERE T1.Level = 2 AND T2.Total_pounds > 100 AND T1.Member_ID IN (SELECT Member_ID FROM membership_register_branch) GROUP BY T1.Name ORDER BY T1.Name ASC","What is the total amount of pounds purchased by each level 2 member from a branch they are registered with, where the total pounds purchased exceeds 100?",6,False,extra
