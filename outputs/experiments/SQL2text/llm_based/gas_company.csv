query,question,iter,flag,hardness
"SELECT T1.Company, COUNT(DISTINCT T2.Station_ID) AS Station_Count FROM company AS T1 JOIN station_company AS T2 ON T1.Company_ID = T2.Company_ID WHERE T1.Market_Value >= 100 ORDER BY Station_Count ASC","What are the companies with a market value of at least 100, listed in ascending order of the number of distinct gas stations they have?",5,True,hard
"SELECT COUNT(DISTINCT T1.Company_ID), T1.Company, T1.Headquarters FROM company AS T1 WHERE T1.Company_ID = 1 OR T1.Company = 'ABC Inc' OR T1.Headquarters IN (SELECT T2.Headquarters FROM company AS T2 WHERE T2.Company_ID = 1) ORDER BY T1.Company_ID DESC","What is the count of distinct companies with company ID 1 or company name 'ABC Inc' or headquarters of company ID 1, along with their respective company names and headquarters, ordered by company ID in descending order?",3,True,extra
"SELECT T1.Company, AVG(T1.Sales_billion) FROM company AS T1 JOIN station_company AS T2 ON T1.Company_ID = T2.Company_ID JOIN gas_station AS T3 ON T2.Station_ID = T3.Station_ID GROUP BY T1.Company HAVING AVG(T1.Sales_billion) > 10 LIMIT 5","What are the companies with average sales exceeding 10 billion, listed from the sixth to the tenth?",6,False,extra
"SELECT COUNT(DISTINCT Headquarters) , COUNT(DISTINCT Main_Industry) , COUNT(DISTINCT Company) FROM company WHERE Rank != 1","How many companies, headquarters, and main industries are there among companies that are not ranked first?",2,True,medium
"SELECT Company, Headquarters, Main_Industry FROM company WHERE Sales_billion > 10 ORDER BY Rank DESC LIMIT 5","What are the companies, their headquarters, and main industries of the next 5 largest companies with sales over 10 billion, ordered by rank in descending order?",2,True,hard
"SELECT T3.Company, T1.Location FROM gas_station AS T1 JOIN station_company AS T2 ON T1.Station_ID = T2.Station_ID JOIN company AS T3 ON T2.Company_ID = T3.Company_ID WHERE T3.Rank > 5 OR T1.Manager_Name = 'John' AND NOT EXISTS (SELECT 1 FROM company WHERE Sales_billion > 10) ORDER BY T3.Company_ID DESC","What are the companies and locations of gas stations with a company rank greater than 5 or managed by John, where no company has sales greater than 10 billion, sorted by company ID in descending order?",6,False,extra
"SELECT T1.Company, T1.Headquarters FROM company AS T1 WHERE T1.Rank < 10 ORDER BY T1.Company_ID DESC",What are the companies and their headquarters for the top 9 companies with the highest company id?,6,False,medium
SELECT T2.Company FROM station_company AS T1 JOIN company AS T2 ON T1.Company_ID = T2.Company_ID WHERE T1.Rank_of_the_Year <= 10,What are the names of the companies that have a rank of the year 10 or less in the gas stations?,3,True,medium
"SELECT T1.Company, T2.Manager_Name FROM company AS T1 JOIN station_company AS T3 ON T1.Company_ID = T3.Company_ID JOIN gas_station AS T2 ON T3.Station_ID = T2.Station_ID WHERE T1.Sales_billion > 100 AND T2.Manager_Name = 'John'",Which companies with sales over 100 billion dollars have a gas station managed by John?,6,False,hard
"SELECT T2.Company, T3.Manager_Name FROM company AS T1 JOIN station_company AS T2 ON T1.Company_ID = T2.Company_ID JOIN gas_station AS T3 ON T2.Station_ID = T3.Station_ID WHERE T2.Rank_of_the_Year > 10 AND T3.Open_Year > 2000 ORDER BY T3.Open_Year DESC","What are the companies and their corresponding manager names for the gas stations that opened after 2000, ordered by the opening year in descending order, for companies with a rank of the year greater than 10?",2,True,extra
SELECT Company_ID FROM company WHERE Sales_billion > 10 AND Profits_billion IN (SELECT Profits_billion FROM company WHERE Assets_billion > 100) ORDER BY Company_ID ASC,"What are the IDs of the companies with sales over 10 billion and profits that are also achieved by companies with assets over 100 billion, listed in ascending order of company ID?",2,True,extra
"SELECT Company_ID, COUNT(*) FROM company WHERE Rank BETWEEN 10 AND 50 OR Headquarters = 'New York' OR EXISTS (SELECT 1 FROM station_company WHERE company.Company_ID = station_company.Company_ID) ORDER BY Company_ID ASC","What are the company IDs of companies either ranked between 10 and 50, or having headquarters in 'New York', or owning a gas station, along with the count of each type?",6,False,extra
"SELECT COUNT(DISTINCT Company), COUNT(DISTINCT Headquarters), COUNT(DISTINCT Main_Industry) FROM company WHERE Sales_billion <= 100","For companies with sales less than or equal to 100 billion, how many distinct companies, headquarters, and main industries are there?",2,True,medium
"SELECT T1.Company, T2.Company FROM company AS T1 JOIN company AS T2 ON T1.Rank <= T2.Rank LIMIT 5",What are the names of the top 6-10 companies in order of their rank?,6,False,medium
"SELECT T1.Company, T2.Manager_Name FROM company AS T1 JOIN station_company AS T3 ON T1.Company_ID = T3.Company_ID JOIN gas_station AS T2 ON T3.Station_ID = T2.Station_ID WHERE T1.Market_Value > 10000","What are the names of companies and their corresponding managers for companies with a market value greater than 10,000?",2,True,hard
"SELECT Company, Headquarters FROM company AS T1 WHERE Main_Industry = 'Retail' OR Company IN (SELECT Company FROM company AS T2 WHERE Rank = 1)",What are the names and headquarters of retail companies or companies ranked as number one?,2,True,extra
"SELECT COUNT(DISTINCT T1.Company_ID), T1.Sales_billion, T2.Location FROM company AS T1 JOIN station_company AS T3 ON T1.Company_ID = T3.Company_ID JOIN gas_station AS T2 ON T3.Station_ID = T2.Station_ID WHERE T2.Station_ID = (SELECT Station_ID FROM gas_station WHERE Location = 'New York')","How many unique companies, with what sales in billions, are located at the gas station in New York?",6,False,extra
SELECT COUNT(DISTINCT Company_ID) FROM company WHERE Rank = 1 AND Headquarters = 'USA' AND EXISTS (SELECT 1 FROM gas_station WHERE Open_Year > 2010 LIMIT 10),How many top-ranked companies are headquartered in the USA and have associated gas stations that opened after 2010?,6,False,extra
