query,question,iter,flag,hardness
SELECT COUNT(DISTINCT T1.Customer_ID) FROM Customers AS T1 JOIN Customers_Policies AS T2 ON T1.Customer_ID = T2.Customer_ID WHERE T2.Date_Opened BETWEEN '2020-01-01' AND '2020-12-31' AND T1.Customer_name IN (SELECT Customer_name FROM Customers WHERE Customer_ID > 100),How many distinct customers with a customer ID greater than 100 purchased a policy in the year 2020?,6,False,extra
SELECT AVG(T1.Settlement_Amount) FROM Settlements AS T1 JOIN Claims AS T2 ON T1.Claim_ID = T2.Claim_ID WHERE T2.Effective_Date BETWEEN '2020-01-01' AND '2020-12-31' AND T2.FNOL_ID > 100 ORDER BY T1.Settlement_Amount DESC,"What is the average settlement amount for claims with effective dates in the year 2020 and FNOL IDs greater than 100, listed in descending order by settlement amount?",6,False,hard
SELECT T1.Customer_name FROM Customers AS T1 JOIN First_Notification_of_Loss AS T2 ON T1.Customer_ID = T2.Customer_ID JOIN Services AS T3 ON T3.Service_ID = T2.Service_ID JOIN Claims AS T4 ON T2.FNOL_ID = T4.FNOL_ID WHERE T4.Claim_ID = 1,What is the name of the customer associated with claim ID 1?,2,True,extra
SELECT COUNT(DISTINCT Customer_ID) FROM First_Notification_of_Loss WHERE Service_ID >= 10,How many unique customers have a service ID of 10 or higher when they first notify of loss?,2,True,easy
"SELECT COUNT(Claim_ID), Settlement_Amount FROM Settlements WHERE Settlement_Amount = 1000 ORDER BY Settlement_Amount DESC",What is the count of claims with the highest settlement amount of 1000 dollars?,6,False,medium
SELECT Settlement_Amount FROM Settlements WHERE Settlement_Amount > (SELECT AVG(Settlement_Amount) FROM Settlements) LIMIT 10,What are the 11th to 20th highest settlement amounts received?,4,True,extra
SELECT COUNT(Claim_ID) FROM Claims WHERE Effective_Date <= '1990-01-01',"How many claims were effective before or on January 1st, 1990?",2,True,easy
SELECT * FROM First_Notification_of_Loss WHERE Customer_ID <= 100,What are the details of all first notifications of loss for customers with a customer id of 100 or less?,2,True,easy
SELECT T1.Customer_name FROM Customers AS T1 JOIN First_Notification_of_Loss AS T2 ON T1.Customer_ID = T2.Customer_ID WHERE T2.Service_ID = 1 AND EXISTS (SELECT 1 FROM Settlements AS T3 WHERE T3.Claim_ID = T2.FNOL_ID) ORDER BY T1.Customer_name ASC,"What are the names of customers who have a first notification of loss with service id 1 and a corresponding settlement, listed in ascending order by customer name?",4,True,extra
SELECT * FROM Available_Policies WHERE policy_type_code = 'type1' OR Customer_Phone LIKE '%123%' OR Policy_ID BETWEEN 100 AND 200 OR NOT EXISTS (SELECT 1 FROM Customers_Policies WHERE Available_Policies.Policy_ID = Customers_Policies.Policy_ID LIMIT 1) LIMIT 5,"What are the next five available policies with type 'type1', phone number containing '123', or policy id between 100 and 200, excluding those already purchased by a customer?",4,True,extra
SELECT DISTINCT T1.Customer_name AS New_Name FROM Customers AS T1 WHERE T1.Customer_name != 'ABC',What are the distinct customer names excluding 'ABC'?,2,True,easy
SELECT Settlement_Amount FROM Settlements WHERE Settlement_Amount < 10000 LIMIT 10,"What are the settlement amounts less than 10,000, starting from the 11th, for the next 10 settlements?",3,True,medium
"SELECT COUNT(DISTINCT T1.Customer_ID), COUNT(T1.Customer_ID), T1.Customer_name FROM Customers AS T1 WHERE T1.Customer_ID != 1 LIMIT 10","Excluding customer 1, what are the names and the distinct and total counts of the next 10 customers?",6,False,extra
"SELECT T1.Customer_name, T2.Service_name FROM Customers AS T1 JOIN Services AS T2 ON T1.Customer_ID = T2.Service_ID WHERE T1.Customer_ID = 10 LIMIT 5",What are the names of the customer with ID 10 and the corresponding service names starting from the 6th result?,6,False,hard
SELECT T1.Customer_ID FROM Customers AS T1 WHERE T1.Customer_ID NOT IN (SELECT T2.Customer_ID FROM Customers AS T2 GROUP BY T2.Customer_ID HAVING COUNT(T2.Customer_ID) = 1),What are the customer IDs of customers who appear more than once in the list of customers?,3,True,hard
SELECT T1.policy_type_code FROM Available_Policies AS T1 JOIN First_Notification_of_Loss AS T2 ON T1.Policy_ID = T2.Policy_ID WHERE NOT EXISTS (SELECT T3.Customer_Phone FROM Available_Policies AS T3 JOIN Customers_Policies AS T4 ON T3.Policy_ID = T4.Policy_ID WHERE T3.policy_type_code = T1.policy_type_code AND T4.Date_Closed IS NULL) GROUP BY T1.policy_type_code HAVING AVG(T2.Service_ID) > 10,What are the policy types where all policies are closed and the average service id of the first notification of loss is greater than 10?,6,False,extra
SELECT T1.Customer_ID FROM Customers_Policies AS T1 JOIN Customers_Policies AS T2 ON T1.Customer_ID = T2.Customer_ID WHERE T1.Policy_ID BETWEEN 100 AND 200 LIMIT 10,"Which customer IDs have a policy ID between 100 and 200, listed from the 11th to 20th matches?",2,True,hard
