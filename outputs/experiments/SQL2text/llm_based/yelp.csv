query,question,iter,flag,hardness
"SELECT T1.name, T2.category_name FROM business AS T1 JOIN category AS T2 ON T1.bid = T2.business_id JOIN review AS T3 ON T2.id = T3.business_id WHERE T3.rating > 4 ORDER BY T1.name ASC","What are the names of businesses with their respective categories, ordered by business name, for businesses that have been rated more than 4 stars in a review?",6,False,extra
SELECT review_count FROM business WHERE rating <= 3 GROUP BY review_count HAVING COUNT(bid) > 10 ORDER BY review_count DESC,"What are the review counts of businesses with ratings of 3 or less, where there are more than 10 businesses with the same review count, listed in descending order of review count?",6,False,hard
SELECT T1.name FROM business AS T1 WHERE T1.rating > 4 AND T1.review_count > ( SELECT AVG(review_count) FROM business ) AND NOT EXISTS ( SELECT 1 FROM review AS T2 WHERE T2.business_id = T1.business_id AND T2.rating < 4 ) ORDER BY T1.review_count DESC LIMIT 10,"What are the names of the top 10 businesses with more reviews than the average business, a rating of more than 4, and no reviews with a rating less than 4, ordered by review count in descending order starting from the 11th?",3,True,extra
"SELECT COUNT(DISTINCT T1.name), T2.category_name FROM business AS T1 JOIN category AS T2 ON T1.business_id = T2.business_id WHERE T2.category_name != 'Fast Food' ORDER BY T2.category_name ASC","What is the number of unique business names for each category, excluding 'Fast Food', listed in ascending order by category?",2,True,hard
"SELECT T1.name, T2.business_id FROM business AS T1 JOIN category AS T2 ON T1.bid = T2.business_id WHERE T1.review_count <= 100 ORDER BY T1.rating ASC LIMIT 10","What are the names and business ids of the 10 lowest rated businesses with 100 reviews or less, starting from the 11th business?",4,True,extra
"SELECT T1.business_id, SUM(T1.review_count) FROM business AS T1 WHERE T1.rating BETWEEN 3 AND 5 AND T1.business_id NOT IN ( SELECT T2.business_id FROM business AS T2 WHERE T2.is_open = 0 ) GROUP BY T1.business_id ORDER BY T1.business_id ASC LIMIT 10","What are the business ids and total review counts of the top 10 open businesses with a rating between 3 and 5, ordered by business id in ascending order, starting from the 11th business?",6,False,extra
SELECT T1.business_id FROM business AS T1 WHERE EXISTS ( SELECT T2.category_name FROM category AS T2 WHERE T1.business_id = T2.business_id AND T2.id < 10 ) GROUP BY T1.business_id HAVING MAX(T1.review_count) > 5 LIMIT 10,"What are the business ids of the top 10 businesses with more than 5 reviews, that have at least one category with an id less than 10, ordered by review count in descending order, starting from the 11th business?",6,False,extra
"SELECT T1.name, T2.category_name FROM business AS T1 INNER JOIN category AS T2 ON T1.business_id = T2.business_id INNER JOIN review AS T3 ON T2.business_id = T3.business_id WHERE T3.rating >= 4 ORDER BY T1.name ASC LIMIT 10","What are the names and categories of the next 10 businesses with a rating of 4 or more, listed in ascending order by name?",6,False,extra
"SELECT COUNT(DISTINCT T2.category_name), COUNT(DISTINCT T3.neighbourhood_name), COUNT(DISTINCT T1.business_id) FROM business AS T1 LEFT JOIN category AS T2 ON T1.business_id = T2.business_id LEFT JOIN neighbourhood AS T3 ON T1.business_id = T3.business_id WHERE T2.category_name = 'Food' OR T3.neighbourhood_name = 'Downtown' OR T1.business_id IN (SELECT T4.business_id FROM category AS T4 WHERE T4.category_name = 'Food')","How many distinct food categories, downtown neighborhoods, and business ids are there for businesses that are either categorized as food or located in downtown or both?",6,True,extra
SELECT name FROM business WHERE review_count > 100 ORDER BY rating DESC,"What are the names of businesses with more than 100 reviews, listed in descending order of rating?",2,True,medium
"SELECT COUNT(DISTINCT T1.business_id), COUNT(T2.category_name) FROM business AS T1 JOIN category AS T2 ON T1.business_id = T2.business_id WHERE T1.city = 'Toronto' OR T2.category_name = 'Food' OR NOT EXISTS (SELECT 1 FROM review WHERE review.business_id = T1.business_id)",How many unique businesses and total categories are there in Toronto or in the 'Food' category or have no reviews?,4,True,extra
SELECT COUNT(bid) FROM business WHERE rating != 0,How many businesses have a rating other than 0?,6,True,easy
"SELECT T1.name FROM (SELECT business_id , name FROM business) AS T1 WHERE T1.business_id = 'business_id'",What is the name of the business with the business_id 'business_id'?,2,True,easy
SELECT MIN(rating) FROM business WHERE review_count BETWEEN 10 AND 50 ORDER BY rating ASC LIMIT 10,"What are the 10 lowest ratings of businesses with review counts between 10 and 50, excluding the 10 lowest-rated ones?",6,False,hard
"SELECT T1.name AS business_name, T2.category_name FROM business AS T1 INNER JOIN category AS T2 ON T1.business_id = T2.business_id WHERE T1.rating != 0",What are the names of the businesses and their respective categories where the business rating is not zero?,2,True,medium
SELECT name FROM business WHERE review_count BETWEEN 10 AND 20 AND city = 'New York' LIMIT 10,What are the names of the next 10 businesses in New York with review counts between 10 and 20?,4,True,medium
"SELECT COUNT(DISTINCT name), AVG(rating) FROM business WHERE review_count >= 100 LIMIT 50",What are the average rating and number of distinct names of the 51st to 100th businesses with at least 100 reviews?,6,False,extra
"SELECT T1.name, T2.name FROM business AS T1 JOIN business AS T2 ON T1.bid = T2.bid WHERE T1.rating IN (SELECT rating FROM business WHERE review_count = 100)",What are the names of businesses with the same rating as businesses that have 100 reviews?,6,False,extra
"SELECT T1.rating, T2.likes FROM review AS T1 JOIN tip AS T2 ON T1.business_id = T2.business_id",What are the ratings and corresponding likes for each business that has both a review and a tip?,2,True,medium
SELECT T1.name FROM business AS T1 JOIN category AS T2 ON T1.business_id = T2.business_id JOIN review AS T3 ON T1.business_id = T3.business_id WHERE T2.category_name NOT IN (SELECT category_name FROM category AS T4 JOIN review AS T5 ON T4.business_id = T5.business_id GROUP BY T4.category_name HAVING AVG(T5.rating) > 4) ORDER BY T1.name ASC,"What are the names of businesses in categories with average ratings less than or equal to 4, listed in ascending order?",6,False,extra
SELECT COUNT(*) AS count FROM business WHERE rating = 5,How many businesses have a rating of 5?,3,True,easy
"SELECT T1.name, T2.category_name FROM business AS T1 JOIN category AS T2 ON T1.business_id = T2.business_id WHERE T1.review_count > 100 ORDER BY T1.rating ASC LIMIT 10",What are the names and categories of the next 10 lowest rated businesses with more than 100 reviews?,2,True,extra
"SELECT T1.name, T2.category_name FROM business AS T1 JOIN category AS T2 ON T1.business_id = T2.business_id WHERE T1.city = 'New York' OR T1.latitude BETWEEN 40 AND 42 OR T1.rating > (SELECT AVG(rating) FROM review)","What are the names and categories of businesses in New York or with a latitude between 40 and 42, or with a rating higher than the average rating of all reviews?",6,False,extra
SELECT T1.name FROM business AS T1 WHERE T1.review_count BETWEEN 100 AND 500 AND T1.rating > 3 AND T1.city = 'Toronto' LIMIT 10,What are the names of the next 10 businesses in Toronto with a rating above 3 and a review count between 100 and 500?,2,True,medium
SELECT category_name FROM category AS T1 WHERE business_id = 'some_business_id',What are the categories of the business with the given business id?,2,True,easy
"SELECT COUNT(DISTINCT T1.business_id), T1.name FROM business AS T1 WHERE T1.business_id NOT IN (SELECT T2.business_id FROM category AS T2)",How many unique businesses are there that are not associated with any category and what are their names?,3,True,extra
