query,question,iter,flag,hardness
SELECT city_name FROM City WHERE country <= 'USA',What are the city names in the country 'USA'?,6,False,easy
"SELECT T1.city_name, T3.LName, T3.Fname FROM City AS T1 JOIN Direct_distance AS T2 ON T1.city_code = T2.city1_code JOIN Student AS T3 ON T3.city_code = T2.city2_code WHERE T3.Age BETWEEN 20 AND 30 AND T3.Sex = 'M' AND T2.distance > 1000 ORDER BY T2.distance DESC","What are the names of cities, last names, and first names of male students aged between 20 and 30 living in cities more than 1000 units apart, listed in descending order of distance?",6,True,extra
"SELECT COUNT(DISTINCT city_code), COUNT(DISTINCT city_name), COUNT(*) FROM City WHERE city_code NOT IN (SELECT city1_code FROM Direct_distance) ORDER BY COUNT(DISTINCT city_code) DESC LIMIT 10","What are the counts of distinct city codes, distinct city names, and total cities of the top 10 cities that are not mentioned in direct distances?",6,False,extra
SELECT T2.city_name FROM Student AS T1 JOIN City AS T2 ON T1.city_code = T2.city_code JOIN Direct_distance AS T3 ON T2.city_code = T3.city1_code WHERE T1.Age BETWEEN 18 AND 25 AND T1.Sex = 'M' AND T3.distance NOT IN (SELECT distance FROM Direct_distance WHERE city1_code = 'NYC'),"What cities do male students aged 18-25 live in, excluding those cities that have a direct distance from NYC?",4,True,extra
"SELECT T1.city_code, COUNT(DISTINCT T2.city_code) FROM City AS T1 JOIN City AS T2 ON T1.city_code = T2.city_code GROUP BY T1.city_code","For each city, how many distinct cities have the same city code?",4,True,medium
"SELECT Fname, AVG(Age) FROM Student WHERE city_code >= 'A' GROUP BY Fname HAVING AVG(Age) > 20",What are the first names of students from cities with codes A onwards and what is their average age if it is greater than 20?,6,False,medium
SELECT T2.city_name FROM Student AS T1 JOIN City AS T2 ON T1.city_code = T2.city_code WHERE T1.Age > 20 ORDER BY T2.latitude DESC,"What are the city names where students older than 20 live, ordered from highest to lowest latitude?",2,True,hard
SELECT T1.city_name FROM City AS T1 JOIN Direct_distance AS T2 ON T1.city_code = T2.city1_code JOIN Student AS T3 ON T3.city_code = T2.city2_code WHERE T3.Age <= 20,"What are the city names where students aged 20 or younger are from, connected to another city through direct distance?",6,True,hard
"SELECT T1.LName, T1.Fname FROM Student AS T1 JOIN Student AS T2 ON T1.city_code = T2.city_code WHERE T1.city_code IN (SELECT city_code FROM City WHERE country = 'USA')",What are the full names of the students who live in the same city as other students and are from the USA?,6,False,extra
SELECT DISTINCT T2.city_name FROM Student AS T1 JOIN City AS T2 ON T1.city_code = T2.city_code WHERE T1.Age > 20 OR T1.Major = 1 OR EXISTS (SELECT 1 FROM City WHERE city_code = 'ABC123') ORDER BY T2.city_name DESC,"What distinct city names are there for students who are older than 20, major in 1, or from any city, listed in descending order?",6,False,extra
"SELECT city_code, COUNT(DISTINCT city_name) FROM City WHERE city_code NOT IN ( SELECT T2.city1_code FROM City AS T1 JOIN Direct_distance AS T2 ON T1.city_code = T2.city1_code ) GROUP BY city_code HAVING COUNT(city_name) > 1 LIMIT 5","What are the next 5 city codes with more than one city name that are not connected to any other city by a direct distance, along with the count of distinct city names for each code?",4,True,extra
"SELECT T1.city_name, SUM(T2.distance) FROM City AS T1 JOIN Direct_distance AS T2 ON T1.city_code = T2.city1_code WHERE T2.city2_code = 'NYC' AND T2.distance > (SELECT AVG(distance) FROM Direct_distance) GROUP BY T1.city_name ORDER BY T1.city_name ASC","What are the city names and their total distances to New York City, where the distance is above average, listed in ascending order by city name?",6,False,extra
SELECT T1.city_name FROM City AS T1 JOIN Direct_distance AS T2 ON T1.city_code = T2.city1_code WHERE T2.distance <= 500,What are the names of cities that are within a 500 unit distance from at least one other city?,6,False,medium
"SELECT city_name AS city_name_new, MAX(distance) FROM City AS T1 JOIN Direct_distance AS T2 ON T1.city_code = T2.city2_code GROUP BY city_name",What is the city name and the maximum distance from each city?,6,False,medium
SELECT T1.city_name FROM City AS T1 JOIN Direct_distance AS T2 ON T1.city_code = T2.city1_code WHERE T2.city2_code != 'ABC' ORDER BY T2.distance DESC,"What are the city names, excluding the city with code 'ABC', listed in descending order of distance?",2,True,hard
"SELECT T1.Fname, T2.city_name FROM Student AS T1 JOIN City AS T2 ON T1.city_code = T2.city_code JOIN Direct_distance AS T3 ON T2.city_code = T3.city1_code WHERE T1.Age BETWEEN 20 AND 30 AND T1.Sex = 'M' AND NOT EXISTS (SELECT * FROM City AS T4 WHERE T4.city_code = T3.city2_code AND T4.country = 'USA')","What are the first names of male students aged 20 to 30, along with their city of residence, such that their city does not have a direct distance to any US city?",4,True,extra
SELECT city_name FROM City WHERE city_code >= 'A' LIMIT 10,"What are the next 10 city names, alphabetically, after the first 10 cities whose names start with the letter 'A'?",6,False,medium
"SELECT MIN(T1.Age), T1.Major FROM Student AS T1 JOIN City AS T2 ON T1.city_code = T2.city_code WHERE T1.Sex != 'F' GROUP BY T1.Major LIMIT 10",What are the youngest male students' ages in each major (excluding the first 10 results)?,6,False,extra
"SELECT T1.city_name, COUNT(T2.StuID) FROM City AS T1 JOIN Student AS T2 ON T1.city_code = T2.city_code WHERE T2.Age BETWEEN 18 AND 22 AND T1.country = 'USA' GROUP BY T1.city_name","In the USA, what are the city names and their respective number of students aged between 18 and 22?",4,True,hard
"SELECT Student.LName, Student.Fname, Direct_distance.distance FROM Student INNER JOIN Direct_distance ON Student.city_code = Direct_distance.city1_code WHERE Student.Age BETWEEN 20 AND 30 AND Direct_distance.distance < 1000 ORDER BY Direct_distance.distance DESC","What are the names of students between the ages of 20 and 30, along with the distances between their cities, listed in descending order of distance, but only considering distances less than 1000 units?",6,False,hard
"SELECT T1.Fname, T2.city_name, T3.distance FROM Student AS T1 JOIN City AS T2 ON T1.city_code = T2.city_code JOIN Direct_distance AS T3 ON T2.city_code = T3.city1_code WHERE T1.Age BETWEEN 20 AND 30 OR T1.Major = (SELECT Major FROM Student WHERE Advisor = 1) OR T1.Sex = 'M'","What are the first names of male students or students aged 20 to 30 or students with the same major as the students advised by advisor 1, along with the city names and direct distances of their respective cities?",3,True,extra
SELECT T1.LName FROM Student AS T1 JOIN City AS T2 ON T1.city_code = T2.city_code JOIN Direct_distance AS T3 ON T2.city_code = T3.city1_code WHERE T3.distance < 100 AND (SELECT COUNT(*) FROM City WHERE city_code = T1.city_code) > 1 ORDER BY T1.LName ASC LIMIT 10,"What are the last names of the 11th to 20th students from cities with at least two students and within a 100-mile radius of another city, listed alphabetically?",2,True,extra
SELECT COUNT(DISTINCT T1.city_code) FROM City AS T1 JOIN Direct_distance AS T2 ON T1.city_code = T2.city1_code WHERE T2.distance > 100 OR T2.distance BETWEEN 50 AND 100 OR T2.distance > (SELECT AVG(distance) FROM Direct_distance),"How many unique cities have a distance greater than 100, between 50 and 100, or greater than the average distance to other cities?",6,False,extra
