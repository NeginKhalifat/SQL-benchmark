query,question,iter,flag,hardness
"SELECT COUNT(T1.staff_id), T2.product_name FROM Staff AS T1 JOIN Complaints AS T3 ON T1.staff_id = T3.staff_id JOIN Products AS T2 ON T3.product_id = T2.product_id WHERE T2.product_price BETWEEN 10 AND 20 ORDER BY T1.staff_id DESC","How many staff members handled complaints for each product priced between 10 and 20, listed in descending order by staff id?",6,False,extra
SELECT T1.first_name FROM Staff AS T1 WHERE T1.staff_id = ( SELECT T2.staff_id FROM Complaints AS T2 WHERE T2.complaint_type_code = 'product' ) AND T1.gender = 'male' ORDER BY T1.staff_id ASC,"What are the first names of male staff members who handled product complaints, listed in ascending order of staff ID?",6,False,extra
"SELECT T1.first_name, T1.last_name FROM Staff AS T1 WHERE T1.gender = 'Male' OR T1.email_address IN (SELECT T2.email_address FROM Customers AS T2) AND T1.staff_id BETWEEN 100 AND 200","What are the names of male staff members or staff members with email addresses that are also found in the customers list, with staff IDs between 100 and 200?",5,True,extra
"SELECT COUNT(DISTINCT T1.staff_id), COUNT(T2.staff_id) FROM Staff AS T1 JOIN Complaints AS T2 ON T1.staff_id = T2.staff_id WHERE T2.date_complaint_raised < '2020-01-01'",How many unique staff members and total staff complaints were there before 2020?,4,True,extra
"SELECT T1.staff_id, MIN(T2.date_complaint_raised) FROM Staff AS T1 JOIN Complaints AS T2 ON T1.staff_id = T2.staff_id GROUP BY T1.staff_id HAVING T1.staff_id = 12345 OR T2.date_complaint_closed BETWEEN '2020-01-01' AND '2020-12-31' OR T1.gender = 'M'","What is the earliest date a complaint was raised by staff with a staff id of 12345 or staff of male gender or staff who handled complaints closed between January 1, 2020, and December 31, 2020?",6,False,extra
SELECT T1.product_name FROM Products AS T1 JOIN Complaints AS T2 ON T1.product_id = T2.product_id WHERE T2.date_complaint_raised >= '2020-01-01' LIMIT 5,"What are the names of the next 5 products that received complaints on or after January 1st, 2020?",3,True,hard
"SELECT COUNT(T1.staff_id), T2.customer_type_code FROM Staff AS T1 JOIN Complaints AS T3 ON T1.staff_id = T3.staff_id JOIN Customers AS T2 ON T3.customer_id = T2.customer_id WHERE T2.state = 'California' AND NOT EXISTS ( SELECT 1 FROM Products AS T4 WHERE T4.product_price < 100 ) LIMIT 10","What is the count of staff and customer type code for customers in California, considering all products have a price of at least 100, limited to 10 results offset by 10?",6,False,extra
SELECT COUNT(product_id) FROM Products WHERE product_price < 100 ORDER BY product_id ASC,"How many products cost less than $100, listed in ascending order by product ID?",4,True,medium
"SELECT COUNT(DISTINCT T1.customer_id), COUNT(DISTINCT T2.staff_id) FROM Customers AS T1 JOIN Complaints AS T2 ON T1.customer_id = T2.customer_id WHERE T2.complaint_outcome_code >= 'Closed'",How many distinct customers and staff members are associated with complaints that have been closed?,6,False,extra
SELECT T1.staff_id FROM Staff AS T1 JOIN Complaints AS T2 ON T1.staff_id = T2.staff_id WHERE T2.complaint_id BETWEEN 100 AND 200 OR T2.product_id IN (SELECT product_id FROM Products WHERE product_price > 100) OR T1.gender = 'Male',"What are the staff ids of staff members who are male or have handled complaints with ids between 100 and 200, or have handled complaints related to products with prices greater than 100?",2,True,extra
"SELECT T1.staff_id, COUNT(DISTINCT T2.staff_id) FROM Complaints AS T1 JOIN Complaints AS T2 ON T1.staff_id = T2.staff_id GROUP BY T1.staff_id HAVING COUNT(T2.staff_id) > 1 LIMIT 10","What are the staff ids and their respective number of complaints, for staff members who have received more than one complaint, starting from the eleventh staff member?",6,False,hard
SELECT T1.email_address FROM Customers AS T1 WHERE T1.customer_type_code = 'INDIVIDUAL' AND T1.town_city = 'New York' AND T1.customer_id NOT IN (SELECT T2.customer_id FROM Complaints AS T2),What are the email addresses of individual customers from New York who have not raised any complaints?,6,False,extra
"SELECT AVG(T1.product_price), COUNT(*) FROM Products AS T1 GROUP BY T1.product_name HAVING AVG(T1.product_price) != 0 ORDER BY AVG(T1.product_price) DESC LIMIT 10","What are the product names with their average prices, excluding products with an average price of zero, listed in descending order of average price, from the 11th to the 20th product?",6,False,hard
SELECT product_id FROM Products WHERE product_price BETWEEN 10 AND 20,What are the product ids of products with a price between $10 and $20?,2,True,easy
"SELECT T1.product_name, T2.staff_id FROM Products AS T1 JOIN Complaints AS T2 ON T1.product_id = T2.product_id JOIN Customers AS T3 ON T2.customer_id = T3.customer_id WHERE T3.state <= 'California'",What are the names of the products and the IDs of the staff members who handled complaints from customers in states up to California?,6,False,hard
SELECT product_id FROM Products WHERE product_price >= 100 LIMIT 10,What are the product ids of the 11th to 20th most expensive products?,6,False,medium
SELECT first_name FROM Staff WHERE EXISTS (SELECT 1 FROM Complaints WHERE Complaints.staff_id = Staff.staff_id AND Complaints.customer_id = 100 AND Complaints.product_id BETWEEN 100 AND 200),What are the first names of staff members who handled complaints from customer 100 regarding products with IDs between 100 and 200?,2,True,hard
"SELECT COUNT(DISTINCT staff_id), COUNT(DISTINCT gender), COUNT(DISTINCT first_name) FROM Staff WHERE staff_id = 1","What are the counts of distinct staff id, gender, and first name for staff with id 1?",3,True,medium
SELECT COUNT(staff_id) FROM Staff WHERE gender != 'M' ORDER BY staff_id DESC LIMIT 1,"What is the number of female staff members, excluding the one with the highest staff id?",3,True,hard
SELECT T1.staff_id FROM Staff T1 JOIN Complaints T2 ON T1.staff_id = T2.staff_id JOIN Products T3 ON T2.product_id = T3.product_id JOIN Customers T4 ON T2.customer_id = T4.customer_id WHERE T2.product_id NOT IN ( SELECT product_id FROM Complaints WHERE product_id = 100) ORDER BY T1.staff_id ASC,"What are the staff ids of staff who handled complaints, excluding those who handled a complaint with product id 100, listed in ascending order?",3,True,extra
