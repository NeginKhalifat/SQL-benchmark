query,question,iter,flag,hardness
SELECT COUNT(DISTINCT T1.Code) FROM Manufacturers AS T1 JOIN Products AS T2 ON T1.Code = T2.Manufacturer JOIN Products AS T3 ON T2.Manufacturer = T3.Manufacturer WHERE T2.Price = 100 ORDER BY T1.Code ASC,How many distinct manufacturers have products that are priced at 100 dollars and have at least one other product?,6,False,extra
SELECT * FROM Manufacturers WHERE Revenue BETWEEN 100 AND 1000 AND Code > 10,What are the details of manufacturers with revenue between 100 and 1000 and code greater than 10?,2,True,medium
"SELECT Name, AVG(Revenue) FROM Manufacturers WHERE Name = 'Toyota' GROUP BY Name HAVING AVG(Revenue) > 1000 ORDER BY Name ASC LIMIT 5","What is the average revenue of Toyota manufacturers, listed in ascending order, starting from the 6th result?",6,False,extra
"SELECT T1.Headquarter, AVG(T2.Price) FROM Manufacturers AS T1 JOIN Products AS T2 ON T1.Code = T2.Manufacturer WHERE T1.Revenue > 10000 AND T2.Price BETWEEN 10 AND 50 AND T1.Headquarter = 'New York' GROUP BY T1.Headquarter HAVING AVG(T2.Price) > 20",What are the headquarters in New York of manufacturers with revenue greater than 10000 and average product prices between 10 and 50 that are greater than 20?,6,False,hard
SELECT COUNT(Code) FROM Manufacturers WHERE Revenue != 0 ORDER BY Code DESC,"How many manufacturers have a non-zero revenue, listed in descending order by code?",2,True,medium
SELECT Code FROM Manufacturers WHERE EXISTS (SELECT 1 FROM Products WHERE Manufacturer = Manufacturers.Code AND Price BETWEEN 50 AND 100) AND Revenue > 10000 AND Name = 'ABC',What is the code of manufacturer named 'ABC' with revenue over 10000 that has at least one product priced between 50 and 100?,2,True,extra
"SELECT T1.Name, T2.Price FROM Manufacturers AS T1 JOIN Products AS T2 ON T1.Code = T2.Manufacturer JOIN Manufacturers AS T3 ON T2.Manufacturer = T3.Code WHERE T1.Headquarter = 'USA' ORDER BY T1.Name ASC",What are the names of the manufacturers based in the USA and their product prices listed in ascending order by manufacturer name?,2,True,extra
"SELECT Name, COUNT(Code) FROM Manufacturers WHERE Revenue = 100000 GROUP BY Name LIMIT 5","What are the names of the top 5 manufacturers with revenue of 100,000 and how many codes do they have?",6,False,hard
SELECT AVG(Revenue) FROM Manufacturers WHERE Revenue > 1000 AND Revenue BETWEEN 10000 AND 100000,"What is the average revenue of manufacturers with revenues between 10,000 and 100,000 and also greater than 1,000?",2,True,medium
SELECT MAX(Revenue) FROM Manufacturers WHERE Founder = 'Elon Musk' ORDER BY Revenue DESC,What is the highest revenue of the manufacturers founded by Elon Musk?,2,True,medium
"SELECT T1.Name, T2.Price FROM Manufacturers AS T1 JOIN Products AS T2 ON T1.Code = T2.Manufacturer WHERE T1.Revenue > 10000 AND T1.Code = 1 AND EXISTS (SELECT 1 FROM Products AS T3 WHERE T3.Manufacturer = T1.Code AND T3.Price > 50) GROUP BY T1.Name HAVING AVG(T2.Price) > 50 ORDER BY T1.Name DESC","What are the names of manufacturers with revenue over 10000 and code 1, who have products with prices over 50, and where the average product price is over 50, listed in descending order by name?",6,False,extra
"SELECT Name, COUNT(Code) FROM Manufacturers GROUP BY Name HAVING COUNT(Code) > 1 ORDER BY COUNT(Code) DESC","What manufacturers have more than one product and how many products do they have, listed in descending order by the number of products?",6,False,medium
"SELECT T1.Name, T2.Name, SUM(T3.Price) FROM Manufacturers AS T1 JOIN Products AS T2 ON T1.Code = T2.Manufacturer JOIN Products AS T3 ON T2.Manufacturer = T3.Manufacturer WHERE T1.Revenue <= 10000 ORDER BY T1.Name DESC","What are the names of manufacturers with a revenue of 10000 or less, along with the names of products they manufacture and the total price of these products, listed in descending order by manufacturer name?",6,False,extra
SELECT T1.Name FROM Manufacturers AS T1 JOIN Products AS T2 ON T1.Code = T2.Manufacturer WHERE T2.Price > 100 AND T1.Revenue BETWEEN 1000 AND 10000 AND T1.Headquarter = 'USA' ORDER BY T1.Name DESC,"What are the names of manufacturers based in the USA with revenue between 1000 and 10000, who produce products costing more than 100, listed in descending order by name?",2,True,hard
"SELECT MAX(Revenue), MIN(Revenue), AVG(Revenue) FROM Manufacturers WHERE Revenue BETWEEN 10000 AND 50000","What are the maximum, minimum, and average revenues of manufacturers with revenues between 10,000 and 50,000?",2,True,medium
SELECT T1.Name FROM Manufacturers AS T1 JOIN Products AS T2 ON T1.Code = T2.Manufacturer WHERE T2.Price > 50 AND T1.Revenue > 10000 AND T1.Headquarter NOT IN (SELECT DISTINCT Headquarter FROM Manufacturers WHERE Founder = 'Founder1'),"What are the names of manufacturers with a revenue over 10000, whose products cost more than 50 and are not founded by Founder1?",6,False,extra
"SELECT T1.Name, T2.Name FROM Manufacturers AS T1 JOIN Products AS T2 ON T1.Code = T2.Manufacturer WHERE T1.Revenue BETWEEN 1000 AND 10000",What are the names of manufacturers with revenues between 1000 and 10000 and the names of their corresponding products?,2,True,medium
SELECT Name FROM Manufacturers WHERE Revenue > (SELECT MAX(Revenue) FROM Manufacturers) OR Code BETWEEN 1 AND 10 OR Code = (SELECT MAX(Code) FROM Products) GROUP BY Name HAVING MAX(Revenue) > 10000 ORDER BY Name DESC,"What are the names of the manufacturers with a maximum revenue of more than 10000, either having a revenue higher than the maximum revenue, a code between 1 and 10, or the highest code among all products, listed in descending order by name?",6,False,extra
"SELECT M1.Name, COUNT(DISTINCT P2.Code), P3.Name FROM Manufacturers M1 JOIN Products P1 ON M1.Code = P1.Manufacturer JOIN Products P2 ON M1.Code = P2.Manufacturer JOIN Products P3 ON M1.Code = P3.Manufacturer WHERE EXISTS (SELECT 1 FROM Products P4 WHERE P4.Manufacturer = M1.Code AND P4.Price > 50) ORDER BY M1.Revenue DESC LIMIT 10","What are the names of the top 10 manufacturers with the highest revenue that have at least one product priced over 50 dollars, along with the number of distinct products they manufacture?",6,False,extra
"SELECT T2.Name, COUNT(DISTINCT T2.Code), AVG(T1.Revenue) FROM Manufacturers AS T1 JOIN Products AS T2 ON T1.Code = T2.Manufacturer WHERE T1.Revenue BETWEEN 1000 AND 100000 AND NOT EXISTS (SELECT 1 FROM Products WHERE Price > 1000) ORDER BY T2.Name ASC","What are the names of manufacturers with at least one product priced $1000 or less, along with the count of their distinct product codes and their average revenue, for manufacturers with revenues between $1000 and $100,000, sorted by manufacturer name?",6,False,extra
"SELECT T2.Name, T1.Headquarter FROM Manufacturers AS T1 JOIN Products AS T2 ON T1.Code = T2.Manufacturer WHERE T1.Revenue > 10000 AND T2.Name IN (SELECT Name FROM Products WHERE Price > 500) ORDER BY T2.Name DESC","What are the names and headquarters of manufacturers with revenue over 10,000, whose products cost more than 500, listed in descending order by product name?",6,False,extra
SELECT COUNT(Code) FROM Manufacturers WHERE Revenue BETWEEN 1000 AND 10000 AND Code NOT IN (SELECT Manufacturer FROM Products) GROUP BY Code ORDER BY Code DESC LIMIT 5,"What are the next five manufacturers with a revenue between 1000 and 10000, in descending order, that do not make any products?",6,False,extra
"SELECT T1.Revenue, COUNT(T2.Code) FROM Manufacturers AS T1 JOIN Products AS T2 ON T1.Code = T2.Manufacturer GROUP BY T1.Revenue ORDER BY T1.Revenue DESC LIMIT 5",What are the revenues of the 6th to 10th highest-revenue manufacturers along with the number of products they manufacture?,2,True,extra
"SELECT T1.Code, COUNT(T1.Code) FROM Manufacturers AS T1 WHERE T1.Code NOT IN ( SELECT T2.Manufacturer FROM Products AS T2 ) AND T1.Revenue BETWEEN 10000 AND 50000","What are the codes of manufacturers who do not produce any products and have revenue between 10000 and 50000, and how many manufacturers are in this category?",4,True,extra
"SELECT T1.Name, T1.Revenue FROM Manufacturers AS T1 JOIN Manufacturers AS T2 ON T1.Code = T2.Code WHERE T1.Revenue BETWEEN 1000 AND 100000 OR T2.Headquarter = 'USA' GROUP BY T1.Name HAVING COUNT(T1.Code) > 1",What are the names and revenues of manufacturers with duplicate codes and either revenue between 1000 and 100000 or headquarter in the USA?,3,True,extra
"SELECT Code, Name FROM Manufacturers WHERE Revenue BETWEEN 1000 AND 100000 OR Code NOT IN (SELECT Manufacturer FROM Products WHERE Price > 500)","What are the codes and names of manufacturers with revenue between 1000 and 100000, or those that do not produce any products with a price greater than 500?",2,True,extra
