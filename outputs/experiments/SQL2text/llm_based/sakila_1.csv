query,question,iter,flag,hardness
"SELECT AVG(T1.length), AVG(T2.length) FROM film AS T1 JOIN film AS T2 ON T1.film_id = T2.film_id WHERE T1.length > 50 GROUP BY T1.film_id ORDER BY T1.length DESC","What are the average lengths of films paired with themselves where their length is more than 50, grouped and ordered by their lengths in descending order?",6,False,extra
"SELECT T1.first_name, T1.last_name FROM actor AS T1 WHERE T1.first_name = 'John' AND T1.last_name = 'Doe' AND NOT EXISTS (SELECT 1 FROM film_actor AS T2 WHERE T2.actor_id = T1.actor_id AND T2.film_id = 1) ORDER BY T1.first_name DESC","What are the names of actors who are not cast in film with id 1, sorted in descending order by first name?",5,True,extra
SELECT COUNT(DISTINCT T1.title) FROM film AS T1 JOIN inventory AS T2 ON T1.film_id = T2.film_id JOIN rental AS T3 ON T2.inventory_id = T3.inventory_id WHERE T3.return_date != '2006-01-01',How many unique film titles are there where the return date is not '2006-01-01'?,3,True,hard
SELECT COUNT(DISTINCT T1.first_name) FROM actor AS T1 WHERE T1.actor_id IN (SELECT T2.actor_id FROM film_actor AS T2 WHERE T2.film_id = 1) AND T1.last_name = 'GUINESS' ORDER BY T1.first_name ASC,How many distinct first names are there for actors with the last name 'GUINESS' who have acted in film 1?,2,True,extra
SELECT T1.first_name FROM staff AS T1 JOIN address AS T2 ON T1.address_id = T2.address_id WHERE T1.first_name != 'John',What are the first names of all staff members excluding John who have an address in the address table?,2,True,medium
"SELECT a.first_name, COUNT(*) FROM actor AS a JOIN film_actor AS fa ON a.actor_id = fa.actor_id WHERE a.actor_id NOT IN (SELECT actor_id FROM film_actor WHERE film_id = 1) GROUP BY a.first_name ORDER BY COUNT(*) DESC","What are the first names of actors who are not in film 1, ranked by the number of films they are in in descending order?",6,False,extra
"SELECT COUNT(DISTINCT T1.customer_id), COUNT(T2.rental_id) FROM customer AS T1 JOIN rental AS T2 ON T1.customer_id = T2.customer_id WHERE T1.store_id != 1",What is the number of unique customers and total number of rentals from stores other than store 1?,6,False,extra
SELECT COUNT(T1.film_id) FROM film AS T1 JOIN inventory AS T2 ON T1.film_id = T2.film_id WHERE T2.store_id = 1 LIMIT 1,"How many unique films are available in the inventory at store 1, excluding the first result?",6,False,hard
"SELECT COUNT(DISTINCT T1.store_id), COUNT(T2.inventory_id) FROM store AS T1 JOIN inventory AS T2 ON T1.store_id = T2.store_id",What are the number of unique store ids and the total number of inventory ids in the stores that have inventory?,2,True,medium
"SELECT film_id, SUM(length) FROM film WHERE film_id IN ( SELECT film_id FROM inventory WHERE store_id = 1 ) GROUP BY film_id HAVING SUM(length) > 100","What are the film IDs and their total lengths for films available in store 1, where the total length is more than 100?",5,True,extra
"SELECT T1.first_name, COUNT(T2.film_id) FROM actor AS T1 JOIN film_actor AS T2 ON T1.actor_id = T2.actor_id GROUP BY T1.first_name",What is the first name of each actor and the number of films they acted in?,6,True,medium
"SELECT T1.first_name, T2.customer_id FROM staff AS T1  JOIN rental AS T2  ON T1.staff_id = T2.staff_id  JOIN inventory AS T3  ON T2.inventory_id = T3.inventory_id  WHERE T3.film_id BETWEEN 1 AND 100 AND NOT EXISTS ( SELECT 1 FROM film WHERE film_id = T3.film_id AND rating = 'R' ) ORDER BY T2.rental_date DESC","What are the first names of the staff and the customer ids for the rentals of films with ids between 1 and 100 that are not rated 'R', listed in descending order of rental date?",6,False,extra
"SELECT COUNT(film_id), SUM(rental_duration) FROM film WHERE rental_duration < ( SELECT AVG(rental_duration) FROM film )",What is the count of films and the total rental duration of all the films with a rental duration less than the average rental duration of all films?,2,True,extra
"SELECT T1.first_name, T2.first_name FROM actor AS T1 JOIN actor AS T2 ON T1.actor_id = T2.actor_id WHERE T1.actor_id < 10 ORDER BY T1.first_name DESC",What are the first names of actors with identical ids less than 10 listed in descending order by first name?,6,False,hard
"SELECT T1.first_name, T2.first_name FROM staff AS T1 JOIN staff AS T2 ON T1.staff_id < T2.staff_id LIMIT 5","What are the first names of pairs of staff members where the first staff member's id is less than the second staff member's id, starting from the 6th pair?",3,True,medium
"SELECT T1.first_name, T1.last_name FROM actor AS T1 WHERE T1.actor_id NOT IN (SELECT T2.actor_id FROM film_actor AS T2 WHERE T2.film_id = 1) LIMIT 5","What are the first and last names of the next 5 actors, starting from the 6th, who did not act in film number 1?",2,True,extra
"SELECT T1.first_name, T1.last_name FROM actor AS T1 WHERE EXISTS (SELECT 1 FROM film_actor AS T2 WHERE T2.actor_id = T1.actor_id LIMIT 10)",What are the names of actors who have participated in at least one film?,6,False,extra
SELECT COUNT(film_id) FROM film,How many films are in the database?,2,True,easy
SELECT T1.title FROM film AS T1 WHERE EXISTS (SELECT T2.film_id FROM inventory AS T2 WHERE T2.film_id = T1.film_id) ORDER BY T1.length DESC,"What are the titles of films that have copies in the inventory, listed in order of longest to shortest length?",2,True,extra
SELECT * FROM film WHERE film_id = 1 AND release_year BETWEEN 2000 AND 2010 AND EXISTS (SELECT * FROM inventory WHERE film_id = film.film_id),"What are the details of the film with id 1, released between 2000 and 2010, and is available in the inventory?",2,True,extra
"SELECT T1.first_name, COUNT(T2.film_id) FROM actor AS T1 JOIN film_actor AS T2 ON T1.actor_id = T2.actor_id JOIN film AS T3 ON T2.film_id = T3.film_id GROUP BY T1.first_name",What is the first name of each actor and how many films have they acted in?,6,False,hard
"SELECT COUNT(DISTINCT T1.language_id), T2.name FROM film AS T1 JOIN language AS T2 ON T1.language_id = T2.language_id WHERE T1.release_year BETWEEN 2000 AND 2010 ORDER BY T2.name DESC LIMIT 10","What are the names of the top 10 languages of films released between 2000 and 2010, ordered by language name in descending order, along with the count of distinct languages?",6,False,extra
"SELECT T1.first_name, T2.staff_id FROM staff AS T1 JOIN rental AS T2 ON T1.staff_id = T2.staff_id JOIN payment AS T3 ON T2.rental_id = T3.rental_id WHERE T3.amount < 2 ORDER BY T1.first_name ASC","What are the names of staff members who handled rentals with payments less than 2 dollars, listed in ascending order by first name?",6,False,extra
