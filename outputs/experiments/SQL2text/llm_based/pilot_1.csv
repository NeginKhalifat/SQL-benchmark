query,question,iter,flag,hardness
"SELECT COUNT(DISTINCT T2.pilot_name), T1.location FROM Hangar AS T1 JOIN PilotSkills AS T2 ON T1.plane_name = T2.plane_name WHERE T2.age < 30 GROUP BY T1.location ORDER BY COUNT(DISTINCT T2.pilot_name) DESC","For each location, how many unique pilots under the age of 30 are there, listed in descending order by the number of unique pilots?",6,True,extra
SELECT COUNT(DISTINCT T1.plane_name) FROM PilotSkills AS T1 GROUP BY T1.age HAVING COUNT(T1.plane_name) > 1 AND T1.age != 50,How many ages are there where a pilot of that age can operate more than one unique plane and is not 50 years old?,6,False,medium
"SELECT COUNT(DISTINCT T1.plane_name), COUNT(T3.location) FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name JOIN Hangar AS T3 ON T1.plane_name = T3.plane_name WHERE T1.age > 30 OR T2.location IN (SELECT location FROM Hangar WHERE location = 'New York')",How many unique planes can pilots over 30 fly and how many hangar locations in total are there for these planes or the planes located in New York?,2,True,extra
SELECT COUNT(plane_name) FROM PilotSkills WHERE age <= 30,How many planes can pilots aged 30 or younger fly?,6,True,easy
"SELECT SUM(T1.age), T2.location, COUNT(T1.plane_name) FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name WHERE T1.age >= 40 LIMIT 10","What is the sum of ages, location, and count of pilots for pilots over 40 years old, grouped by location, and what are the 10 records after the first 10 records?",6,False,hard
"SELECT T1.plane_name, MIN(T1.age) FROM PilotSkills AS T1 WHERE T1.pilot_name = 'John' AND EXISTS (SELECT 1 FROM Hangar AS T2 WHERE T1.plane_name = T2.plane_name AND T2.location = 'New York') GROUP BY T1.plane_name",What is the minimum age for pilot John to fly each plane that is currently located in New York?,5,True,extra
"SELECT COUNT(DISTINCT T1.pilot_name), T2.location FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name WHERE T1.age = 50 LIMIT 10","What are the locations and the number of unique pilots aged 50 who fly each plane, listed from the 11th to the 20th result?",6,False,hard
"SELECT T1.plane_name, T1.age, T2.location FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name WHERE T1.age >= 30 ORDER BY T1.age DESC","What are the names and ages of pilots older than or equal to 30, along with their plane's location, listed from oldest to youngest?",6,False,hard
SELECT pilot_name FROM PilotSkills WHERE age > 30 GROUP BY age,"What are the names of pilots who are older than 30, grouped by their age?",3,True,medium
"SELECT T1.plane_name, SUM(T1.age) FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name GROUP BY T1.plane_name HAVING SUM(T1.age) > 50",What planes have a total pilot age greater than 50?,3,True,medium
SELECT T1.pilot_name FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name WHERE T1.age > (SELECT AVG(age) FROM PilotSkills),What are the names of pilots older than the average age of pilots?,3,True,extra
"SELECT T1.pilot_name, COUNT(DISTINCT T2.location) FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name WHERE T1.age > 40 OR T1.plane_name NOT IN (SELECT plane_name FROM Hangar WHERE location = 'New York') ORDER BY T1.pilot_name DESC LIMIT 10","What are the names of the 11th to 20th oldest pilots older than 40 and the number of different locations of their planes excluding New York, listed in descending order of pilot name?",5,True,extra
"SELECT T1.pilot_name, T2.location, SUM(T1.age) FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name WHERE T1.age BETWEEN 30 AND 40 AND T1.pilot_name = 'John' GROUP BY T2.location HAVING SUM(T1.age) > 100","What are the locations of hangars where the total age of pilots named 'John', aged between 30 and 40, exceeds 100?",6,False,hard
SELECT COUNT(DISTINCT T1.plane_name) FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name WHERE T2.location < 'New York' ORDER BY T1.age DESC,"How many distinct planes are located in a city alphabetically before New York, listed in descending order of pilot age?",2,True,hard
SELECT T1.pilot_name FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name WHERE T1.age > 30 OR T2.location = 'New York' ORDER BY T1.age DESC,"What are the names of pilots older than 30 years or flying planes located in New York, listed in descending order of age?",3,True,extra
"SELECT T1.pilot_name, T2.pilot_name FROM PilotSkills AS T1 JOIN PilotSkills AS T2 ON T1.plane_name = T2.plane_name WHERE T1.age > 50 AND T1.pilot_name = 'John'","What are the names of pilots, including John, who fly the same plane as John and are older than 50?",6,False,extra
"SELECT T1.pilot_name, T2.location FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name ORDER BY T1.age ASC","What are the names and locations of the planes flown by each pilot, sorted by the pilot's age from youngest to oldest?",2,True,medium
"SELECT T1.age, AVG(T1.age) FROM (SELECT T2.age, T2.plane_name FROM PilotSkills AS T2 WHERE T2.plane_name IN (SELECT plane_name FROM Hangar)) AS T1 GROUP BY T1.age","What is the average age of pilots for each age, where the pilots can fly planes that are in the hangar?",6,False,medium
"SELECT T1.pilot_name, AVG(T1.age) FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name WHERE T1.age <= 40 GROUP BY T1.pilot_name LIMIT 5","What are the names of pilots along with their average age, for pilots aged 40 or younger, for the 6th to 10th results?",6,True,extra
"SELECT T1.pilot_name, T1.plane_name FROM PilotSkills AS T1 JOIN PilotSkills AS T2 ON T1.plane_name = T2.plane_name WHERE T1.age BETWEEN 30 AND 40 OR T1.age > 50 OR EXISTS (SELECT * FROM Hangar WHERE location = 'New York' AND plane_name = T1.plane_name) ORDER BY T1.pilot_name ASC","What are the names of pilots and the planes they fly, where the pilot is between 30 and 40 years old or over 50, or the plane is located in New York, listed in ascending order by pilot name?",6,False,extra
"SELECT COUNT(DISTINCT T1.plane_name), COUNT(T1.age) FROM PilotSkills AS T1 JOIN Hangar AS T2 ON T1.plane_name = T2.plane_name WHERE T2.location = 'New York' AND T1.age > 30 ORDER BY T1.age ASC LIMIT 10","What are the number of unique planes and the total number of pilots over 30 years old in New York, listed from the 11th to the 20th youngest pilot?",6,False,extra
