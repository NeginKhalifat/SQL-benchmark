query,question,iter,flag,hardness
SELECT SUM(T1.cmi_details) FROM Customer_Master_Index AS T1 WHERE T1.master_customer_id > 1000 GROUP BY T1.master_customer_id LIMIT 10,"What are the sums of cmi details for master customer ids greater than 1000, grouped by master customer id and sorted in ascending order, for the 11th to 20th results?",3,True,hard
"SELECT COUNT(DISTINCT T2.master_customer_id) AS count_distinct_master_customer_id, SUM(T1.council_tax_id) AS sum_council_tax_id FROM Council_Tax AS T1 JOIN CMI_Cross_References AS T2 ON T1.cmi_cross_ref_id = T2.cmi_cross_ref_id WHERE T1.council_tax_id != 0 GROUP BY T2.master_customer_id ORDER BY T2.master_customer_id DESC","What are the counts of distinct master customer IDs and sums of council tax IDs for each master customer ID, ordered in descending master customer ID order, excluding zero council tax IDs?",3,True,extra
SELECT T1.master_customer_id FROM Customer_Master_Index AS T1 JOIN CMI_Cross_References AS T2 ON T1.master_customer_id = T2.master_customer_id JOIN Council_Tax AS T3 ON T2.cmi_cross_ref_id = T3.cmi_cross_ref_id WHERE NOT EXISTS (SELECT T4.council_tax_id FROM Benefits_Overpayments AS T4 JOIN CMI_Cross_References AS T5 ON T4.cmi_cross_ref_id = T5.cmi_cross_ref_id WHERE T5.master_customer_id = T1.master_customer_id) ORDER BY T1.master_customer_id DESC,"What are the master customer IDs of customers with no benefits overpayments, ordered by master customer ID in descending order?",2,True,extra
"SELECT COUNT(DISTINCT T1.master_customer_id), AVG(T2.council_tax_id) FROM Customer_Master_Index AS T1 JOIN Council_Tax AS T2 ON T1.master_customer_id = T2.cmi_cross_ref_id WHERE T1.master_customer_id BETWEEN 10000 AND 20000 GROUP BY T1.master_customer_id ORDER BY COUNT(DISTINCT T1.master_customer_id) ASC LIMIT 5","What are the master customer ids with the lowest count of distinct master customer ids and their average corresponding council tax ids for master customer ids between 10000 and 20000, excluding the first 5 results?",6,False,extra
SELECT source_system_code FROM CMI_Cross_References WHERE master_customer_id <= 100,What are the source system codes for master customer IDs less than or equal to 100?,2,True,easy
SELECT T1.master_customer_id FROM Customer_Master_Index AS T1 WHERE T1.master_customer_id IN (SELECT T2.master_customer_id FROM CMI_Cross_References AS T2 WHERE T2.source_system_code = 'A' OR T2.master_customer_id = 1 OR T2.source_system_code = 'B') ORDER BY T1.master_customer_id ASC LIMIT 10,"What are the next 10 master customer IDs from the customer master index, starting from the 11th record, where the master customer ID is either linked to source system codes 'A' or 'B', or has a master customer ID of 1? ",6,True,extra
"SELECT COUNT(T1.master_customer_id), T2.cmi_details FROM CMI_Cross_References AS T1 JOIN Customer_Master_Index AS T2 ON T1.master_customer_id = T2.master_customer_id WHERE T2.cmi_details >= 'some_text'",How many master customer IDs from CMI cross references are associated with each unique cmi details in the Customer Master Index where cmi details start with 'some_text'?,6,False,medium
SELECT COUNT(T1.master_customer_id) FROM Customer_Master_Index AS T1 JOIN CMI_Cross_References AS T2 ON T1.master_customer_id = T2.master_customer_id JOIN Council_Tax AS T3 ON T2.cmi_cross_ref_id = T3.cmi_cross_ref_id JOIN Benefits_Overpayments AS T4 ON T2.cmi_cross_ref_id = T4.cmi_cross_ref_id JOIN Rent_Arrears AS T5 ON T2.cmi_cross_ref_id = T5.cmi_cross_ref_id WHERE T2.source_system_code = 'ABC' AND T3.council_tax_id BETWEEN 1000 AND 2000 AND T4.council_tax_id > 500,"How many master customer IDs are there in the Customer Master Index for customers with data from source system 'ABC', council tax ID between 1000 and 2000, and council tax ID greater than 500?",6,False,extra
"SELECT T2.master_customer_id, T3.cmi_cross_ref_id FROM Customer_Master_Index AS T1 JOIN CMI_Cross_References AS T2 ON T1.master_customer_id = T2.master_customer_id JOIN Council_Tax AS T3 ON T2.cmi_cross_ref_id = T3.cmi_cross_ref_id WHERE T1.cmi_details BETWEEN 'abc' AND 'def' OR T3.council_tax_id IN (SELECT council_tax_id FROM Benefits_Overpayments)",What are the master customer ids and cmi cross ref ids for customers with cmi details between 'abc' and 'def' or with council tax ids that are in the benefits overpayments list?,2,True,extra
SELECT cmi_details FROM Customer_Master_Index WHERE master_customer_id >= 1000 ORDER BY master_customer_id ASC,"What are the cmi details for the customers whose master customer id is 1000 or more, listed in ascending order of master customer id?",2,True,medium
SELECT T1.cmi_details FROM Customer_Master_Index AS T1 JOIN CMI_Cross_References AS T2 ON T1.master_customer_id = T2.master_customer_id JOIN Council_Tax AS T3 ON T2.cmi_cross_ref_id = T3.cmi_cross_ref_id WHERE T2.master_customer_id NOT IN (SELECT master_customer_id FROM CMI_Cross_References) LIMIT 10,What are the cmi details of the next 10 master customers not listed in the CMI cross references table?,6,True,extra
SELECT T2.source_system_code FROM Customer_Master_Index AS T1 JOIN CMI_Cross_References AS T2 ON T1.master_customer_id = T2.master_customer_id WHERE NOT EXISTS (SELECT 1 FROM Council_Tax AS T3 WHERE T3.cmi_cross_ref_id = T2.cmi_cross_ref_id) ORDER BY T2.source_system_code DESC,"What are the source system codes of CMI cross references that are not linked to any council tax, in descending order?",2,True,extra
SELECT T1.cmi_details FROM Customer_Master_Index AS T1 JOIN CMI_Cross_References AS T2 ON T1.master_customer_id = T2.master_customer_id WHERE T1.master_customer_id = 100 OR T2.cmi_cross_ref_id BETWEEN 100 AND 200 OR T2.source_system_code > 'A',What are the cmi details of the customer with master customer id 100 or cmi cross reference id between 100 and 200 or source system code greater than A?,3,True,extra
SELECT COUNT(cmi_details) FROM Customer_Master_Index WHERE master_customer_id IN (SELECT master_customer_id FROM CMI_Cross_References WHERE cmi_cross_ref_id = 123),How many customer master index details are associated with the cross reference id 123?,2,True,hard
"SELECT MIN(T1.master_customer_id), T1.cmi_details FROM Customer_Master_Index AS T1 WHERE NOT EXISTS ( SELECT T2.master_customer_id FROM CMI_Cross_References AS T2 WHERE T2.master_customer_id = T1.master_customer_id AND T2.source_system_code = 'system_code' ) LIMIT 10","What are the 10 smallest master customer IDs and their corresponding details from the customer master index, excluding those that exist in the CMI cross references table with the system code 'system_code'?",6,False,extra
SELECT COUNT(DISTINCT T4.cmi_cross_ref_id) FROM Customer_Master_Index AS T1 INNER JOIN CMI_Cross_References AS T2 ON T1.master_customer_id = T2.master_customer_id INNER JOIN Council_Tax AS T3 ON T2.cmi_cross_ref_id = T3.cmi_cross_ref_id INNER JOIN Benefits_Overpayments AS T4 ON T3.cmi_cross_ref_id = T4.cmi_cross_ref_id WHERE T2.source_system_code = 'system_code' AND T2.master_customer_id BETWEEN 100 AND 200 AND T3.council_tax_id > 100 ORDER BY T1.master_customer_id DESC,How many unique cmi_cross_ref_id values from Benefits_Overpayments are linked to Customer_Master_Index through CMI_Cross_References and Council_Tax for master_customer_id between 100 and 200 where source_system_code is 'system_code' and council_tax_id is greater than 100?,3,True,extra
"SELECT T1.master_customer_id, T2.source_system_code FROM Customer_Master_Index AS T1 JOIN CMI_Cross_References AS T2 ON T1.master_customer_id = T2.master_customer_id WHERE T2.source_system_code = 'ABC' OR T1.master_customer_id NOT IN (SELECT cmi_cross_ref_id FROM Council_Tax)","What are the master customer IDs and their respective source system codes from system 'ABC', excluding those also mentioned in the council tax data?",2,True,extra
"SELECT MAX(cmi_details), MIN(cmi_details), AVG(cmi_details) FROM Customer_Master_Index WHERE master_customer_id = 1 ORDER BY master_customer_id DESC","For the customer with master customer ID 1, what are the maximum, minimum and average cmi details?",4,True,extra
SELECT COUNT(council_tax_id) FROM Council_Tax AS T1 JOIN CMI_Cross_References AS T2 ON T1.cmi_cross_ref_id = T2.cmi_cross_ref_id WHERE T2.master_customer_id <= 100 GROUP BY T2.master_customer_id ORDER BY COUNT(council_tax_id) DESC,"What is the number of council tax IDs for each master customer ID that is less than or equal to 100, ordered from highest to lowest count?",4,True,extra
SELECT COUNT(DISTINCT T1.master_customer_id) FROM Customer_Master_Index AS T1 JOIN CMI_Cross_References AS T2 ON T1.master_customer_id = T2.master_customer_id JOIN Council_Tax AS T3 ON T2.cmi_cross_ref_id = T3.cmi_cross_ref_id WHERE T3.council_tax_id IN (SELECT council_tax_id FROM Council_Tax) LIMIT 100,"What is the count of distinct master customer ids that have council tax ids, offset by 100 rows?",6,False,extra
SELECT cmi_details FROM Customer_Master_Index WHERE master_customer_id BETWEEN 100 AND 200 AND cmi_details = 'active' ORDER BY master_customer_id DESC,"What are the 'active' customer master index details for customer ids between 100 and 200, listed in descending order?",2,True,medium
"SELECT T1.cmi_details, SUM(T2.council_tax_id) FROM Customer_Master_Index AS T1 LEFT JOIN Council_Tax AS T2 ON T1.master_customer_id = T2.cmi_cross_ref_id WHERE EXISTS (SELECT 1 FROM Benefits_Overpayments AS T3 WHERE T3.cmi_cross_ref_id = T2.cmi_cross_ref_id) AND T1.master_customer_id = 100 GROUP BY T1.cmi_details","For the customer with master customer ID 100, what are the cmi details and the total number of council tax IDs associated with benefits overpayments?",6,False,extra
"SELECT COUNT(DISTINCT T1.master_customer_id), SUM(T2.council_tax_id) FROM Customer_Master_Index AS T1 JOIN Council_Tax AS T2 ON T1.master_customer_id = T2.cmi_cross_ref_id WHERE T1.cmi_details BETWEEN 'value1' AND 'value2' OR T1.master_customer_id IN (SELECT master_customer_id FROM CMI_Cross_References) OR T2.council_tax_id = 10000 GROUP BY COUNT(DISTINCT T1.master_customer_id) HAVING SUM(T2.council_tax_id) > 10000","How many distinct master customer ids and their total council tax ids are there for customers with cmi details between 'value1' and 'value2' or cross referenced master customer ids or council tax id 10000, given that the total council tax ids exceed 10000?",6,False,extra
SELECT COUNT(DISTINCT T2.master_customer_id) FROM CMI_Cross_References AS T1 JOIN Customer_Master_Index AS T2 ON T1.master_customer_id = T2.master_customer_id,How many distinct master customer IDs are present in both the CMI Cross References and Customer Master Index tables?,2,True,easy
SELECT COUNT(T1.cmi_cross_ref_id) FROM CMI_Cross_References AS T1 JOIN Council_Tax AS T2 ON T1.cmi_cross_ref_id = T2.cmi_cross_ref_id WHERE T2.council_tax_id BETWEEN 100 AND 200 OR T1.master_customer_id IN (SELECT master_customer_id FROM Customer_Master_Index WHERE cmi_details = 'abc'),How many CMI cross references have a corresponding council tax ID between 100 and 200 or a master customer ID with cmi details as 'abc'?,4,True,extra
