query,question,iter,flag,hardness
"SELECT T1.problem_category_description, MAX(T2.log_entry_date) FROM Problem_Category_Codes AS T1 JOIN Problem_Log AS T2 ON T1.problem_category_code = T2.problem_category_code WHERE T1.problem_category_code NOT IN (SELECT problem_category_code FROM Problem_Log WHERE problem_status_code = 'OPEN') GROUP BY T1.problem_category_description ORDER BY MAX(T2.log_entry_date) ASC LIMIT 10","What are the next 10 problem categories with the oldest latest log entry date, excluding categories that still have open problems?",6,False,extra
SELECT COUNT(problem_category_code) FROM Problem_Category_Codes WHERE problem_category_code != 'NA',How many problem categories are not 'NA'?,2,True,easy
SELECT problem_category_description FROM Problem_Category_Codes WHERE problem_category_code < 'code1',What problem category descriptions have codes less than 'code1'?,3,True,easy
"SELECT T1.problem_category_description, MAX(T2.log_entry_date) FROM Problem_Category_Codes AS T1 JOIN Problem_Log AS T2 ON T1.problem_category_code = T2.problem_category_code JOIN Problem_Log AS T3 ON T2.problem_log_id = T3.problem_log_id JOIN Problems AS T4 ON T3.problem_id = T4.problem_id WHERE T2.log_entry_date BETWEEN '2020-01-01' AND '2020-12-31' OR T3.log_entry_fix = 'Yes' OR T4.problem_description = 'Hardware Issue' GROUP BY T1.problem_category_description LIMIT 10","What are the problem categories with their latest log entry dates in 2020 or with a fixed log entry or with a problem description of 'Hardware Issue', grouped by problem category and limited to 10 results starting from the 11th?",6,False,extra
SELECT problem_category_description FROM Problem_Category_Codes WHERE problem_category_code BETWEEN 'code1' AND 'code2' ORDER BY problem_category_code ASC,"What are the problem category descriptions for codes ranging from 'code1' to 'code2', listed in ascending order?",2,True,medium
"SELECT COUNT(T4.problem_category_code), COUNT(T2.problem_status_code), T3.product_name FROM Problems AS T1 JOIN Product AS T3 ON T1.product_id = T3.product_id JOIN Problem_Log AS T2 ON T1.problem_id = T2.problem_id JOIN Problem_Category_Codes AS T4 ON T2.problem_category_code = T4.problem_category_code WHERE T2.log_entry_date >= '2020-01-01'","What is the count of problem categories and problem statuses for each product where the problem log entry date is on or after January 1st, 2020?",6,False,extra
SELECT COUNT(problem_log_id) FROM Problem_Log AS T1 WHERE T1.problem_status_code != 'closed',How many problem logs are not closed?,2,True,easy
"SELECT T1.problem_id, SUM(T2.log_entry_date) FROM Problems AS T1 JOIN Problem_Log AS T2 ON T1.problem_id = T2.problem_id JOIN Staff AS T3 ON T2.assigned_to_staff_id = T3.staff_id WHERE T2.log_entry_date BETWEEN '2020-01-01' AND '2020-12-31' OR T3.staff_first_name = 'John' OR T1.problem_description LIKE '%issue%' GROUP BY T1.problem_id HAVING SUM(T2.log_entry_date) > 10 ORDER BY T1.problem_id DESC","What are the problem IDs with total number of log entries greater than 10 in 2020, or handled by staff named John, or with descriptions containing the word 'issue', ordered by problem ID in descending order?",6,False,extra
SELECT T1.problem_log_id FROM Problem_Log AS T1 WHERE T1.problem_category_code = 'code1' OR T1.problem_id IN (SELECT T2.problem_id FROM Problems AS T2 WHERE T2.product_id = 1),What are the problem log IDs for problems in category 'code1' or problems reported for product ID 1?,2,True,extra
"SELECT COUNT(DISTINCT T1.staff_first_name), COUNT(DISTINCT T2.staff_last_name), T1.staff_id FROM Staff AS T1 JOIN Staff AS T2 ON T1.staff_id = T2.staff_id WHERE T1.staff_id = 5 OR T1.staff_id BETWEEN 10 AND 20 OR T2.staff_id > 3 ORDER BY T1.staff_id ASC","What are the counts of distinct first names and last names of the staff members with id 5, between 10 and 20, or with any id but the corresponding staff id greater than 3, ordered by staff id in ascending order?",6,False,extra
"SELECT COUNT(DISTINCT T1.problem_category_code), COUNT(DISTINCT T1.problem_category_description), T1.problem_category_description FROM Problem_Category_Codes AS T1 WHERE T1.problem_category_code = 'Code1' OR T1.problem_category_description = 'Description1' OR T1.problem_category_code NOT IN (SELECT T2.problem_category_code FROM Problem_Log AS T2)","What is the number of distinct problem category codes, distinct problem category descriptions, and descriptions of the problem category codes that are 'Code1', the problem category descriptions that are 'Description1', and the problem category codes that do not exist in the problem log?",2,True,extra
"SELECT T1.problem_category_code, COUNT(T2.problem_log_id) FROM Problem_Category_Codes AS T1 JOIN Problem_Log AS T2 ON T1.problem_category_code = T2.problem_category_code WHERE T2.problem_status_code != 'CLOSED' GROUP BY T1.problem_category_code LIMIT 10","What are the next 10 problem categories with the most open problems, along with the number of open problems in each category?",6,False,extra
SELECT MAX(T3.log_entry_date) FROM Problems AS T1 INNER JOIN Product AS T2 ON T1.product_id = T2.product_id INNER JOIN Problem_Log AS T3 ON T1.problem_id = T3.problem_id WHERE T3.log_entry_date <= '2020-01-01' ORDER BY T3.log_entry_date DESC LIMIT 1,What is the second most recent log entry date for problems before 2020?,6,False,extra
"SELECT T1.problem_category_description, COUNT(T2.problem_log_id), SUM(T2.problem_log_id) FROM Problem_Category_Codes AS T1 JOIN Problem_Log AS T2 ON T1.problem_category_code = T2.problem_category_code WHERE T2.log_entry_date > '2020-01-01'","What are the problem categories, the number of problems, and the total problem log IDs for problems logged after January 1, 2020?",2,True,extra
SELECT T1.staff_first_name FROM Staff AS T1 JOIN Staff AS T2 ON T1.staff_id = T2.staff_id WHERE T1.staff_id > 10 ORDER BY T1.staff_id ASC,"What are the first names of staff with staff id greater than 10, listed in ascending order of staff id?",2,True,hard
SELECT problem_id FROM Problems WHERE problem_id BETWEEN 1 AND 100 AND product_id = 5,What are the problem IDs of the product with ID 5 where the problem IDs range from 1 to 100?,2,True,medium
SELECT COUNT(*) FROM Problems WHERE problem_id < 10 LIMIT 5,"What is the number of the first 5 problems with a problem id 9 or less, excluding the first 5?",6,False,medium
"SELECT T1.problem_category_code, COUNT(T2.problem_log_id) FROM Problem_Log AS T1 JOIN Problem_Log AS T2 ON T1.problem_id = T2.problem_id WHERE EXISTS (SELECT 1 FROM Problem_Log AS T3 WHERE T3.problem_id = T1.problem_id AND T3.log_entry_date > T1.log_entry_date) GROUP BY T1.problem_category_code","For each problem category, how many times is a problem logged multiple times?",6,False,extra
"SELECT T1.product_name, COUNT(T2.problem_id) FROM Product AS T1 JOIN Problems AS T2 ON T1.product_id = T2.product_id WHERE T2.date_problem_closed > '2020-01-01' ORDER BY COUNT(T2.problem_id) DESC LIMIT 10","What are the names of the next 10 products with the most unresolved problems reported after January 1, 2020?",6,False,extra
"SELECT problem_category_code, COUNT(problem_category_code), problem_category_description FROM Problem_Category_Codes GROUP BY problem_category_code ORDER BY COUNT(problem_category_code) DESC LIMIT 5",What are the 6th to 10th most frequent problem category codes along with their descriptions?,6,False,hard
SELECT T1.problem_category_code FROM Problem_Category_Codes AS T1 JOIN Problem_Log AS T2 ON T1.problem_category_code = T2.problem_category_code WHERE T2.problem_log_id NOT IN (SELECT problem_log_id FROM Problem_Log WHERE problem_log_id = 10 OR problem_log_id = 11 OR problem_log_id = 12),"What are the problem category codes of problems not related to problem log IDs 10, 11, or 12?",2,True,extra
SELECT COUNT(DISTINCT problem_category_code) FROM Problem_Log WHERE log_entry_date BETWEEN '2005-01-01' AND '2005-12-31' ORDER BY problem_log_id DESC,How many distinct problem categories were logged in the year 2005?,3,True,medium
SELECT problem_category_description FROM Problem_Category_Codes AS T1 WHERE EXISTS (SELECT 1 FROM Problem_Log AS T2 WHERE T2.problem_category_code = T1.problem_category_code AND T2.log_entry_description = 'details'),What are the problem category descriptions for which there are problem log entries with the description 'details'?,2,True,hard
"SELECT P.product_name, S.staff_first_name FROM Product AS P JOIN Problems AS Pr ON P.product_id = Pr.product_id JOIN Staff AS S ON S.staff_id = Pr.reported_by_staff_id WHERE Pr.product_id = 1 AND Pr.reported_by_staff_id = 1",What is the name of the product with ID 1 and the first name of the staff member who reported a problem for that product and also has a staff ID of 1?,5,True,hard
SELECT COUNT(DISTINCT T1.problem_category_code) FROM Problem_Log AS T1 JOIN Problem_Category_Codes AS T2 ON T1.problem_category_code = T2.problem_category_code WHERE T2.problem_category_description BETWEEN 'abc' AND 'xyz' ORDER BY COUNT(DISTINCT T1.problem_category_code) DESC LIMIT 5,"What are the next 5 most frequent problem categories with descriptions between 'abc' and 'xyz', excluding the top 4?",3,True,extra
SELECT problem_category_description FROM Problem_Category_Codes WHERE problem_category_code IN (SELECT problem_category_code FROM Problem_Log WHERE problem_id < 10),What are the descriptions of the problem categories for problems with an ID less than 10?,5,True,hard
