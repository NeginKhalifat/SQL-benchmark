query,question,iter,flag,hardness
SELECT COUNT(customer_id) FROM Customers WHERE date_last_hire > '2020-01-01',How many customers have been hired since 2020-01-01?,2,True,easy
"SELECT COUNT(DISTINCT T1.customer_id), COUNT(T1.customer_id) FROM Customers AS T1 JOIN Bookings AS T2 ON T1.customer_id = T2.customer_id LIMIT 10","What are the distinct and total counts of customer IDs for each customer who made a booking, limited to 10 results starting from the 11th?",6,False,extra
"SELECT T1.first_name, COUNT(T2.booking_id) FROM Customers AS T1 JOIN Bookings AS T2 ON T1.customer_id = T2.customer_id GROUP BY T1.first_name HAVING COUNT(T2.booking_id) > 1 WHERE T1.good_or_bad_customer < 'bad'",What are the first names of customers who are considered good and have more than one booking?,6,False,medium
SELECT T1.good_or_bad_customer FROM Customers AS T1 JOIN Bookings AS T2 ON T1.customer_id = T2.customer_id WHERE T2.booking_start_date IN (SELECT T3.booking_start_date FROM Bookings AS T3 WHERE T3.count_hired = '1'),What kind of customers are those who have hired only one product in their bookings?,2,True,extra
SELECT COUNT(DISTINCT T1.coupon_id) FROM Discount_Coupons AS T1 WHERE T1.coupon_amount < 100,How many unique discount coupons with an amount less than 100 are there?,3,True,easy
SELECT T1.product_name FROM Products_for_Hire AS T1 WHERE T1.daily_hire_cost BETWEEN 10 AND 20 AND NOT EXISTS (SELECT 1 FROM Bookings AS T2 JOIN Products_Booked AS T3 ON T2.booking_id = T3.booking_id WHERE T2.booking_status_code = 'cancelled' AND T3.product_id = T1.product_id) GROUP BY T1.product_name HAVING AVG(T1.daily_hire_cost) > 15 ORDER BY T1.product_name DESC,"What are the names of the products that are available for hire with a daily cost between 10 and 20, are not associated with any cancelled bookings, and have an average daily hire cost greater than 15, listed in descending order?",6,False,extra
"SELECT T1.first_name, T2.payment_date FROM Customers AS T1 JOIN Payments AS T2 ON T1.customer_id = T2.customer_id WHERE T1.good_or_bad_customer = 'good' AND T2.amount_paid_in_full_yn = 'yes' AND T2.amount_due BETWEEN 100 AND 500 ORDER BY T1.first_name ASC LIMIT 10","What are the first names of the next 10 good customers, along with the dates of their payments, who have paid an amount due between 100 and 500 in full, listed in ascending order by first name?",6,False,extra
SELECT SUM(T1.amount_payable) FROM Bookings AS T1 JOIN Payments AS T2 ON T1.booking_id = T2.booking_id JOIN Customers AS T3 ON T2.customer_id = T3.customer_id JOIN Discount_Coupons AS T4 ON T3.coupon_id = T4.coupon_id,What is the total amount payable for bookings made by customers who used a discount coupon?,6,False,hard
"SELECT T1.first_name, T1.last_name FROM Customers AS T1 WHERE T1.customer_id = 123 OR T1.date_last_hire BETWEEN '2020-01-01' AND '2020-12-31' OR T1.good_or_bad_customer NOT IN (SELECT T2.good_or_bad_customer FROM Customers AS T2 WHERE T2.customer_id < 100) ORDER BY T1.customer_id ASC","What are the first and last names of customers with an ID of 123, or those who last hired in the year 2020, or those who are not bad customers with IDs less than 100, listed in ascending order of their customer IDs?",6,False,extra
SELECT T1.coupon_amount AS coupon_amount FROM Discount_Coupons AS T1 WHERE T1.coupon_amount < 10 ORDER BY T1.coupon_amount ASC LIMIT 10,What are the next 10 smallest coupon amounts less than 10 dollars in the discount coupons table?,4,True,hard
SELECT T1.good_or_bad_customer FROM Customers AS T1 WHERE NOT EXISTS (SELECT 1 FROM Payments AS T2 WHERE T2.customer_id = T1.customer_id AND T2.amount_paid < 100) ORDER BY T1.first_name ASC,"What are the classifications of good or bad customers for those customers who have never made a payment less than 100, listed in ascending order by first name?",6,True,extra
"SELECT SUM(T1.amount_payable), AVG(T2.amount_paid) FROM Bookings AS T1 JOIN Payments AS T2 ON T1.booking_id = T2.booking_id WHERE T1.customer_id = 100 OR EXISTS (SELECT 1 FROM Customers AS T3 WHERE T3.good_or_bad_customer = 'good')",What is the total amount payable and average amount paid for bookings made by the customer with id 100 or customers who are classified as good?,6,False,extra
SELECT T1.first_name FROM Customers AS T1 JOIN Bookings AS T2 ON T1.customer_id = T2.customer_id WHERE T2.amount_of_discount < (SELECT MAX(amount_of_discount) FROM Bookings) LIMIT 10,What are the first names of the next 10 customers with bookings that are not the maximum discounted amount?,2,True,extra
SELECT SUM(T1.coupon_amount) FROM Discount_Coupons AS T1 WHERE T1.coupon_id IN (SELECT T2.coupon_id FROM Customers AS T2 GROUP BY T2.coupon_id HAVING COUNT(T2.coupon_id) = 1) ORDER BY T1.coupon_amount ASC,"What is the total amount of coupons used by customers who have used a coupon only once, listed in ascending order of coupon amount?",4,True,extra
SELECT T1.coupon_id FROM Discount_Coupons AS T1 WHERE T1.coupon_amount > 100 AND T1.date_issued > '2020-01-01',"What are the coupon IDs of the discount coupons issued after January 1, 2020 with a coupon amount greater than 100?",2,True,medium
"SELECT T1.first_name, T2.product_name FROM Customers AS T1 JOIN Bookings AS T3 ON T1.customer_id = T3.customer_id JOIN Products_Booked AS T4 ON T3.booking_id = T4.booking_id JOIN Products_for_Hire AS T2 ON T4.product_id = T2.product_id WHERE T3.booking_start_date <= '2022-01-01' ORDER BY T2.product_name ASC","What are the names of the customers who booked products that were hired before January 1st, 2022, listed in ascending order by product name?",6,False,extra
"SELECT COUNT(DISTINCT T1.customer_id), SUM(T1.amount_payable) FROM Bookings AS T1 JOIN Customers AS T2 ON T1.customer_id = T2.customer_id WHERE T2.good_or_bad_customer = 'good' AND T1.amount_payable BETWEEN 100 AND 500","What is the number of unique good customers who have made bookings with an amount payable between 100 and 500, and what is the total amount payable for these bookings?",2,True,hard
"SELECT T1.customer_id, SUM(T2.amount_paid) FROM Customers AS T1 JOIN Payments AS T2 ON T1.customer_id = T2.customer_id JOIN Bookings AS T3 ON T2.booking_id = T3.booking_id WHERE T1.coupon_id = 1 OR T3.booking_status_code = 'A' OR T3.booking_start_date BETWEEN '2020-01-01' AND '2020-12-31'","What is the total amount paid by each customer who either has a coupon id of 1, or has a booking with a status code of 'A', or has a booking that starts between '2020-01-01' and '2020-12-31'?",6,False,extra
"SELECT COUNT(DISTINCT T1.coupon_id), COUNT(DISTINCT T2.customer_id), SUM(T1.coupon_amount) FROM Discount_Coupons AS T1 JOIN Customers AS T2 ON T1.coupon_id = T2.coupon_id WHERE T1.date_issued < T2.date_last_hire OR T1.coupon_amount > 0 OR EXISTS (SELECT 1 FROM Payments AS T3 WHERE T3.customer_id = T2.customer_id) ORDER BY T1.coupon_amount ASC","What are the counts of distinct discount coupons and customers, and the total discount amount given to customers who either received a discount coupon before their last hire date or received a coupon with a positive amount or made any payments, ordered by the discount amount in ascending order?",2,True,extra
