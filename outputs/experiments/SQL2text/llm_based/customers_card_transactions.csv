query,question,iter,flag,hardness
"SELECT COUNT(DISTINCT account_name), COUNT(DISTINCT customer_id), COUNT(*) FROM Accounts WHERE customer_id > 500","For accounts with a customer ID greater than 500, how many unique account names, unique customer IDs, and total accounts are there?",2,True,medium
SELECT transaction_amount FROM Financial_Transactions WHERE transaction_amount <= 50 LIMIT 10,What are the transaction amounts of the 11th to 20th smallest transactions of 50 or less in the financial transactions?,4,True,medium
"SELECT COUNT(T1.transaction_id), T1.account_id FROM Financial_Transactions AS T1 JOIN Accounts AS T2 ON T1.account_id = T2.account_id WHERE T1.transaction_amount > 1000 AND T1.transaction_type = 'Debit'","What are the account IDs of accounts with debit transaction amounts greater than 1000, and how many such transactions are there for each account?",2,True,extra
"SELECT COUNT(DISTINCT T1.customer_id), COUNT(DISTINCT T2.customer_id) FROM Customers AS T1 JOIN Customers AS T2 ON T1.customer_id = T2.customer_id WHERE T1.customer_first_name = 'John' OR T2.customer_phone BETWEEN '123-456-7890' AND '987-654-3210' OR T1.customer_id NOT IN (SELECT customer_id FROM Customers_Cards)",How many distinct customers are named John and how many distinct customers have a phone number between '123-456-7890' and '987-654-3210' or do not have a linked card?,6,False,extra
"SELECT T1.account_name, COUNT(T2.transaction_amount) FROM Accounts AS T1 JOIN Financial_Transactions AS T2 ON T1.account_id = T2.account_id WHERE T2.transaction_amount < 100 GROUP BY T1.account_name LIMIT 10","For the 11th to 20th accounts with the most transactions, what are the account names and the number of transactions that are less than 100?",6,False,extra
"SELECT customer_first_name, customer_last_name FROM Customers AS T1 INNER JOIN Customers_Cards AS T2 ON T1.customer_id = T2.customer_id WHERE T2.customer_id >= 10 ORDER BY T1.customer_last_name DESC LIMIT 5","What are the first and last names of the customers with customer id greater than or equal to 10, sorted by last name in descending order, from the 6th to the 10th customer?",2,True,extra
SELECT DISTINCT T1.customer_first_name FROM Customers AS T1 WHERE T1.customer_phone = '123456789' OR T1.customer_email = 'abc@example.com' OR NOT EXISTS (SELECT 1 FROM Financial_Transactions AS T2 WHERE T2.account_id = T1.customer_id),"What are the first names of the customers who have either a phone number of '123456789', an email of 'abc@example.com', or no financial transactions recorded?",2,True,extra
SELECT T1.customer_first_name FROM Customers AS T1 JOIN Customers_Cards AS T2 ON T1.customer_id = T2.customer_id JOIN Financial_Transactions AS T3 ON T2.card_id = T3.card_id WHERE T1.customer_phone LIKE '123%' AND T3.transaction_amount BETWEEN 100 AND 1000 AND EXISTS (SELECT * FROM Accounts AS T4 WHERE T4.account_id = T3.account_id AND T4.account_name = 'Checking') LIMIT 10,What are the first names of the next 10 customers whose phone numbers start with '123' and have made transactions between $100 and $1000 using their checking accounts?,6,False,extra
"SELECT T1.account_name, T2.customer_first_name FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id = T2.customer_id WHERE T1.account_name != 'account_name_1' LIMIT 10","What are the account names and the first names of the corresponding customers for the 11th to 20th accounts, excluding the account name 'account_name_1'?",6,False,hard
"SELECT T1.customer_first_name, T2.card_type_code FROM Customers AS T1 JOIN Customers_Cards AS T2 ON T1.customer_id = T2.customer_id JOIN Financial_Transactions AS T3 ON T2.card_id = T3.card_id WHERE T1.customer_last_name = 'Smith' AND T3.transaction_date BETWEEN '2020-01-01' AND '2020-12-31' AND T3.transaction_amount > 100 ORDER BY T1.customer_first_name DESC","What are the first names and card types of customers with the last name 'Smith' who made transactions exceeding $100 in the year 2020, listed in descending order by first name?",6,False,extra
"SELECT T1.account_name, COUNT(T2.card_id) FROM Accounts AS T1 JOIN Customers_Cards AS T2 ON T1.customer_id = T2.customer_id WHERE T2.card_type_code = 'VISA' AND T1.account_id NOT IN (SELECT account_id FROM Financial_Transactions WHERE transaction_type = 'DEBIT') AND T2.card_number LIKE '1234%'","What are the account names and the number of VISA cards whose card numbers start with '1234' for each account, excluding accounts that have had debit transactions?",6,False,extra
SELECT T1.customer_id FROM Customers AS T1 JOIN Customers AS T2 ON T1.customer_id = T2.customer_id WHERE EXISTS (SELECT T3.card_id FROM Customers_Cards AS T3 WHERE T3.customer_id = T1.customer_id) GROUP BY T1.customer_id HAVING COUNT(T1.customer_id) > 1 LIMIT 10,"Which customer IDs appear more than once in the customer database and have at least one card, listing the next 10 results?",2,True,extra
"SELECT COUNT(transaction_id), COUNT(DISTINCT account_id), COUNT(DISTINCT card_id) FROM Financial_Transactions WHERE transaction_amount >= 100","What are the total number of transactions, unique accounts, and unique cards for transactions with an amount of at least 100?",2,True,medium
"SELECT T1.account_id, COUNT(T2.transaction_id) FROM Financial_Transactions AS T1 JOIN Financial_Transactions AS T2 ON T1.transaction_id = T2.previous_transaction_id WHERE T2.transaction_amount BETWEEN 100 AND 1000 AND T1.transaction_amount = (SELECT AVG(transaction_amount) FROM Financial_Transactions) LIMIT 10","What are the account IDs and their corresponding number of linked transactions with amounts between $100 and $1000, for the accounts with the average transaction amount, starting from the 11th result?",6,False,extra
"SELECT COUNT(DISTINCT T1.account_id), COUNT(DISTINCT T2.customer_id), T1.account_name FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id = T2.customer_id",What is the number of unique account holders and unique customers for each account name?,6,False,medium
"SELECT T1.customer_first_name, COUNT(T1.customer_id) FROM Customers AS T1 WHERE T1.customer_last_name != 'Smith' ORDER BY T1.customer_first_name ASC","What are the first names of customers with the last name not being 'Smith', along with the number of customers for each first name, listed in alphabetical order by first name?",4,True,medium
"SELECT COUNT(T2.account_name), T1.account_name FROM Accounts AS T1 JOIN Accounts AS T2 ON T1.account_id = T2.account_id WHERE T1.account_id = 5 AND T2.account_id = 3 AND EXISTS (SELECT 1 FROM Accounts AS T3 WHERE T3.account_id = T1.account_id)",How many account names are associated with account id 3 that also have account id 5 in the accounts table?,4,True,extra
"SELECT COUNT(DISTINCT T1.account_name), COUNT(T2.transaction_amount), T3.customer_first_name FROM Accounts AS T1 JOIN Financial_Transactions AS T2 ON T1.account_id = T2.account_id JOIN Customers AS T3 ON T3.customer_id = T1.customer_id JOIN Customers_Cards AS T4 ON T3.customer_id = T4.customer_id WHERE T2.transaction_amount > 1000 OR T1.account_id NOT IN (SELECT account_id FROM Financial_Transactions WHERE transaction_type = 'online') ORDER BY T1.account_name ASC LIMIT 10","What are the names of 10 accounts with the most unique names (starting from the 11th), the total number of transactions and first name of the customer for the accounts with transaction amounts over 1000 or that have never made an online transaction, ordered alphabetically by account name?",6,False,extra
SELECT account_id FROM Accounts WHERE account_id != 1234,What are the account ids other than 1234?,2,True,easy
SELECT T1.customer_first_name FROM Customers AS T1 JOIN Customers_Cards AS T2 ON T1.customer_id = T2.customer_id WHERE T2.card_type_code = 'Visa',What are the first names of the customers who have a Visa card?,2,True,medium
"SELECT T1.customer_first_name, COUNT(T2.transaction_id) FROM Customers AS T1 JOIN Financial_Transactions AS T2 ON T1.customer_id = T2.account_id WHERE T1.customer_id = 123 GROUP BY T1.customer_first_name ORDER BY COUNT(T2.transaction_id) DESC","What is the first name of the customer with id 123 and how many financial transactions has this customer made, listed in descending order of transactions?",5,True,extra
SELECT SUM(transaction_amount) FROM Financial_Transactions WHERE transaction_amount > 1000,What is the total amount of all the financial transactions greater than $1000?,2,True,easy
SELECT account_name FROM Accounts WHERE account_id BETWEEN 1000 AND 2000 ORDER BY account_id DESC,"What are the account names for accounts with account IDs between 1000 and 2000, listed in descending order by account ID?",2,True,medium
