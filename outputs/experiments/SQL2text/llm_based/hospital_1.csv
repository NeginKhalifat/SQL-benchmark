query,question,iter,flag,hardness
SELECT COUNT(DISTINCT T1.Code) FROM Procedures AS T1 JOIN Trained_In AS T2 ON T1.Code = T2.Treatment JOIN Physician AS T3 ON T2.Physician = T3.EmployeeID JOIN Undergoes AS T4 ON T3.EmployeeID = T4.Physician WHERE T4.DateUndergoes > '2020-01-01',How many different procedures were undergone after '2020-01-01'?,2,True,extra
SELECT T1.Name FROM Physician AS T1 JOIN Physician AS T2 ON T1.EmployeeID = T2.EmployeeID WHERE T1.Position = 'Head' OR T2.Position = 'Head' ORDER BY T1.EmployeeID DESC LIMIT 10,What are the names of the next 10 physicians with the position of 'head' ordered by employee id in descending order after the first 10?,6,False,extra
SELECT T1.Name FROM Physician AS T1 JOIN Appointment AS T2 ON T1.EmployeeID = T2.Physician WHERE T1.EmployeeID != 1001,What are the names of all physicians who have appointments and are not physician 1001?,2,True,medium
SELECT * FROM Physician WHERE EmployeeID = 101 OR EmployeeID NOT IN (SELECT Physician FROM Trained_In WHERE Treatment = 201) ORDER BY EmployeeID ASC,"What is the information about physicians with an EmployeeID of 101 or who are not trained in the treatment with a code of 201, listed in ascending order by EmployeeID?",5,True,extra
"SELECT COUNT(DISTINCT Physician.EmployeeID), COUNT(Physician.EmployeeID) FROM Physician WHERE Physician.Position != 'SR'",What are the counts of distinct employee IDs of non-SR physicians and the total number of non-SR physicians?,3,True,medium
SELECT Physician FROM ( SELECT COUNT(DISTINCT Physician) as Physician FROM Undergoes GROUP BY Physician ) AS T1 ORDER BY Physician DESC,"What is the number of distinct procedures performed by each physician, listed in descending order?",6,False,easy
SELECT Name FROM Physician WHERE Position > 'Doctor',What are the names of physicians who hold a position higher than Doctor?,2,True,easy
"SELECT T1.Name, COUNT(DISTINCT T2.AppointmentID) FROM Physician AS T1 JOIN Appointment AS T2 ON T1.EmployeeID = T2.Physician WHERE T1.EmployeeID IN (SELECT Physician FROM Undergoes) ORDER BY T1.Name DESC LIMIT 10","Starting from the 11th physician, what are the names of the next 10 physicians who performed procedures and the number of unique procedures they performed, listed in descending order by physician name?",6,False,extra
SELECT T1.Name FROM Physician AS T1 JOIN Affiliated_With AS T2 ON T1.EmployeeID = T2.Physician WHERE T2.Department = 5 ORDER BY T1.Name ASC,"What are the names of all the physicians affiliated with department 5, listed in alphabetical order?",3,True,hard
SELECT T1.Name FROM Physician AS T1 WHERE T1.EmployeeID BETWEEN 100 AND 200 AND T1.SSN NOT IN (SELECT T2.Physician FROM Trained_In AS T2),What are the names of the physicians whose employee IDs are between 100 and 200 but who are not trained in any procedure?,2,True,extra
SELECT COUNT(DISTINCT T1.Name) FROM Physician AS T1 JOIN Appointment AS T2 ON T1.EmployeeID = T2.Physician,How many different physicians have appointments scheduled?,6,False,easy
SELECT T1.Name FROM Physician AS T1 JOIN Appointment AS T2 ON T1.EmployeeID = T2.Physician WHERE T1.Position < 'Intern' ORDER BY T1.Name ASC LIMIT 10,"What are the names of the next 10 physicians after the first 10 who have a higher position than an intern and are assigned to at least one appointment, listed alphabetically?",6,False,extra
SELECT T1.Name FROM Physician AS T1 WHERE T1.Position = 'Doctor' OR T1.EmployeeID IN (SELECT T2.Physician FROM Trained_In AS T2 WHERE T2.CertificationDate IS NOT NULL),What are the names of physicians who are doctors or have a non-null certification date?,6,False,extra
"SELECT T1.Name, T2.Name FROM Physician AS T1 JOIN Physician AS T2 ON T1.EmployeeID = T2.EmployeeID WHERE T1.EmployeeID IN (SELECT Physician FROM Trained_In WHERE CertificationExpires > '2022-01-01') ORDER BY T1.Name ASC",What are the names of the physician pairs that are certified beyond '2022-01-01' ordered by the first physician name in ascending order?,6,False,extra
"SELECT T1.Patient, SUM(T2.Cost) FROM Undergoes AS T1 JOIN Procedures AS T2 ON T1.Procedures = T2.Code WHERE T1.AssistingNurse < 1000",What is the total cost of procedures for each patient who had an assisting nurse with an ID less than 1000?,6,False,medium
SELECT COUNT(T1.Patient) FROM Appointment AS T1 JOIN Undergoes AS T2 ON T1.AppointmentID = T2.Stay WHERE T2.DateUndergoes < '2020-01-01',"How many patients underwent procedures before January 1, 2020?",6,False,medium
SELECT COUNT(DISTINCT Physician) FROM Undergoes GROUP BY Procedures HAVING COUNT(Physician) > 1 ORDER BY Procedures ASC,"How many distinct physicians are there for each procedure, sorted by procedure in ascending order, only for procedures with more than one physician?",6,False,medium
SELECT T1.Name FROM Physician AS T1 JOIN Affiliated_With AS T2 ON T1.EmployeeID = T2.Physician WHERE T2.PrimaryAffiliation = 1 LIMIT 10,What are the names of the 11th to 20th physicians who have a primary affiliation with a department?,6,False,hard
"SELECT T1.Name, T1.Position FROM Physician AS T1 JOIN Trained_In AS T2 ON T1.EmployeeID = T2.Physician JOIN Procedures AS T3 ON T2.Treatment = T3.Code WHERE T1.Position != 'Surgeon' GROUP BY T1.Position HAVING AVG(T3.Cost) > 1000 LIMIT 5","What are the names and positions of the 5 non-surgeon physicians, with the highest average procedure cost, after ignoring the first 5 results?",6,False,extra
"SELECT COUNT(DISTINCT T2.AppointmentID), COUNT(DISTINCT T3.Patient), T1.Name FROM Physician AS T1 JOIN Appointment AS T2 ON T1.EmployeeID = T2.Physician JOIN Undergoes AS T3 ON T1.EmployeeID = T3.Physician WHERE T1.Position = 'Surgeon' OR T2.Start BETWEEN '2020-01-01' AND '2020-12-31' OR T3.DateUndergoes > '2020-12-31' GROUP BY T1.Name HAVING MAX(T2.Start) = '2020-12-31' LIMIT 10","What are the names of the top 10 surgeons with the most distinct appointments and patients, who either have an appointment in 2020 or an undergoes date after 2020-12-31, and have an appointment that ends on 2020-12-31?",6,False,extra
"SELECT COUNT(DISTINCT T1.AssistingNurse), T1.Physician FROM Undergoes AS T1 JOIN Undergoes AS T2 ON T1.Physician = T2.Physician WHERE T1.DateUndergoes BETWEEN T2.DateUndergoes AND T2.DateUndergoes AND T1.DateUndergoes BETWEEN T2.DateUndergoes AND T2.DateUndergoes","For each physician, how many different assisting nurses worked with this physician on a procedure that occurred on the same date as another procedure this physician worked on?",6,False,extra
