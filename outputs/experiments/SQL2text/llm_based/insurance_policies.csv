query,question,iter,flag,hardness
"SELECT COUNT(T1.Customer_ID), T1.Customer_ID FROM Customers AS T1 GROUP BY T1.Customer_ID HAVING COUNT(T1.Customer_ID) < 10 LIMIT 5","What are the customer IDs of the 5 customers who have purchased 9 or fewer policies, excluding the first 5 results?",6,False,medium
SELECT T1.Customer_ID FROM Customer_Policies AS T1 JOIN Claims AS T2 ON T1.Policy_ID = T2.Policy_ID WHERE T2.Amount_Claimed > (SELECT AVG(Amount_Claimed) FROM Claims) AND T2.Date_Claim_Made > '2020-01-01' ORDER BY T1.Customer_ID ASC LIMIT 10,"What are the customer IDs of the next 10 customers who made claims for more than the average claimed amount after January 1st, 2020, ordered by customer ID in ascending order?",4,True,extra
SELECT T1.Customer_ID FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_ID = T2.Customer_ID WHERE T2.Policy_Type_Code > 'A' ORDER BY T1.Customer_ID ASC,"What are the customer IDs of customers with a policy type code greater than 'A', listed in ascending order by customer ID?",3,True,hard
"SELECT T1.Customer_ID, MIN(T4.Date_Payment_Made) FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_ID = T2.Customer_ID JOIN Claims AS T3 ON T2.Policy_ID = T3.Policy_ID JOIN Payments AS T4 ON T3.Claim_ID = T4.Settlement_ID WHERE T3.Amount_Claimed > 1000 AND T3.Date_Claim_Settled IS NOT NULL AND T3.Claim_ID NOT IN (SELECT Claim_ID FROM Settlements WHERE Amount_Settled = 0) GROUP BY T1.Customer_ID","For each customer, what is the earliest payment date for claims that were settled with a claimed amount greater than $1000 and a non-zero settlement amount?",3,True,extra
"SELECT COUNT(DISTINCT T1.Customer_ID), SUM(T2.Amount_Settled) FROM Customers AS T1 JOIN Settlements AS T2 ON T1.Customer_ID = T2.Customer_Policy_ID",What is the total number of distinct customers and the total amount settled?,6,False,medium
SELECT SUM(T2.Amount_Settled) FROM Claims AS T1 JOIN Settlements AS T2 ON T1.Claim_ID = T2.Claim_ID WHERE T2.Date_Claim_Made BETWEEN '2020-01-01' AND '2020-12-31',What is the total amount settled for all claims made in the year 2020?,6,False,medium
SELECT T1.Customer_ID FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_ID = T2.Customer_ID WHERE T2.Customer_ID != 100,What are the customer IDs of customers who have policies and are not customer 100?,3,True,medium
"SELECT COUNT(DISTINCT T1.Claim_ID), SUM(T1.Amount_Settled), AVG(T1.Amount_Claimed) FROM Settlements AS T1 WHERE T1.Amount_Settled > 5000 AND T1.Date_Claim_Settled BETWEEN '2020-01-01' AND '2020-12-31' AND T1.Customer_Policy_ID IN (SELECT T2.Policy_ID FROM Customer_Policies AS T2 WHERE T2.Policy_Type_Code = 'type1') LIMIT 10","What are the count of distinct claim IDs, total amount settled, and average amount claimed for settlements of policies of type 'type1' with a settlement amount greater than 5000, settled between 2020-01-01 and 2020-12-31, for rows 11 to 20?",6,False,extra
"SELECT COUNT(DISTINCT T1.Customer_ID), T2.Payment_Method_Code, T2.Date_Payment_Made FROM Customers AS T1 JOIN Payments AS T2 ON T1.Customer_ID = T2.Settlement_ID WHERE T2.Amount_Payment BETWEEN 100 AND 500 ORDER BY T1.Customer_ID ASC LIMIT 5","What are the distinct customer IDs, payment method codes, and payment dates for the next 5 customers with payment amounts between 100 and 500, ordered by customer ID in ascending order, after the first 5 records?",6,False,extra
"SELECT T1.Customer_ID, COUNT(T2.Claim_ID) FROM Customers AS T1 JOIN Claims AS T2 ON T1.Customer_ID = T2.Policy_ID WHERE T2.Amount_Claimed < 10000 GROUP BY T1.Customer_ID HAVING COUNT(T2.Claim_ID) > 1 ORDER BY T1.Customer_ID ASC",Which customers have made more than one claim for an amount less than 10000 and how many claims have they made?,6,False,extra
"SELECT COUNT(DISTINCT T2.Claim_ID), SUM(T1.Amount_Settled) FROM Settlements AS T1 JOIN Claims AS T2 ON T1.Claim_ID = T2.Claim_ID WHERE T1.Customer_Policy_ID = 100 AND T2.Amount_Claimed BETWEEN 1000 AND 2000 AND T1.Amount_Settled > 1000 LIMIT 10","What are the count of distinct claim ids and the total amount settled for customer policy id 100 where the amount claimed is between 1000 and 2000 and the amount settled is greater than 1000, starting from the 11th result?",6,False,extra
"SELECT AVG(T1.Amount_Settled), COUNT(DISTINCT T2.Payment_Method_Code) FROM Settlements AS T1 JOIN Payments AS T2 ON T1.Settlement_ID = T2.Settlement_ID WHERE T1.Amount_Claimed BETWEEN 1000 AND 2000 AND NOT EXISTS (SELECT * FROM Claims AS T3 WHERE T3.Claim_ID = T1.Claim_ID AND T3.Amount_Claimed > 1500) GROUP BY T2.Payment_Method_Code LIMIT 5","What are the average settlement amounts and distinct payment methods for settlements of claims with amounts between 1000 and 2000, where no claim exceeds 1500, for the next 5 payment methods after the first 5?",6,False,extra
SELECT Policy_Type_Code FROM Customer_Policies LIMIT 1,What is the policy type code of the second customer policy?,5,True,easy
SELECT Customer_Details FROM Customers WHERE Customer_ID < 100 ORDER BY Customer_ID,"What are the customer details for customers with IDs less than 100, listed in order from lowest to highest customer ID?",6,False,medium
"SELECT AVG(T1.Amount_Claimed), AVG(T1.Amount_Settled) FROM Claims AS T1 JOIN Settlements AS T2 ON T1.Claim_ID = T2.Claim_ID GROUP BY T2.Amount_Claimed",What is the average amount claimed and the average amount settled for each amount claimed in the settlements?,6,False,extra
SELECT T2.Customer_ID FROM Customer_Policies AS T1 JOIN Customers AS T2 ON T1.Customer_ID = T2.Customer_ID WHERE T1.Policy_Type_Code = 'H' OR T1.Start_Date > '2022-01-01' OR T1.Policy_ID IN (SELECT T3.Policy_ID FROM Claims AS T3 WHERE T3.Date_Claim_Settled IS NOT NULL) ORDER BY T2.Customer_ID ASC,"What are the customer IDs of customers who have home policies, or whose policies started after January 1, 2022, or who have made claims that have been settled, listed in ascending order by customer ID?",6,False,extra
"SELECT COUNT(DISTINCT T1.Customer_ID), COUNT(DISTINCT T2.Customer_ID) FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_ID = T2.Customer_ID WHERE T2.Start_Date BETWEEN '2020-01-01' AND '2020-12-31' OR T1.Customer_ID > 100 AND T1.Customer_ID < 200 ORDER BY T1.Customer_ID DESC LIMIT 10","What are the counts of distinct customers with policies from 2020 and distinct customers with IDs between 100 and 200, for the 11th to 20th highest customer IDs?",6,False,extra
"SELECT T1.Customer_ID, COUNT(DISTINCT T2.Policy_ID) FROM Customer_Policies AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_ID = T2.Customer_ID WHERE T1.Policy_Type_Code < 'P1' GROUP BY T1.Customer_ID","For each customer with a policy type code less than P1, how many distinct policies do they have?",4,True,hard
"SELECT T1.Customer_ID, COUNT(T3.Claim_ID), COUNT(T5.Payment_ID) FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_ID = T2.Customer_ID JOIN Claims AS T3 ON T2.Policy_ID = T3.Policy_ID JOIN Settlements AS T4 ON T3.Claim_ID = T4.Claim_ID JOIN Payments AS T5 ON T4.Settlement_ID = T5.Settlement_ID WHERE T4.Amount_Claimed < 10000 LIMIT 10","What are the customer ids and their respective counts of claims and payments for the next 10 customers who claimed less than 10000, after the first 10?",6,False,extra
"SELECT T1.Customer_ID, T1.Customer_Details FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_ID = T2.Customer_ID WHERE T2.Policy_Type_Code IN (SELECT T3.Policy_Type_Code FROM Customer_Policies AS T3 WHERE T3.Start_Date = '2020-01-01') LIMIT 100","What are the customer IDs and details of the customers who have policies that started on '2020-01-01', from the 101st to the 200th result?",6,False,extra
