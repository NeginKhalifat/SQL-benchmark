query,question,iter,flag,hardness
"SELECT T3.name, SUM(T1.balance) + SUM(T2.balance) FROM SAVINGS AS T1 JOIN CHECKING AS T2 ON T1.custid = T2.custid JOIN ACCOUNTS AS T3 ON T1.custid = T3.custid WHERE T3.custid BETWEEN 1 AND 100 OR T1.balance > 1000 OR T2.balance > 1000 GROUP BY T3.name","What is the combined balance of checking and savings accounts for each customer with a customer id between 1 and 100, or a savings balance over 1000, or a checking balance over 1000?",6,False,extra
"SELECT T1.name, T2.balance, T3.balance FROM ACCOUNTS AS T1 JOIN SAVINGS AS T2 ON T1.custid = T2.custid JOIN CHECKING AS T3 ON T1.custid = T3.custid LIMIT 10",What are the names and balances of the next 10 customers who have both savings and checking accounts?,6,False,hard
SELECT COUNT(DISTINCT T1.name) FROM ACCOUNTS AS T1 JOIN SAVINGS AS T2 ON T1.custid = T2.custid WHERE T2.balance = 1000,How many distinct customers have a savings account with a balance of 1000?,6,False,medium
SELECT COUNT(DISTINCT T1.custid) FROM SAVINGS AS T1 JOIN ACCOUNTS AS T2 ON T1.custid = T2.custid JOIN CHECKING AS T3 ON T2.custid = T3.custid,How many distinct customers have both a savings account and a checking account?,6,False,medium
"SELECT T1.name, T2.balance FROM ACCOUNTS AS T1 JOIN SAVINGS AS T2 ON T1.custid = T2.custid",What are the names and savings account balances of the customers?,2,True,medium
"SELECT COUNT(DISTINCT T1.custid), COUNT(T1.balance) FROM SAVINGS AS T1 JOIN ACCOUNTS AS T2 ON T1.custid = T2.custid WHERE T1.balance = 1000 ORDER BY T1.balance DESC",How many distinct customer IDs and total number of savings accounts have a balance of 1000?,3,True,hard
"SELECT T1.name, T2.balance, T3.balance FROM ACCOUNTS AS T1 JOIN SAVINGS AS T2 ON T1.custid = T2.custid JOIN CHECKING AS T3 ON T1.custid = T3.custid WHERE T2.balance BETWEEN 100 AND 1000 OR T2.balance IN (SELECT balance FROM SAVINGS WHERE balance > 500) ORDER BY T1.name ASC","What are the names and savings and checking balances of customers whose savings balance is between 100 and 1000 or greater than 500, listed in ascending order by name?",2,True,extra
SELECT T1.name FROM ACCOUNTS AS T1 JOIN CHECKING AS T2 ON T1.custid = T2.custid WHERE T2.balance != 0 ORDER BY T1.name ASC LIMIT 10,"What are the names of the 11th to 20th customers, in ascending order, who have a non-zero checking balance?",5,True,extra
"SELECT COUNT(T1.custid), T1.balance FROM SAVINGS AS T1 WHERE T1.custid NOT IN ( SELECT T2.custid FROM CHECKING AS T2 WHERE T2.balance > 1000 ) AND T1.balance > 1500 LIMIT 5","What are the balances of the top 5 customers with a savings balance over 1500 who do not have a checking balance over 1000, along with the count of such customers?",6,True,extra
SELECT T1.name FROM ACCOUNTS AS T1 JOIN SAVINGS AS T2 ON T1.custid = T2.custid WHERE T2.balance < 1000 ORDER BY T1.name ASC,"What are the names of customers with a savings balance less than 1000, listed in ascending order by name?",2,True,hard
"SELECT A.name, SUM(C.balance), SUM(S.balance) FROM ACCOUNTS A JOIN CHECKING C ON A.custid = C.custid JOIN SAVINGS S ON A.custid = S.custid WHERE A.custid <= 100","What are the names of customers with customer IDs less than or equal to 100, along with their total checking and savings balances?",6,False,hard
"SELECT COUNT(A.custid), A.name, S.balance FROM ACCOUNTS A JOIN SAVINGS S ON A.custid = S.custid JOIN CHECKING C ON A.custid = C.custid","How many accounts, and what are the names and total savings balances for each account, of customers who have both savings and checking accounts?",3,True,medium
SELECT * FROM SAVINGS AS T1 WHERE EXISTS (SELECT * FROM CHECKING AS T2 WHERE T1.custid = T2.custid AND T1.balance < 1000) AND T1.balance > 0,What are the details of all savings accounts with a balance greater than 0 and also have a checking account with the same customer id where the savings account balance is less than 1000?,6,False,extra
SELECT name FROM ACCOUNTS WHERE name <= 'John',What are the names of the accounts that are alphabetically before or equal to 'John'?,2,True,easy
"SELECT T1.balance, MIN(T2.balance) FROM CHECKING AS T1 JOIN SAVINGS AS T2 ON T1.custid = T2.custid WHERE T1.balance > 5000 OR T2.balance BETWEEN 1000 AND 2000 OR EXISTS (SELECT 1 FROM ACCOUNTS AS T3 WHERE T3.custid = T1.custid) LIMIT 10","What are the balances of the top 10 checking accounts with balances over 5000 or savings accounts with balances between 1000 and 2000, along with the minimum savings balances for these customers, considering only customers who have accounts in the accounts table?",6,False,extra
SELECT T1.name FROM ACCOUNTS AS T1 JOIN SAVINGS AS T2 ON T1.custid = T2.custid JOIN CHECKING AS T3 ON T2.custid = T3.custid WHERE T3.balance > 1000 OR T2.balance BETWEEN 500 AND 1000,What are the names of the customers who have a checking account balance greater than 1000 or have a savings account balance between 500 and 1000?,2,True,extra
"SELECT SUM(S1.balance), COUNT(C1.custid), SUM(S2.balance), COUNT(C2.custid) FROM SAVINGS AS S1 JOIN ACCOUNTS AS C1 ON S1.custid = C1.custid JOIN CHECKING AS S2 JOIN ACCOUNTS AS C2 ON S2.custid = C2.custid LIMIT 5","What are the total savings and checking balances and the number of customers with both savings and checking accounts for the next 5 customers, assuming the lists of customers are offset by 5?",6,False,extra
SELECT name FROM ACCOUNTS WHERE name = 'John' OR name = 'Jane' OR name NOT IN (SELECT name FROM SAVINGS WHERE balance BETWEEN 100 AND 1000) ORDER BY name DESC,"What are the names of customers whose names are John or Jane or who do not have a savings account balance between 100 and 1000, listed in descending order?",4,True,extra
"SELECT T1.name, MAX(T3.balance + T2.balance) FROM ACCOUNTS AS T1 JOIN SAVINGS AS T2 ON T1.custid = T2.custid JOIN CHECKING AS T3 ON T1.custid = T3.custid WHERE T2.balance > 1000 GROUP BY T1.name ORDER BY MAX(T3.balance + T2.balance) DESC","What are the names of customers with their total savings and checking balances in descending order, where the savings balance exceeds 1000?",6,False,extra
"SELECT COUNT(DISTINCT T1.custid), COUNT(DISTINCT T2.custid), COUNT(T3.custid) FROM ACCOUNTS AS T1 JOIN CHECKING AS T2 ON T1.custid = T2.custid JOIN SAVINGS AS T3 ON T1.custid = T3.custid WHERE T1.custid != 100 ORDER BY T3.balance DESC","What are the number of unique customers from accounts, checking and savings excluding customer 100, and what is the number of savings accounts for these customers in descending order of balance?",6,False,extra
"SELECT T1.name, T1.custid FROM ACCOUNTS AS T1 JOIN SAVINGS AS T2 ON T1.custid = T2.custid JOIN CHECKING AS T3 ON T2.custid = T3.custid WHERE T2.balance IN (SELECT balance FROM SAVINGS GROUP BY balance HAVING COUNT(balance) > 1)",What are the names and customer ids of customers who have a savings account balance that is shared with at least one other customer?,6,False,extra
"SELECT T1.name, AVG(T2.balance) FROM ACCOUNTS AS T1 JOIN SAVINGS AS T2 ON T1.custid = T2.custid WHERE T1.custid = 100 OR T2.balance > 500 OR NOT EXISTS (SELECT * FROM CHECKING AS T3 WHERE T3.custid = T1.custid AND T3.balance < 0) GROUP BY T1.name","What are the names of the customers with id 100, or with savings balance greater than 500, or who do not have checking accounts with negative balances, along with their average savings balance?",5,True,extra
SELECT T1.balance FROM CHECKING AS T1 JOIN ACCOUNTS AS T2 ON T1.custid = T2.custid WHERE T2.custid <= 100 ORDER BY T1.balance DESC,"What are the checking account balances, in descending order, for customers with customer IDs 100 or less?",2,True,hard
"SELECT T1.name, COUNT(DISTINCT T2.balance) FROM ACCOUNTS AS T1 JOIN SAVINGS AS T2 ON T1.custid = T2.custid WHERE T2.balance <= 100 ORDER BY T1.name ASC",What are the names of the customers with the count of distinct savings account balances less than or equal to 100 ordered by customer name in ascending order?,6,False,hard
